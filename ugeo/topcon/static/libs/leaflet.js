L={},L.Util={extend:function(a){var b=Array.prototype.slice.call(arguments,1);for(var c=0,d=b.length,e;c<d;c++){e=b[c]||{};for(var f in e)e.hasOwnProperty&&e.hasOwnProperty(f)&&(a[f]=e[f])}return a},applyDefaults:function(a,b){a=a||{};var c=typeof window.Event=="function"&&b instanceof window.Event;for(var d in b)if(a[d]===undefined||!c&&b.hasOwnProperty&&b.hasOwnProperty(d)&&!a.hasOwnProperty(d))a[d]=b[d];return!c&&b&&b.hasOwnProperty&&b.hasOwnProperty("toString")&&!a.hasOwnProperty("toString")&&(a.toString=b.toString),a},bind:function(a,b){var c=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return a.apply(b,c||arguments)}},tryFuncs:function(){var a=null;for(var b=0,c=arguments.length;b<c;b++){var d=arguments[b];try{a=d();break}catch(e){}}return a},getParameterString:function(a){var b=[];for(var c in a){var d=a[c];if(d!=null&&typeof d!="function"){var e;if(typeof d=="object"&&d.constructor==Array){var f=[],g;for(var h=0,i=d.length;h<i;h++)g=d[h],f.push(encodeURIComponent(g===null||g===undefined?"":g));e=f.join(",")}else e=encodeURIComponent(d);b.push(encodeURIComponent(c)+"="+e)}}return b.join("&")},containsStr:function(a,b){return a.indexOf(b)!=-1},getParameters:function(a){a=a===null||a===undefined?window.location.href:a;var b="";if(L.Util.containsStr(a,"?")){var c=a.indexOf("?")+1,d=L.Util.containsStr(a,"#")?a.indexOf("#"):a.length;b=a.substring(c,d)}var e={},f=b.split(/[&;]/);for(var g=0,h=f.length;g<h;++g){var i=f[g].split("=");if(i[0]){var j=i[0];try{j=decodeURIComponent(j)}catch(k){j=unescape(j)}var l=(i[1]||"").replace(/\+/g," ");try{l=decodeURIComponent(l)}catch(k){l=unescape(l)}l=l.split(","),l.length==1&&(l=l[0]),e[j]=l}}return e},urlAppend:function(a,b){var c=a;if(b){var d=(a+" ").split(/[?&]/);c+=d.pop()===" "?b:d.length?"&"+b:"?"+b}return c},upperCaseObject:function(a){var b={};for(var c in a)b[c.toUpperCase()]=a[c];return b},createUrlObject:function(a,b){b=b||{};if(!/^\w+:\/\//.test(a)){var c=window.location,d=c.port?":"+c.port:"",e=c.protocol+"//"+c.host.split(":").shift()+d;if(a.indexOf("/")===0)a=e+a;else{var f=c.pathname.split("/");f.pop(),a=e+f.join("/")+"/"+a}}b.ignoreCase&&(a=a.toLowerCase());var g=document.createElement("a");g.href=a;var h={};h.host=g.host.split(":").shift(),h.protocol=g.protocol,b.ignorePort80?h.port=g.port=="80"||g.port=="0"?"":g.port:h.port=g.port==""||g.port=="0"?"80":g.port,h.hash=b.ignoreHash||g.hash==="#"?"":g.hash;var i=g.search;if(!i){var j=a.indexOf("?");i=j!=-1?a.substr(j):""}return h.args=L.Util.getParameters(i),h.pathname=g.pathname.charAt(0)=="/"?g.pathname:"/"+g.pathname,h},stamp:function(){var a=0,b="_leaflet_id";return function(c){return c[b]=c[b]||"_leaflet_id_"+ ++a,c[b]}}(),limitExecByInterval:function(a,b,c){function g(){d=!1,e&&(f.callee.apply(c,f),e=!1)}var d,e,f;return function(){f=arguments,d?e=!0:(d=!0,setTimeout(g,b),a.apply(c,f))}},normalizeScale:function(a){var b=a>1?1/a:a;return b},getSuiteIndex:function(a,b,c){if(!b||!b.length)return-1;c&&b.sort(function(a,b){return b-a});var d,e,f,g=0,h=b.length,i=null;for(d=0;d<h;d++){e=b[d],f=Math.abs(e-a);if(d==0){i=f,g=d;continue}if(f>i)break;i=f,g=d}return g},formatNum:function(a,b){var c=Math.pow(10,b||5);return Math.round(a*c)/c},getParamString:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c+"="+a[c]);return"?"+b.join("&")},template:function(a,b){return a.replace(/\{ *([\w_]+) *\}/g,function(a,c){var d=b[c];if(!b.hasOwnProperty(c))throw new Error("No value provided for variable "+a);return d})},setOptions:function(a,b,c){return a.options=L.Util.extend({},a.options,b),c&&L.Util.extend(a,a.options),a.options},falseFn:function(){return!1},getTime:Date.now||function(){return+(new Date)},checkInArray:function(a,b){if(!b)return!1;var c,d=b.length;for(c=0;c<d;c++)if(b[c]==a)return!0;return!1},Browser:function(){var a=navigator.userAgent.toLowerCase(),b=!!window.ActiveXObject,c=b&&!window.XMLHttpRequest,d=b&&!document.querySelector,e=a.indexOf("webkit")!==-1,f=a.indexOf("safari")!==-1,g=a.indexOf("firefox")!==-1,h=typeof orientation!=undefined+"",i=a.indexOf("chrome")!==-1,j=a.indexOf("android")!==-1,k=a.search("android [23]")!==-1,l=window.navigator&&window.navigator.msPointerEnabled&&window.navigator.msMaxTouchPoints,m=!1,n=document.documentElement,o=b&&"transition"in n.style,p="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix,q="MozPerspective"in n.style,r="OTransition"in n.style,s=window.opera,t=!window.L_DISABLE_3D&&(o||p||q||r),u=!window.L_NO_TOUCH&&function(){var a="ontouchstart";if(l||a in n)return!0;var b=document.createElement("div"),c=!1;return b.setAttribute?(b.setAttribute(a,"return;"),typeof b[a]=="function"&&(c=!0),b.removeAttribute(a),b=null,c):!1}(),v=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,w=!v&&function(){try{var a=document.createElement("div");a.innerHTML='<v:shape adj="1"/>';var b=a.firstChild;return b.style.behavior="url(#default#VML)",b&&typeof b.adj=="object"}catch(c){return!1}}();return{ie:b,ie6:c,ie7:d,webkit:e,android:j,android23:k,chrome:i,opera:s,safari:f,firefox:g,ie3d:o,webkit3d:p,gecko3d:q,opera3d:r,any3d:t,mobile:h,mobileWebkit:h&&e,mobileWebkit3d:h&&p,mobileOpera:h&&!!window.opera,touch:u,msTouch:l,canvas:function(){return!!document.createElement("canvas").getContext}(),svg:v,vml:w}}(),INCHES_PER_UNIT:{inches:1,"in":1,ft:12,mi:63360,m:39.3701,km:39370.1,dd:4382659,degrees:4382659,yd:36,nmi:72913.4252},DOTS_PER_INCH:96,MaxBgTileCount:30,getFitDist:function(a,b,c){return b=b.toLowerCase(),c=c.toLowerCase(),L.Util.INCHES_PER_UNIT[b]&&L.Util.INCHES_PER_UNIT[c]?a*L.Util.INCHES_PER_UNIT[b]/L.Util.INCHES_PER_UNIT[c]:a},get:function(a){return typeof a=="string"?document.getElementById(a):a},getDistByUnits:function(a,b,c,d){var e=0;return c=c||"m",d=d||"m",!!a&&!!b&&a instanceof L.Loc&&b instanceof L.Loc?(c=c.toLowerCase(),c=="dd"||c=="degrees"?(e=L.Util._distanceByLnglat(a.x,a.y,b.x,b.y),e=L.Util.getFitDist(e,"m",d)):(e=a.distanceTo(b),e=L.Util.getFitDist(e,c,d))):e=0,e},_distanceByLnglat:function(a,b,c,d){var e=L.Util._Rad(b),f=L.Util._Rad(d),g=e-f,h=L.Util._Rad(a)-L.Util._Rad(c),i=2*Math.asin(Math.sqrt(Math.pow(Math.sin(g/2),2)+Math.cos(e)*Math.cos(f)*Math.pow(Math.sin(h/2),2)));return i*=6378137,i=Math.round(i*1e4)/1e4,i},_Rad:function(a){return a*Math.PI/180},getAreaByUnits:function(a,b,c){if(!a)return 0;c=c||"km";var d=0;b&&(b=b.toLowerCase());var e=a.length;if(e<3)return d;var f=[],g=[];for(var h=0;h<e;h++){var i=a[h];i&&(f.push(i.x),g.push(i.y))}for(var h=0;h<e-1;){if(f[h]==f[h+1]&&g[h]==g[h+1]){f.splice(h,1),g.splice(h,1),e--;continue}h++}if(b=="degrees"||b=="dd"){var j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=0,M=0,N=0,O=0,P=0,Q=0,R=6378137;for(var h=0;h<e;h++)h==0?(j=f[e-1]*Math.PI/180,k=g[e-1]*Math.PI/180,l=f[0]*Math.PI/180,m=g[0]*Math.PI/180,n=f[1]*Math.PI/180,o=g[1]*Math.PI/180):h==e-1?(j=f[e-2]*Math.PI/180,k=g[e-2]*Math.PI/180,l=f[e-1]*Math.PI/180,m=g[e-1]*Math.PI/180,n=f[0]*Math.PI/180,o=g[0]*Math.PI/180):(j=f[h-1]*Math.PI/180,k=g[h-1]*Math.PI/180,l=f[h]*Math.PI/180,m=g[h]*Math.PI/180,n=f[h+1]*Math.PI/180,o=g[h+1]*Math.PI/180),p=Math.cos(m)*Math.cos(l),q=Math.cos(m)*Math.sin(l),r=Math.sin(m),s=Math.cos(k)*Math.cos(j),t=Math.cos(k)*Math.sin(j),u=Math.sin(k),v=Math.cos(o)*Math.cos(n),w=Math.cos(o)*Math.sin(n),x=Math.sin(o),y=(p*p+q*q+r*r)/(p*s+q*t+r*u),z=(p*p+q*q+r*r)/(p*v+q*w+r*x),A=y*s-p,B=y*t-q,C=y*u-r,D=z*v-p,E=z*w-q,F=z*x-r,K=(D*A+E*B+F*C)/(Math.sqrt(D*D+E*E+F*F)*Math.sqrt(A*A+B*B+C*C)),K=Math.acos(K),G=E*C-F*B,H=0-(D*C-F*A),I=D*B-E*A,p!=0?J=G/p:q!=0?J=H/q:J=I/r,J>0?(M+=K,P++):(N+=K,O++);M>N?Q=M+(2*Math.PI*O-N):Q=2*Math.PI*P-M+N,d=(Q-(e-2)*Math.PI)*R*R,b="m"}else{var S,T,U=0,V=f[0],W=g[0],X=f[1],Y=g[1],Z=V;X-=Z;for(var h=1;h<e;h++)T=W,V=X,W=Y,X=f[h],Y=g[h],X-=Z,U+=V*(Y-T);d=-U/2}var $=L.Util.INCHES_PER_UNIT[b];return d*=Math.pow($/L.Util.INCHES_PER_UNIT[c],2),d},getStyle:function(a,b){var c=a.style[b];!c&&a.currentStyle&&(c=a.currentStyle[b]);if(!c||c==="auto"){var d=document.defaultView.getComputedStyle(a,null);c=d?d[b]:null}return c==="auto"?null:c},getViewportOffset:function(a){var b=0,c=0,d=a,e=document.body;do{b+=d.offsetTop||0,c+=d.offsetLeft||0;if(d.offsetParent===e&&L.Util.getStyle(d,"position")==="absolute")break;d=d.offsetParent}while(d);d=a;do{if(d===e)break;b-=d.scrollTop||0,c-=d.scrollLeft||0,d=d.parentNode}while(d);return new L.Loc(c,b)},create:function(a,b,c){var d=document.createElement(a);return b&&(d.className=b),c&&c.appendChild(d),d},disableTextSelection:function(){document.selection&&document.selection.empty&&document.selection.empty(),this._onselectstart||(this._onselectstart=document.onselectstart,document.onselectstart=L.Util.falseFn)},enableTextSelection:function(){document.onselectstart=this._onselectstart,this._onselectstart=null},hasClass:function(a,b){return a&&a.className&&a.className.length>0&&(new RegExp("(^|\\s)"+b+"(\\s|$)")).test(a.className)},setClass:function(a,b){a&&b&&(a.className=b)},addClass:function(a,b){L.Util.hasClass(a,b)||(a.className+=(a.className?" ":"")+b)},removeClass:function(a,b){if(!a||!a.className)return;var c=a.className.replace(/(\S+)\s*/g,function(a,c){return c===b?"":a}).replace(/^\s+/,"");c=c.replace(b,""),c=c.replace(/^\s+|\s+$/g,""),a.className=c},setOpacity:function(a,b){L.Util.Browser.ie?a.style.filter="alpha(opacity="+Math.round(b*100)+")":a.style.opacity=b},testProp:function(a){var b=document.documentElement.style;for(var c=0;c<a.length;c++)if(a[c]in b)return a[c];return!1},getTranslateString:function(a){var b=L.Util.Browser.webkit3d,c="translate"+(b?"3d":"")+"(",d=(b?",0":"")+")";return c+a.x+"px,"+a.y+"px"+d},getScaleString:function(a,b){var c=L.Util.getTranslateString(b.add(b.multiplyBy(-1*a))),d=" scale("+a+") ";return c+d},setPosition:function(a,b,c,d){if(!a)return;d||(a._leaflet_pos=b);if(!c&&L.Util.Browser.any3d)a.style[L.Util.TRANSFORM]=L.Util.getTranslateString(b),L.Util.Browser.mobileWebkit3d&&(a.style["-webkit-backface-visibility"]="hidden");else{if(isNaN(b.x)||isNaN(b.y))return;a.style.left=b.x+"px",a.style.top=b.y+"px"}},getPosition:function(a,b){if(!a)return null;var c=a._leaflet_pos||null;if(b)if(a.style[L.Util.TRANSFORM]){var d=a.style[L.Util.TRANSFORM];if(d){var e=L.Util.TRANSLATE_OPEN.length,f=d.length-L.Util.TRANSLATE_CLOSE.length-e,g=d.substr(e,f),h=g.indexOf(",");if(h!==-1){var i=g.substr(0,h),j=g.substr(h+1,g.length-h-1);c=c||new L.Loc,c.x=parseInt(i),c.y=parseInt(j)}}}else c=c||new L.Loc,c.x=parseInt(a.style.left),c.y=parseInt(a.style.top);return c},getBezierPos:function(a,b){var c={ease:[.25,.1,.25,1],linear:[0,0,1,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1],"ease-t":[0,0,.58,1]},d=c[b]||c.ease;this._p1=new L.Loc(0,0),this._p2=new L.Loc(d[0],d[1]),this._p3=new L.Loc(d[2],d[3]),this._p4=new L.Loc(1,1);var e=Math.pow(1-a,3),f=3*Math.pow(1-a,2)*a,g=3*(1-a)*Math.pow(a,2),h=Math.pow(a,3),i=this._p1.multiplyBy(e),j=this._p2.multiplyBy(f),k=this._p3.multiplyBy(g),l=this._p4.multiplyBy(h);return i.add(j).add(k).add(l).y},clearAllNode:function(a){if(a){while(a.firstChild){var b=a.removeChild(a.firstChild);b=null}a.empty=!0,a.innerHTML=""}},defaultImageUrl:""},L.Util.TRANSITION=L.Util.testProp(["transition","webkitTransition","OTransition","MozTransition","msTransition"]),L.Util.ISTRANSITIONVALID=!!L.Util.TRANSITION,L.Util.TRANSFORM=L.Util.testProp(["WebkitTransform","OTransform","MozTransform","msTransform","transform"]),L.Util.TRANSITION_END=L.Util.TRANSITION==="webkitTransition"||L.Util.TRANSITION==="MozTransform"||L.Util.TRANSITION==="OTransition"?L.Util.TRANSITION+"End":"transitionend",L.Util.TRANSLATE_OPEN="translate"+(L.Util.Browser.webkit3d?"3d(":"("),L.Util.TRANSLATE_CLOSE=L.Util.Browser.webkit3d?",0)":")",L.Util.LineUtil={simplify:function(a,b){if(!b||!a.length)return a.slice();var c=b*b;return a=this._reducePoints(a,c),a=this._simplifyDP(a,c),a},pointToSegmentDistance:function(a,b,c){return Math.sqrt(this._sqClosestPointOnSegment(a,b,c,!0))},closestPointOnSegment:function(a,b,c){return this._sqClosestPointOnSegment(a,b,c)},_simplifyDP:function(a,b){var c=a.length,d=typeof Uint8Array!==undefined?Uint8Array:Array,e=new d(c);e[0]=e[c-1]=1,this._simplifyDPStep(a,e,b,0,c-1);var f,g=[];for(f=0;f<c;f++)e[f]&&g.push(a[f]);return g},_simplifyDPStep:function(a,b,c,d,e){var f=0,g,h,i;for(h=d+1;h<=e-1;h++)i=this._sqClosestPointOnSegment(a[h],a[d],a[e],!0),i>f&&(g=h,f=i);f>c&&(b[g]=1,this._simplifyDPStep(a,b,c,d,g),this._simplifyDPStep(a,b,c,g,e))},_reducePoints:function(a,b){var c=[a[0]];for(var d=1,e=0,f=a.length;d<f;d++)this._sqDist(a[d],a[e])>b&&(c.push(a[d]),e=d);return e<f-1&&c.push(a[f-1]),c},clipSegment:function(a,b,c,d){var e=c.getLowerPoint(),f=c.getUpperPoint(),g=d?this._lastCode:this._getBitCode(a,c),h=this._getBitCode(b,c);this._lastCode=h;for(;;){if(!(g|h))return[a,b];if(g&h)return!1;var i=g||h,j=this._getEdgeIntersection(a,b,i,c),k=this._getBitCode(j,c);i===g?(a=j,g=k):(b=j,h=k)}},_getEdgeIntersection:function(a,b,c,d){var e=b.x-a.x,f=b.y-a.y,g=d.getLowerPoint(),h=d.getUpperPoint();if(c&8)return new L.Loc(a.x+e*(h.y-a.y)/f,h.y);if(c&4)return new L.Loc(a.x+e*(g.y-a.y)/f,g.y);if(c&2)return new L.Loc(h.x,a.y+f*(h.x-a.x)/e);if(c&1)return new L.Loc(g.x,a.y+f*(g.x-a.x)/e)},_getBitCode:function(a,b){var c=0;return a.x<b.minX?c|=1:a.x>b.maxX&&(c|=2),a.y<b.minY?c|=4:a.y>b.maxY&&(c|=8),c},_sqDist:function(a,b){var c=b.x-a.x,d=b.y-a.y;return c*c+d*d},_sqClosestPointOnSegment:function(a,b,c,d){var e=b.x,f=b.y,g=c.x-e,h=c.y-f,i=g*g+h*h,j;return i>0&&(j=((a.x-e)*g+(a.y-f)*h)/i,j>1?(e=c.x,f=c.y):j>0&&(e+=g*j,f+=h*j)),g=a.x-e,h=a.y-f,d?g*g+h*h:new L.Loc(e,f)}},L.Util.PolyUtil={},L.Util.PolyUtil.clipPolygon=function(a,b){var c=b.getLowerPoint(),d=b.getUpperPoint(),e,f=[1,4,2,8],g,h,i,j,k,l,m,n,o=L.Util.LineUtil;for(g=0,l=a.length;g<l;g++)a[g]._code=o._getBitCode(a[g],b);for(i=0;i<4;i++){m=f[i],e=[];for(g=0,l=a.length,h=l-1;g<l;h=g++)j=a[g],k=a[h],j._code&m?k._code&m||(n=o._getEdgeIntersection(k,j,m,b),n._code=o._getBitCode(n,b),e.push(n)):(k._code&m&&(n=o._getEdgeIntersection(k,j,m,b),n._code=o._getBitCode(n,b),e.push(n)),e.push(j));a=e}return a},L.Util.DDPrjs=["EPSG:4326","EPSG:4610","EPSG:4490"],L.Util.MaxZIndex=999999,L.Class=function(){},L.Class.extend=function(a){var b=function(){this.initialize&&(this.initialize.apply(this,arguments),L.Util.stamp(this)),this._initHooks&&this.callInitHooks()},c=function(){};c.prototype=this.prototype;var d=new c;d.constructor=b,b.prototype=d,b.superclass=this.prototype;for(var e in this)this.hasOwnProperty(e)&&e!=="prototype"&&e!=="superclass"&&(b[e]=this[e]);a.statics&&(L.Util.extend(b,a.statics),delete a.statics),a.includes&&(L.Util.extend.apply(null,[d].concat(a.includes)),delete a.includes),a.options&&d.options&&(a.options=L.Util.extend({},d.options,a.options)),L.Util.extend(d,a),L.Util.extend(d,a.options),b.extend=L.Class.extend,d._initHooks=[];var f=this;return d.callInitHooks=function(){if(this._initHooksCalled)return;f.prototype.callInitHooks&&f.prototype.callInitHooks.call(this),this._initHooksCalled=!0;for(var a=0,b=d._initHooks.length;a<b;a++)d._initHooks[a].call(this)},b},L.Class.include=function(a){L.Util.extend(this.prototype,a)},L.Class.mergeOptions=function(a){L.Util.extend(this.prototype.options,a)},L.Class.addInitHook=function(a){var b=Array.prototype.slice.call(arguments,1),c=typeof a=="function"?a:function(){this[a].apply(this,b)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(c)},L.DomEvent={_touchstart:L.Util.Browser.msTouch?"MSPointerDown":"touchstart",_touchend:L.Util.Browser.msTouch?"MSPointerUp":"touchend",_touchmove:L.Util.Browser.msTouch?"MSPointerMove":"touchmove",addDoubleTapListener:function(a,b,c){function l(a){var b;L.Util.Browser.msTouch?(k.push(a.pointerId),b=k.length):b=a.touches.length;if(b>1)return;var c=Date.now(),h=c-(d||c);g=a.touches?a.touches[0]:a,e=h>0&&h<=f,d=c}function m(a){if(L.Util.Browser.msTouch){var c=k.indexOf(a.pointerId);if(c===-1)return;k.splice(c,1)}if(e){if(L.Util.Browser.msTouch){var f={},h;for(var i in g)h=g[i],typeof h=="function"?f[i]=h.bind(g):f[i]=h;g=f}g.type="dblclick",b(g),d=null}}var d,e=!1,f=250,g,h="_leaflet_",i=this._touchstart,j=this._touchend,k=[];a[h+i+c]=l,a[h+j+c]=m;var n=L.Util.Browser.msTouch?document.documentElement:a;return a.addEventListener(i,l,!1),n.addEventListener(j,m,!1),L.Util.Browser.msTouch&&n.addEventListener("MSPointerCancel",m,!1),this},addListener:function(a,b,c,d){var e=L.Util.stamp(c),f="_leaflet_"+b+e;if(a[f])return this;var g=function(b){return c.call(d||a,b||L.DomEvent._getEvent())};if(L.Util.Browser.touch&&b==="dblclick"&&this.addDoubleTapListener&&!1)this.addDoubleTapListener(a,g,e);else if("addEventListener"in a){if(!(!L.Util.Browser.android||b!="click"&&b!="mousedown"&&b!="mouseup"&&b!="mousemove"&&b!="mouseenter"&&b!="mouseleave"&&b!="mouseout"&&b!="mouseover")){var h=g,i=b;if(b=="click"||b=="mousedown")i=this._touchstart;else if(b=="mouseup")i=this._touchend;else{if(b=="mousemove")return this;if(b=="mouseover"||b=="mouseenter"||b=="mouseleave"||b=="mouseout")return this}return g=function(b){return function(c){if(!L.DomEvent._checkMouse(a,c))return;var d=c.touches&&c.touches[0]?c.touches[0]:c;return d.type=b,h(d)}}(b),a.addEventListener(i,g,!1),a[f]=g,this}if(b==="mousewheel")a.addEventListener("DOMMouseScroll",g,!1),a.addEventListener(b,g,!1);else if(b==="mouseenter"||b==="mouseleave"){var h=g,i=b==="mouseenter"?"mouseover":"mouseout";g=function(b){if(!L.DomEvent._checkMouse(a,b))return;return h(b)},a.addEventListener(i,g,!1)}else a.addEventListener(b,g,!1)}else"attachEvent"in a&&a.attachEvent("on"+b,g);return a[f]=g,this},removeListener:function(a,b,c){var d=L.Util.stamp(c),e="_leaflet_"+b+d,f=a[e];if(!f)return this;if(L.Util.Browser.touch&&b==="dblclick"&&this.removeDoubleTapListener&&!1)this.removeDoubleTapListener(a,d);else if("removeEventListener"in a){if(!(!L.Util.Browser.android||b!="click"&&b!="mousedown"&&b!="mouseup"&&b!="mousemove"&&b!="mouseenter"&&b!="mouseleave"&&b!="mouseout"&&b!="mouseover")){var g=b;if(b=="mousedown")g=this._touchstart;else if(b=="click"||b=="mouseup")g=this._touchend;else if(b=="mousemove")g=this._touchmove;else if(b=="mouseover"||b=="mouseenter"||b=="mouseleave"||b=="mouseout")return a[e]=null,this;return a.removeEventListener(g,f,!1),a[e]=null,this}b==="mousewheel"?(a.removeEventListener("DOMMouseScroll",f,!1),a.removeEventListener(b,f,!1)):b==="mouseenter"||b==="mouseleave"?a.removeEventListener(b==="mouseenter"?"mouseover":"mouseout",f,!1):a.removeEventListener(b,f,!1)}else"detachEvent"in a&&a.detachEvent("on"+b,f);return a[e]=null,this},_checkMouse:function(a,b){var c=b.relatedTarget;if(!c)return!0;try{while(c&&c!==a)c=c.parentNode}catch(d){return!1}return c!==a},_getEvent:function(){var a=window.event;if(!a){var b=arguments.callee.caller;while(b){a=b.arguments[0];if(a&&window.Event===a.constructor)break;b=b.caller}}return a},stopPropagation:function(a){return a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,this},disableClickPropagation:function(a){L.DomEvent.addListener(a,L.Util.Browser.touch?"touchstart":"mousedown",L.DomEvent.stopPropagation),L.DomEvent.addListener(a,"click",L.DomEvent.stopPropagation),L.DomEvent.addListener(a,"dblclick",L.DomEvent.stopPropagation)},preventDefault:function(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this},stop:function(a){L.DomEvent.preventDefault(a).stopPropagation(a)},getMousePosition:function(a,b){var c=a.pageX?a.pageX:a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,d=a.pageY?a.pageY:a.clientY+document.body.scrollTop+document.documentElement.scrollTop,e=new L.Loc(c,d);return b?e.subtract(L.Util.getViewportOffset(b)):e},getWheelDelta:function(a){var b=0;return a.wheelDelta&&(b=a.wheelDelta/120),a.detail&&(b=-a.detail/3),b}},L.Mixin={},L.Mixin.Events={on:function(a,b,c){var d=this._leaflet_events=this._leaflet_events||{};d[a]=d[a]||[];var e={action:b,context:c||this},f=!1;for(var g in d[a])d[a].hasOwnProperty(g)&&d[a][g]&&d[a][g].action==e.action&&d[a][g].context==e.context&&(f=!0);return f||d[a].push({action:b,context:c||this}),this},has:function(a){var b="_leaflet_events";return b in this&&a in this[b]&&this[b][a].length>0},off:function(a,b,c){if(!this.has(a))return this;for(var d=0,e=this._leaflet_events,f=e[a].length;d<f;d++)if(e[a][d].action===b&&(!c||e[a][d].context===c))return e[a].splice(d,1),this;return this},fire:function(a,b){if(!this.has(a))return this;var c=L.Util.extend({type:a,target:this},b),d=this._leaflet_events[a].slice();for(var e=0,f=d.length;e<f;e++)d[e].action.call(d[e].context||this,c);return this}},L.Class=L.Class.extend({getId:function(){return L.Util.stamp(this)}}),L.Icon=L.Class.extend({options:{className:""},initialize:function(a){L.setOptions(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,b){var c=this._getIconUrl(a);if(!c){if(a==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var d;return!b||b.tagName!=="IMG"?d=this._createImg(c):d=this._createImg(c,b),this._setIconStyles(d,a),d},_setIconStyles:function(a,b){var c=this.options,d=L.point(c[b+"Size"]),e;b==="shadow"?e=L.point(c.shadowAnchor||c.iconAnchor):e=L.point(c.iconAnchor),!e&&d&&(e=d.divideBy(2,!0)),a.className="leaflet-marker-"+b+" "+c.className,e&&(a.style.marginLeft=-e.x+"px",a.style.marginTop=-e.y+"px"),d&&(a.style.width=d.x+"px",a.style.height=d.y+"px")},_createImg:function(a,b){return b=b||document.createElement("img"),b.src=a,b},_getIconUrl:function(a){return L.Browser.retina&&this.options[a+"RetinaUrl"]?this.options[a+"RetinaUrl"]:this.options[a+"Url"]}}),L.icon=function(a){return new L.Icon(a)},L.Icon.Default=L.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(a){var b=a+"Url";if(this.options[b])return this.options[b];L.Browser.retina&&a==="icon"&&(a+="-2x");var c=L.Icon.Default.imagePath;if(!c)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return c+"/marker-"+a+".png"}}),L.Icon.Default.imagePath=function(){var a=document.getElementsByTagName("script"),b=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/,c,d,e,f,g;for(c=0,d=a.length;c<d;c++){e=a[c].src,f=e.match(b);if(f)return g=e.split(b)[0],(g?g+"/":"")+"images/"}}(),L.Loc=L.Class.extend({x:null,y:null,initialize:function(a,b){this.x=a,this.y=b,this.x=this.x!==undefined&&this.x!==null?parseFloat(this.x):0,this.y=this.y!==undefined&&this.y!==null?parseFloat(this.y):0},add:function(a){return this.clone()._add(a)},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(a)},equals:function(a){return a?this.x===a.x&&this.y===a.y:!1},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a,b){return new L.Loc(this.x/a,this.y/a,b)},multiplyBy:function(a){return new L.Loc(this.x*a,this.y*a)},distanceTo:function(a){var b=a.x-this.x,c=a.y-this.y;return Math.sqrt(b*b+c*c)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},clone:function(){return new L.Loc(this.x,this.y)},toString:function(){return"Point("+L.Util.formatNum(this.x)+", "+L.Util.formatNum(this.y)+")"}}),L.Extent=L.Class.extend({initialize:function(a,b,c,d){a&&a instanceof L.Loc&&b&&b instanceof L.Loc?(this.minX=a.x>b.x?b.x:a.x,this.minY=a.y>b.y?b.y:a.y,this.maxX=a.x<b.x?b.x:a.x,this.maxY=a.y<b.y?b.y:a.y):(this.minX=a>c?c:a,this.minY=b<d?b:d,this.maxX=a>c?a:c,this.maxY=b>d?b:d),this.minX=parseFloat(this.minX),this.maxY=parseFloat(this.maxY),this.minY=parseFloat(this.minY),this.maxX=parseFloat(this.maxX)},extend:function(a){if(!a)return;var b=null;a instanceof L.Loc?b=new L.Extent(a.x,a.y,a.x,a.y):a instanceof L.Extent&&(b=a),this.minX=this.minX==undefined?b.minX:Math.min(b.minX,this.minX),this.maxX=this.maxX==undefined?b.maxX:Math.max(b.maxX,this.maxX),this.minY=this.minY==undefined?b.minY:Math.min(b.minY,this.minY),this.maxY=this.maxY==undefined?b.maxY:Math.max(b.maxY,this.maxY)},exportToString:function(a){var b;return a?b=this.minY+","+this.minX+","+this.maxY+","+this.maxX:b=this.minX+","+this.minY+","+this.maxX+","+this.maxY,b},extendByBounds:function(a){if(!a||!(a instanceof L.Extent))return;this.extend(new L.Loc(a.minX,a.minY)),this.extend(new L.Loc(a.maxX,a.maxY))},getCenter:function(a){var b=new L.Loc((this.minX+this.maxX)/2,(this.minY+this.maxY)/2);return a&&(b.x=Math.round(b.x),b.y=Math.round(b.y)),b},contains:function(a){var b,c,d,e;return a instanceof L.Extent?(b=a.minX,c=a.maxX,d=a.minY,e=a.maxY):a instanceof L.Loc&&(b=c=a.x,d=e=a.y),b>=this.minX&&c<=this.maxX&&d>=this.minY&&e<=this.maxY},getLowerPoint:function(){return new L.Loc(this.minX,this.minY)},getUpperPoint:function(){return new L.Loc(this.maxX,this.maxY)},getWidth:function(){return this.maxX-this.minX},getHeight:function(){return this.maxY-this.minY},intersects:function(a){if(!!a&&a instanceof L.Extent){var b=a.maxX>=this.minX&&a.minX<=this.maxX,c=a.maxY>=this.minY&&a.minY<=this.maxY;return b&&c}return!1}}),L.Proj=L.Class.extend({initialize:function(a,b){this.srsCode=a,L.Util.setOptions(this,b)},getSrsCode:function(){return this.srsCode},getAxisOrder:function(){var a={"EPSG:900913":!0,"EPSG:3857":!0,"CRS:84":!0,'GEOGCS["WGS_2000",DATUM["WGS_2000",SPHEROID["WGS_2000",6378137,298.257221101]],PRIMEM["GREENWICH",0],UNIT["DEGREE",0.0174532925199433]]':!0,'GEOGCS["CGCS2000",DATUM["D_CGCS2000",SPHEROID["CGCS2000",6378137,298.257221101]],PRIMEM["GREENWICH",0],UNIT["DEGREE",0.0174532925199433]]':!0},b=this.getSrsCode().toUpperCase();return!a.hasOwnProperty(b)},getUnits:function(){var a="m";for(var b=0;b<L.Util.DDPrjs.length;b++)L.Util.DDPrjs[b]&&L.Util.DDPrjs[b].toLowerCase()==this.srsCode.toLowerCase()&&(a="dd");return a}}),L.HttpObj={DEFAULT_CONFIG:{method:"GET",url:window.location.href,async:!0,user:undefined,password:undefined,params:null,proxy:undefined,headers:{},data:null,callback:function(){},success:null,failure:null,scope:null},URL_SPLIT_REGEX:/([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/,issue:function(a){var b=this.DEFAULT_CONFIG;a=L.Util.applyDefaults(a,b);var c=new L.HttpObj.XMLHttpRequest,d=L.Util.urlAppend(a.url,L.Util.getParameterString(a.params||{})),e=d.indexOf("http")!=0,f=!e&&d.match(this.URL_SPLIT_REGEX);if(f){var g=window.location;e=f[1]==g.protocol&&f[3]==g.hostname;var h=f[4],i=g.port;if(h!=80&&h!=""||i!="80"&&i!="")e=e&&h==i}e||a.proxy&&(typeof a.proxy=="function"?d=a.proxy(d):d=a.proxy+encodeURIComponent(d)),c.open(a.method,d,a.async,a.user,a.password);for(var j in a.headers)c.setRequestHeader(j,a.headers[j]);var k=this;return c.onreadystatechange=function(){c.readyState==L.HttpObj.XMLHttpRequest.DONE&&k.runCallbacks({request:c,config:a,requestUrl:d})},a.async===!1?c.send(a.data):window.setTimeout(function(){c.readyState!==0&&c.send(a.data)},0),c},runCallbacks:function(a){var b=a.request,c=a.config,d=c.scope?L.Util.bind(c.callback,c.scope):c.callback,e;c.success&&(e=c.scope?L.Util.bind(c.success,c.scope):c.success);var f;c.failure&&(f=c.scope?L.Util.bind(c.failure,c.scope):c.failure),L.Util.createUrlObject(c.url).protocol=="file:"&&b.responseText&&(b.status=200),d(b),(!b.status||b.status>=200&&b.status<300)&&e&&e(b),b.status&&(b.status<200||b.status>=300)&&f&&f(b)},GET:function(a){if(typeof a.callback!="string")return a=L.Util.extend(a,{method:"GET"}),L.HttpObj.issue(a);var b=document.createElement("script");b.charset="utf-8",b.type="text/javascript";var c=a.url;a.callback?b.src=c+"&callback="+a.callback:b.src=c,document.body.appendChild(b)},POST:function(a){return a=L.Util.extend(a,{method:"POST"}),a.headers=a.headers?a.headers:{},"CONTENT-TYPE"in L.Util.upperCaseObject(a.headers)||(a.headers["Content-Type"]="application/xml"),L.HttpObj.issue(a)},PUT:function(a){return a=L.Util.extend(a,{method:"PUT"}),a.headers=a.headers?a.headers:{},"CONTENT-TYPE"in L.Util.upperCaseObject(a.headers)||(a.headers["Content-Type"]="application/xml"),L.HttpObj.issue(a)},DELETE:function(a){return a=L.Util.extend(a,{method:"DELETE"}),L.HttpObj.issue(a)},HEAD:function(a){return a=L.Util.extend(a,{method:"HEAD"}),L.HttpObj.issue(a)},OPTIONS:function(a){return a=L.Util.extend(a,{method:"OPTIONS"}),L.HttpObj.issue(a)}},L.HttpObjOptions={url:null,async:!0,user:null,password:null,params:null,headers:null,data:null,callback:null,success:null,failure:null,scope:null},L.Transition=L.Class.extend({includes:L.Mixin.Events,statics:{CUSTOM_PROPS_SETTERS:{position:L.Util.setPosition}},options:{easing:"ease",duration:.5},_setProperty:function(a,b){var c=L.Transition.CUSTOM_PROPS_SETTERS;a in c?c[a](this._el,b):this._el.style[a]=b}}),L.Transition=L.Transition.extend({statics:function(){var a=L.Util.TRANSITION,b=L.Util.TRANSITION_END;return{TRANSITION:a,PROPERTY:a+"Property",DURATION:a+"Duration",EASING:a+"TimingFunction",END:b,CUSTOM_PROPS_PROPERTIES:{position:L.Util.TRANSFORM?L.Util.TRANSFORM:"top, left"}}}(),options:{fakeStepInterval:100},initialize:function(a,b){this._el=a,L.Util.setOptions(this,b),L.DomEvent.addListener(a,L.Transition.END,this._onTransitionEnd,this),this._onFakeStep=L.Util.bind(this._onFakeStep,this)},run:function(a){var b,c=[],d=L.Transition.CUSTOM_PROPS_PROPERTIES;for(b in a)a.hasOwnProperty(b)&&(b=d[b]?d[b]:b,b=this._dasherize(b),c.push(b));this._el.style[L.Transition.DURATION]=this.options.duration+"s",this._el.style[L.Transition.EASING]=this.options.easing,this._el.style[L.Transition.PROPERTY]=c.join(", ");for(b in a)a.hasOwnProperty(b)&&this._setProperty(b,a[b]);this._inProgress=!0,this.fire("start"),L.Util.ISTRANSITIONVALID?(clearInterval(this._timer),this._timer=setInterval(this._onFakeStep,this.options.fakeStepInterval)):this._onTransitionEnd()},_dasherize:function(){function a(a){return"-"+a.toLowerCase()}return function(b){return b.replace(/([A-Z])/g,a)}}(),_onFakeStep:function(){this.fire("step")},_onTransitionEnd:function(a){this._inProgress&&(this._inProgress=!1,clearInterval(this._timer),this._el.style[L.Transition.PROPERTY]="none",this.fire("step"),a&&a.type&&this.fire("end"))}}),L.Transition=L.Util.ISTRANSITIONVALID?L.Transition:L.Transition.extend({statics:{TIMER:!0,EASINGS:{ease:[.25,.1,.25,1],linear:[0,0,1,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1],"ease-t":[0,.3,.68,1]},CUSTOM_PROPS_GETTERS:{position:L.Util.getPosition}},options:{fps:50},initialize:function(a,b){this._el=a,L.Util.extend(this.options,b);var c=L.Transition.EASINGS[this.options.easing]||L.Transition.EASINGS.ease;this._p1=new L.Loc(0,0),this._p2=new L.Loc(c[0],c[1]),this._p3=new L.Loc(c[2],c[3]),this._p4=new L.Loc(1,1),this._step=L.Util.bind(this._step,this),this._interval=Math.round(1e3/this.options.fps)},run:function(a){this._props={};var b=L.Transition.CUSTOM_PROPS_GETTERS;this._inProgress=!0,this.fire("start");for(var c in a)if(a.hasOwnProperty(c)){var d={};if(c in b)d.from=b[c](this._el);else{var e=this._el.style[c].match(/^[\d\.]+(\D*)$/);d.from=parseFloat(e[0]),d.unit=e[1]}d.to=a[c],this._props[c]=d}clearInterval(this._timer),this._timer=setInterval(this._step,this._interval),this._startTime=L.Util.getTime()},_step:function(){var a=L.Util.getTime(),b=a-this._startTime,c=this.options.duration*1e3;b<c?this._runFrame(this._cubicBezier(b/c)):(this._runFrame(1),this._complete())},_runFrame:function(a){var b=L.Transition.CUSTOM_PROPS_SETTERS,c,d,e;for(c in this._props)this._props.hasOwnProperty(c)&&(d=this._props[c],c in b?(e=d.to.subtract(d.from).multiplyBy(a).add(d.from),b[c](this._el,e)):this._el.style[c]=(d.to-d.from)*a+d.from+d.unit);this.fire("step")},_complete:function(){clearInterval(this._timer),this.fire("end")},_onTransitionEnd:function(a){this._inProgress&&(this._inProgress=!1,this._complete())},_cubicBezier:function(a){var b=Math.pow(1-a,3),c=3*Math.pow(1-a,2)*a,d=3*(1-a)*Math.pow(a,2),e=Math.pow(a,3),f=this._p1.multiplyBy(b),g=this._p2.multiplyBy(c),h=this._p3.multiplyBy(d),i=this._p4.multiplyBy(e);return f.add(g).add(h).add(i).y}}),function(){function e(){this._object=a&&!d?new a:new window.ActiveXObject("Microsoft.XMLHTTP"),this._listeners=[]}function f(){return new e}function g(a){a._object.send(a._data);if(b&&!a._async){a.readyState=f.OPENED,j(a);while(a.readyState<f.DONE){a.readyState++,h(a);if(a._aborted)return}}}function h(a){f.onreadystatechange&&f.onreadystatechange.apply(a),a.dispatchEvent({type:"readystatechange",bubbles:!1,cancelable:!1,timeStamp:new Date+0})}function i(a){var b=a.responseXML,d=a.responseText;c&&d&&b&&!b.documentElement&&a.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/)&&(b=new window.ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.validateOnParse=!1
,b.loadXML(d));if(b)if(c&&b.parseError!=0||!b.documentElement||b.documentElement&&b.documentElement.tagName=="parsererror")return null;return b}function j(a){try{a.responseText=a._object.responseText}catch(b){}try{a.responseXML=i(a._object)}catch(b){}try{a.status=a._object.status}catch(b){}try{a.statusText=a._object.statusText}catch(b){}}function k(a){a._object.onreadystatechange=new window.Function}var a=window.XMLHttpRequest,b=!!window.controllers,c=window.document.all&&!window.opera,d=c&&window.navigator.userAgent.match(/MSIE 7.0/);f.prototype=e.prototype,b&&a.wrapped&&(f.wrapped=a.wrapped),f.UNSENT=0,f.OPENED=1,f.HEADERS_RECEIVED=2,f.LOADING=3,f.DONE=4,f.prototype.readyState=f.UNSENT,f.prototype.responseText="",f.prototype.responseXML=null,f.prototype.status=0,f.prototype.statusText="",f.prototype.priority="NORMAL",f.prototype.onreadystatechange=null,f.onreadystatechange=null,f.onopen=null,f.onsend=null,f.onabort=null,f.prototype.open=function(a,d,e,g,i){delete this._headers,arguments.length<3&&(e=!0),this._async=e;var l=this,m=this.readyState,n;c&&e&&(n=function(){m!=f.DONE&&(k(l),l.abort())},window.attachEvent("onunload",n)),f.onopen&&f.onopen.apply(this,arguments),arguments.length>4?this._object.open(a,d,e,g,i):arguments.length>3?this._object.open(a,d,e,g):this._object.open(a,d,e),this.readyState=f.OPENED,h(this),this._object.onreadystatechange=function(){if(b&&!e)return;l.readyState=l._object.readyState,j(l);if(l._aborted){l.readyState=f.UNSENT;return}l.readyState==f.DONE&&(delete l._data,k(l),c&&e&&window.detachEvent("onunload",n)),m!=l.readyState&&h(l),m=l.readyState}},f.prototype.send=function(a){f.onsend&&f.onsend.apply(this,arguments),arguments.length||(a=null),a&&a.nodeType&&(a=window.XMLSerializer?(new window.XMLSerializer).serializeToString(a):a.xml,oRequest._headers["Content-Type"]||oRequest._object.setRequestHeader("Content-Type","application/xml")),this._data=a,g(this)},f.prototype.abort=function(){f.onabort&&f.onabort.apply(this,arguments),this.readyState>f.UNSENT&&(this._aborted=!0),this._object.abort(),k(this),this.readyState=f.UNSENT,delete this._data},f.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()},f.prototype.getResponseHeader=function(a){return this._object.getResponseHeader(a)},f.prototype.setRequestHeader=function(a,b){return this._headers||(this._headers={}),this._headers[a]=b,this._object.setRequestHeader(a,b)},f.prototype.addEventListener=function(a,b,c){for(var d=0,e;e=this._listeners[d];d++)if(e[0]==a&&e[1]==b&&e[2]==c)return;this._listeners.push([a,b,c])},f.prototype.removeEventListener=function(a,b,c){for(var d=0,e;e=this._listeners[d];d++)if(e[0]==a&&e[1]==b&&e[2]==c)break;e&&this._listeners.splice(d,1)},f.prototype.dispatchEvent=function(a){var b={type:a.type,target:this,currentTarget:this,eventPhase:2,bubbles:a.bubbles,cancelable:a.cancelable,timeStamp:a.timeStamp,stopPropagation:function(){},preventDefault:function(){},initEvent:function(){}};b.type=="readystatechange"&&this.onreadystatechange&&(this.onreadystatechange.handleEvent||this.onreadystatechange).apply(this,[b]);for(var c=0,d;d=this._listeners[c];c++)d[0]==b.type&&!d[2]&&(d[1].handleEvent||d[1]).apply(this,[b])},f.prototype.toString=function(){return"[object XMLHttpRequest]"},f.toString=function(){return"[XMLHttpRequest]"},window.Function.prototype.apply||(window.Function.prototype.apply=function(a,b){b||(b=[]),a.__func=this,a.__func(b[0],b[1],b[2],b[3],b[4]),delete a.__func}),L.HttpObj.XMLHttpRequest=f}(),L.Map=L.Class.extend({includes:L.Mixin.Events,options:{center:null,zoom:null,layers:[],drag:!0,touchZoom:L.Util.Browser.touch&&!L.Util.Browser.android,scrollWheelZoom:!L.Util.Browser.touch,doubleClickZoom:!0,boxZoom:!0,zoomControl:!0,attributionControl:!1,zoomAnimation:L.Util.TRANSITION&&!L.Util.Browser.android23&&!L.Util.Browser.mobileOpera,markerZoomAnimation:L.Util.TRANSITION&&L.Util.Browser.any3d,closeDialogOnClick:!1,dragging:!0,inertia:!L.Util.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1300,inertiaThreshold:L.Util.Browser.touch?32:18,easeLinearity:.25,longPress:!0,worldCopyJump:!1},initialize:function(a,b){L.Util.setOptions(this,b),b=L.Util.extend({},b),this._container=L.Util.get(a);if(this._container._leaflet_used_tag)throw new Error("Map container is already initialized.");this._container._leaflet_used_tag=!0,this._initLayout(),this._initEvents(),this._initInteraction(),this._layers={},this._layerIds=new Array;if(b){b&&b.maxExtent&&this.setMaxBounds(b.maxExtent);var c=this.options.layers||[];c=c instanceof Array?c:[c],this._initLayers(c);var d=this.options.center,e=this.options.zoom;d!==null&&e!==null&&this.basicLayer&&this.setView(d,e)}this._initOverlays()},getSize:function(){if(!this._size||this._sizeChanged)this._size=new L.Loc(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1;return this._size},getCenter:function(){return this._getCenter()},getZoom:function(){return this.zoom},getZoomCount:function(){var a=0;return this.basicLayer&&(a=this.basicLayer.resolutions.length),a},getScale:function(){var a=null;if(this.basicLayer!=null){var b=this.getUnits(),c=this.getResolution();b===null&&(b="degrees"),a=c*L.Util.INCHES_PER_UNIT[b]*96}return a},getResolution:function(){var a=null;return this.basicLayer!=null&&(a=this.basicLayer._getResolution()),a},getResolutions:function(){return this.basicLayer?this.basicLayer._getResolutions():null},getExtent:function(){var a=null;return this.basicLayer!=null&&(a=this.basicLayer._getExtent()),a},getMaxExtent:function(){var a=null;return this.basicLayer?a=this.maxExtent||this.basicLayer.maxExtent||this._getDefaultMaxExtent():a=this.maxExtent||this._getDefaultMaxExtent(),a},getUnits:function(){return this.basicLayer?this.basicLayer.getUnits():this.units||"dd"},getProjection:function(){return this.basicLayer?this.basicLayer.getProjection():null},zoomIn:function(){return this._setZoom(this.zoom+1)},zoomOut:function(){return this._setZoom(this.zoom-1)},moveTo:function(a,b){return this.setView(a,b)},panBy:function(a,b){return!a.x&&!a.y?this:(this._panTransition||(this._panTransition=new L.Transition(this._mapPane,b),this._panTransition.on("step",this._onPanTransitionStep,this),this._panTransition.on("end",this._onPanTransitionEnd,this)),this.fire("movestart"),L.Util.addClass(this._mapPane,"leaflet-pan-anim"),this._panTransition.run({position:L.Util.getPosition(this._mapPane).subtract(a)}),this.on("zoomstart",this._endPanBy,this),this)},_endPanBy:function(){this._panTransition._onTransitionEnd();var a=this.basicLayer._container,b=this._tileBg;if(b){this._stopLoadingImages(a);return}},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){L.Util.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_getLoadedTilesPercentage:function(a){var b=a.getElementsByTagName("img"),c,d,e=0;for(c=0,d=b.length;c<d;c++)b[c].complete&&e++;return d==0?1:e/d},_stopLoadingImages:function(a){var b=a.getElementsByTagName("img"),c,d,e;for(c=0,d=b.length;c<d;c++)e=b[c],e&&!e.complete&&(e.onload=L.Util.falseFn,e.onerror=L.Util.falseFn,e.src="",e.parentNode.removeChild(e))},_stopLoadingBgTiles:function(){var a=[].slice.call(this._tileBg.getElementsByTagName("img"));for(var b=0,c=a.length;b<c;b++)a[b].complete||(a[b].parentNode.removeChild(a[b]),a[b]=null)},_loadTileBg:function(){if(this._bTileBgTag&&this.basicLayer){var a=this.basicLayer._container,b=this._tileBg;a&&b&&this._getLoadedTilesPercentage(a)>.9&&this._clearTileBg()}},zoomToMaxExtent:function(){var a=this.getMaxExtent();a&&this.zoomToExtent(a)},zoomToExtent:function(a){if(a&&a instanceof L.Extent){var b=a.getCenter(),c=this.getZoomForBounds(a);this.setView(b,c)}},zoomToScale:function(a,b){if(a&&!isNaN(a)){var c=this.getUnits(),d=a/(L.Util.INCHES_PER_UNIT[c]*96),b=b||this.getCenter(),e=this.basicLayer._getZoomByRes(d);this.setView(b,e)}else this.zoomToMaxExtent()},_zoomWithAnimation:function(a,b,c){if(this._getAnimatingZoom())return!0;if(!this.basicLayer instanceof L.Layers.TileBase)return!1;this._animateToCenter=a,this._animateToZoom=b,this._clearTileBgTimer&&clearTimeout(this._clearTileBgTimer),this.fire("zoomstart"),this._prepareTileBg();if(!this._tileBg||this._tileBg.children.length==0)return!1;var d=this._tileBg.getElementsByTagName("img");if(!d||d.length<=0)return!1;L.Util.addClass(this._mapPane,"leaflet-zoom-anim2");var e=this.getResolution(),f=this.getResByZoom(b);this._scale=f/e,this._zoomCenter=a.subtract(this._getCenter().multiplyBy(this._scale)).divideBy(1-this._scale),this._zoomCenterPixel=this._pointToAbsPixel(this._zoomCenter),this._interval=Math.round(1e3/60),this._startTime=L.Util.getTime(),clearInterval(this._zoomAnimationTimer);var g=this;return this._zoomAnimationTimer=setInterval(g._zoomAnimationStep(g),this._interval),!0},_zoomAnimationStep:function(a){var b=a;return function(){var a=L.Util.getTime(),c=a-b._startTime,d=400;c<d?b._runTimerAnimation(L.Util.getBezierPos(c/d)):(b._runTimerAnimation(1),b._completeZoomAnim())}},_getAnimatingZoom:function(){return this._animatingZoom||this._tmpAnimatingZoom},_runTimerAnimation:function(a){var b=this._tileBg.getElementsByTagName("img"),c,d,e=1+(this._scale-1)*a,f,g;this._tmpAnimatingZoom=!0;for(var h=0,i=b.length;h<i;h++){d=b[h];if(!d)continue;this._animatingZoom||(d._aiw=parseInt(d.style.width),d._aiy=parseInt(d.style.height),c=L.Util.getPosition(d,!0),c&&L.Util.setPosition(d,new L.Loc(parseInt(c.x),parseInt(c.y)))),c=L.Util.getPosition(d),f=Math.ceil(d._aiw/e),g=Math.ceil(d._aiy/e),d.style.width=f+"px",d.style.height=g+"px";var j=1+(this._scale-1)*a,k=c.subtract(this._zoomCenterPixel).divideBy(j).add(this._zoomCenterPixel);L.Util.setPosition(d,k,!1,!0)}this._tmpAnimatingZoom=!1,this._animatingZoom=!0,this.fire("step")},_completeZoomAnim:function(){clearInterval(this._zoomAnimationTimer),this._onZoomTransitionEnd()},_onZoomTransitionEnd:function(){L.Util.falseFn(this._tileBg.offsetWidth),this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),L.Util.removeClass(this._mapPane,"leaflet-zoom-anim2"),this._tmpAnimatingZoom=!1,this._animatingZoom=!1},_prepareTileBg:function(){var a=this.basicLayer._container,b=this._tileBg;if(b&&this._getLoadedTilesPercentage(b)>.5&&this._getLoadedTilesPercentage(a)<.5){this._stopLoadingImages(a);return}this._tileBg&&this._tileBg.childNodes&&this._tileBg.childNodes.length>L.Util.MaxBgTileCount&&this._clearTileBg(),this._tileBg||(this._tileBg=L.Util.create("div","leaflet-tile-pane",this._mapPane),this._tileBg.style.zIndex=1);var c=this.basicLayer._tiles;this._initialTileSize=this.basicLayer.getTileSize?this.basicLayer.getTileSize():this.getSize();var d=[],e;for(e in c)c.hasOwnProperty(e)&&c[e].complete&&d.push(c[e]);c=null;if(d.length>0){var f,g;for(f=0,g=d.length;f<g;f++)this._tileBg.appendChild(d[f])}d.length=0,d=null,this._bTileBgTag=!0,this.basicLayer&&(this.basicLayer.on("loaded",this._clearTileBg,this),this.basicLayer.on("tileload",this._loadTileBg,this),this._ieBgClearTimer&&clearInterval(this._ieBgClearTimer),this._ieBgClearTimer=setInterval(this._clearIeTileBg(this),2e3))},_clearIeTileBg:function(a){var b=a;return function(){b._loadTileBg()}},setMode:function(a,b){a=a.toLowerCase();if(this._curMode&&this._curMode==a)return this;(this._curMode=="measurelength"||this._curMode=="measurearea")&&this._handlers[this._curMode]&&this._handlers[this._curMode].disable();var c=[];a=="dragzoom"?(this._hegemonTag=!1,c=["drag","doubleclickzoom","scrollwheelzoom","touchzoom"]):a=="drag"?(this._hegemonTag=!1,c=["drag"]):a=="zoom"?(this._hegemonTag=!1,c=["doubleclickzoom","scrollwheelzoom","touchzoom"]):a=="measurelength"?(this._hegemonTag=!0,this.on("measureend",this._onMeasureEnd,this),c=["doubleclickzoom","drag","scrollwheelzoom","measurelength"]):a=="measurearea"?(this._hegemonTag=!0,this.on("measureend",this._onMeasureEnd,this),c=["doubleclickzoom","drag","scrollwheelzoom","measurearea"]):a=="drawpoint"?(this._hegemonTag=!0,c=["doubleclickzoom","drag","drawpoint"]):a=="drawline"?(this._hegemonTag=!0,c=["doubleclickzoom","drawline"]):a=="drawpolygon"?(this._hegemonTag=!0,c=["doubleclickzoom","doubleclickzoom","drawpolygon"]):a=="drawrect"?(this._hegemonTag=!0,c=["doubleclickzoom","drawrect"]):a=="zoomboxin"?(this._hegemonTag=!0,b=b||{},b._zoomInTag=!0,c=["zoomboxin","doubleclickzoom","scrollwheelzoom"]):a=="zoomboxout"?(b=b||{},b._zoomInTag=!1,this._hegemonTag=!0,c=["zoomboxout","doubleclickzoom","scrollwheelzoom"]):a=="drawcircle"?(this._hegemonTag=!0,c=["drawcircle"]):a=="drawsector"?(this._hegemonTag=!0,c=["drawsector"]):a=="drawmarker"&&(this._hegemonTag=!0,c=["drag","drawmarker"]);var d=0,e=c.length;if(e<=0)return this;this._handlers=this._handlers||{};var f;for(d=0;d<e;d++)f=c[d],this._handlers.hasOwnProperty(f)&&this._handlers[f]?this._handlers[f].enable():L.HandlerHash[f]&&(this._handlers[f]=new L.HandlerHash[f](this),this._handlers[f].enable());for(f in this._handlers)this._handlers.hasOwnProperty(f)&&this._handlers[f]&&!L.Util.checkInArray(f,c)&&this._handlers[f]&&this._handlers[f].disable();return this._handlers[a]&&this._handlers[a].setHandlerOptions&&this._handlers[a]&&this._handlers[a].setHandlerOptions(b),this._curMode=a,this},_checkDragEnable:function(){if(!this._handlers||!this._handlers.drag)return!1;var a=!0;if(this._curMode=="measurelength"||this._curMode=="measurearea"||this._curMode=="drawcircle"||this._curMode=="drawpolygon"||this._curMode=="drawrect"||this._curMode=="drawline"||this._curMode=="drawsector"||this._curMode=="zoom")a=!1;return a},getBasicLayer:function(){return this.basicLayer||null},setBasicLayer:function(a){if(!a||!a.isBasicLayer)return this;this.hasLayer(a)||this.addLayer(a);var b=null,c=null;this.basicLayer&&(b=this.getExtent(),c=this.getResolution());if(!this.basicLayer||L.Util.stamp(this.basicLayer)!=L.Util.stamp(a)){this.basicLayer!=null&&(this._clearTileBg(),this.basicLayer.off("loaded",this._clearTileBg,this),this.basicLayer.off("tileload",this._loadTileBg,this),this.basicLayer.setVisible(!1)),this.basicLayer=a,this.basicLayer.on("loaded",this._clearTileBg,this),this.basicLayer.setVisible(!0);var d=this.getCenter();if(d!=null){var e=b?b.getCenter():d;if(this.basicLayer.maxExtent!=null&&!this.basicLayer.maxExtent.contains(e))this.zoomToMaxExtent();else{d=this.options.center,zoom=this.options.zoom;if(d!==null||zoom!==null)this.setView(d,zoom,!0);else{var f=this.basicLayer._getZoomByRes(c);this.setView(e,f,!0)}}}this.fire("changebasiclayer",{layer:this.basicLayer})}return this},_checkAllLayersFilledTag:function(){return this.basicLayer._filledTag},addLayer:function(a,b){if(!a)return this;var c=L.Util.stamp(a);return this._layers[c]?this:(this.fire("preaddlayer",{layer:a}),this._layers[c]=a,a.isBasicLayer?this._layerIds.splice(0,0,c):this._layerIds.push(c),a._setMap(this),this.attributionControl&&a.getAttribution&&this.attributionControl.addAttribution(a.getAttribution()),a.isBasicLayer?this.basicLayer?a.setVisible(!1):this.setBasicLayer(a):a.redraw(),this.fire("layeradded",{layer:a}),a._afterAdd&&a._afterAdd(),this)},whenReady:function(a,b){return this._loaded?a.call(b||this,this):this.on("load",a,b),this},hasLayer:function(a){var b=L.Util.stamp(a);return this._layers.hasOwnProperty(b)},removeLayer:function(a){var b=L.Util.stamp(a);if(!this._layers[b])return this;var c=this.getLayersCount(),d,e;for(e=0;e<c;e++)if(this._layerIds[e]==b){d=e;break}var f=null,g;if(a.isBasicLayer){for(e=0;e<c;e++){g=this._layerIds[e];if(g==b)continue;if(this._layers[g]&&this._layers[g].isBasicLayer){f=g;break}}if(!f)return this;this.setBasicLayer(this._layers[f])}return a._unsetMap(),delete this._layerIds[d],delete this._layers[b],this.fire("layerremoved",{layer:a}),this},getLayersCount:function(){return this._layerIds?this._layerIds.length:0},getLayers:function(){var a=null;if(!this._layers)return null;var b;for(b in this._layers)this._layers.hasOwnProperty(b)&&this._layers[b]&&(a||(a=new Array),a.push(this._layers[b]));return a},getLayersByName:function(a,b){var c=null;if(!this._layers)return null;var d,e;a=b?a.toLowerCase():a;for(d in this._layers)this._layers.hasOwnProperty(d)&&this._layers[d]&&(e=this._layers[d].getName(),e=b?e.toLowerCase():e,e==a&&(c||(c=new Array),c.push(this._layers[d])));return c},getLayerById:function(a){if(!this._layers)return null;var b,c;a=a.toLowerCase();for(b in this._layers)if(this._layers.hasOwnProperty(b)&&this._layers[b]){c=this._layers[b].getId(),c=c.toLowerCase();if(c==a)return this._layers[b]}return null},addHotspots:function(a,b){if(!a)return;var c=a instanceof Array?a:[a],d=0,e,f,g,h,i=0,j=c.length;while(i<j){f=c[i];if(f&&f.getPosition()){e=L.Util.stamp(f);if(!this.hasHotspot(e)){f._setMap(this),h=this.getHotspotsCount();if(!b)for(d=0;d<h;d++){g=this._hotspots[d];if(g&&g.getPosition().y>f.getPosition().y)break}this._hotspots.splice(d,0,f),this.fire("hotspotadded",{hotspot:f})}}i++}this.getHotspotsCount()>0?this.on("mousemove",this._checkHotspot,this):this.off("mousemove",this._checkHotspot)},setHotspotInfoOffset:function(a){a&&a instanceof L.Loc&&this.setHotspotLabelOptions({offset:a})},getHotspotsCount:function(){return this._hotspots?this._hotspots.length:0},hasHotspot:function(a){var b=L.Util.stamp(a),c,d,e=this._hotspots.length-1;while(e>=0){d=this._hotspots[e];if(d){c=L.Util.stamp(d);if(c==b)return!0}e--}return!1},removeHotspots:function(a){var b=this.getHotspotsCount();if(!a||b<=0)return;var c=a instanceof Array?a:[a],d=0,e,f,g,h,i,j=0,k=c.length-1;while(k>=0){g=c[k];if(g&&g instanceof L.Ols.Spot){e=L.Util.stamp(g),f=this._hotspots.length-1;while(f>=0){h=this._hotspots[f];if(h){hsId=L.Util.stamp(h);if(e==hsId){this._hotspots.splice(f,1),this.fire("hotspotremoved",{hotspot:h});break}}f--}}k--}return this},clearHotspots:function(){return this._hotspots&&this.removeHotspots(this._hotspots),this},_checkHotspot:function(a){var b=a.point,c,d=null,e=this.getResolution();for(var f=this.getHotspotsCount()-1;f>=0;f--){c=this._hotspots[f];if(c){var g=c.checkValid(b,e);if(g){d=c;break}}}d?(this._showHotspotInfo(d),this.fire("hotspotvalid",{hotspot:d})):(this._hideHotspotInfo(),this.fire("hotspotinvalid"))},_hotSpotLabelOptions:{offset:new L.Loc(10,10),popable:!1,zIndexOffset:65535,clickable:!1,draggable:!1},_showHotspotInfo:function(a){this._currenthot=a;if(a._options.labelable){var b=a._options.label;this._hsLabel?this._hsLabel.setPosition(a.getPosition()):(this._hsLabel=new L.Ols.Label(a.getPosition(),b),this.addOverlays(this._hsLabel)),this._hsLabel.setOffset(b.offset),this._hsLabel.setContent(a.getText());if(b.style)this._hsLabel.setStyle(b.style);else{var c={color:"#4D4D4D",backgroundColor:"#FFFFE1",font:"12px arial,simsun",border:"#8c8c8c 1px solid",padding:"1px"};this._hsLabel.setStyle(c)}this._hsLabel.setVisible(!0)}if(a._options.imgable){var d=this._pointToAbsPixel(a.getPosition()).round(),e=a._options.img,f=e.imgUrl,g=e.offset,h=e.size;if(!this._hsImg){var i;L.Util.Browser.ie6?(i=document.createElement("div"),i.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+f+'")'):(i=document.createElement("img"),i.src=f),i.className="leaflet-marker-img",this._hsImg=i,this._panes.markerPane.appendChild(this._hsImg),L.DomEvent.addListener(this._hsImg,"click",this._hotMouseClick,this)}L.Util.setPosition(this._hsImg,d),this._hsImg.src=f,this._hsImg.style.marginLeft=-g.x+"px",this._hsImg.style.marginTop=-g.y+"px",this._hsImg.style.width=h.x+"px",this._hsImg.style.height=h.y+"px",this._hsImg.style.display="block",this._hsImg.style.cursor="hand"}},getHotspotMarker:function(){if(this._hsImg)return this._hsImg},_hotMouseClick:function(a){this._clickspotpos=this._currenthot.getPosition();var b=this._currenthot._options.marker,c=b.imgUrl,d=b.markerAnchor,e=b.markerSize,f=this._pointToAbsPixel(this._currenthot.getPosition()).round();if(!this._hsMarker){var g;L.Util.Browser.ie6?(g=document.createElement("div"),g.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+c+'")'):(g=document.createElement("img"),g.src=c),g.className="leaflet-marker-img",this._hsMarker=g,this._panes.markerPane.appendChild(this._hsMarker)}L.Util.setPosition(this._hsMarker,f),this._hsMarker.src=c,this._hsMarker.style.marginLeft=-d.x+"px",this._hsMarker.style.marginTop=-d.y+"px",this._hsMarker.style.width=e.x+"px",this._hsMarker.style.height=e.y+"px",this._hsMarker.style.display="block",this._hsMarker.style.cursor="hand",this.fire("hotspotclick",{hotspot:this._currenthot}),L.DomEvent.stopPropagation(a),L.DomEvent.preventDefault(a),this.on("popupclosed",this._hideHotspotpopup),this.on("viewreset",this._updateMarkerPosition,this)},_hideHotspotpopup:function(){this._hsMarker&&(this._hsMarker.style.display="none"),this.off("popupclosed",this._hideHotspotpopup)},_updateMarkerPosition:function(){if(this._clickspotpos){var a=this._pointToAbsPixel(this._clickspotpos).round();L.Util.setPosition(this._hsMarker,a)}else this.off("viewreset",this._updateMarkerPosition,this)},_hideHotspotInfo:function(){return this._hsLabel&&this._hsLabel.setVisible(!1),this._hsImg&&(this._hsImg.style.display="none"),this},setHotspotLabelOptions:function(a){L.Util.extend(this._hotSpotLabelOptions,a);if(this._hsLabel){var b=this._hotSpotLabelOptions;b.style&&this._hsLabel.setStyle(b.style)}},addContextMenu:function(a){a&&a instanceof L.Ols.ContextMenu&&(this._contextMenu=a,L.DomEvent.addListener(this._container,"contextmenu",this._showContextmenu,this),this._contextMenu._setMap(this))},removeContextMenu:function(){L.DomEvent.removeListener(this._container,"contextmenu",this._showContextmenu),this._contextMenu=null},_showContextmenu:function(a){a=a||window.e,L.DomEvent.preventDefault(a),this._contextMenu&&this._contextMenu.show({point:this.pixelToPoint(L.DomEvent.getMousePosition(a,this._container)),pixel:L.DomEvent.getMousePosition(a,this._container),absPixel:this._pixelToAbsPixel(L.DomEvent.getMousePosition(a,this._container))})},addOverlays:function(a){var b=a instanceof Array?a:[a],c,d,e=0,f=b.length;while(e<f)d=b[e],d&&(c=L.Util.stamp(d),!this.hasOverlay(c)&&d._setMap&&(d._setMap(this),d._markerTarget&&d._markerTarget.id!=""?c=d._markerTarget.id:c=L.Util.stamp(d),this._overlays[c]=d,this.fire("overlayadded",{overlay:d}))),e++},hasOverlay:function(a){var b=typeof a=="string"?a:L.Util.stamp(a);return this._overlays?this._overlays.hasOwnProperty(b):!1},getOverlay:function(a){return this._overlays&&this._overlays.hasOwnProperty(a)?this._overlays[a]:NULL},removeOverlays:function(a){var b=a instanceof Array?a:[a],c,d;for(var e in b)b.hasOwnProperty(e)&&(c=b[e],c&&(!c.hasOwnProperty("_layerFlag")||!c._layerFlag)&&(c._markerTarget&&c._markerTarget.id!=""?d=c._markerTarget.id:d=L.Util.stamp(c),this.hasOverlay(d)&&(delete this._overlays[d],c._unsetMap(this),this.fire("overlayremoved",{overlay:c}))))},clearOverlays:function(){this.setMode("dragzoom");var a;if(this._layers)for(var b in this._layers)if(this._layers.hasOwnProperty(b)){a=this._layers[b];if(a&&a instanceof L.Layers.Overlay){if(a instanceof L.Layers.WFS)continue;a.clear()}}this._overlays&&this.removeOverlays(this._overlays)},setSingleDialog:function(a){this._singleDialog&&this.removeSingleDialog(),a._singleDlgTag=!0,this._addDialog(a),this._singleDialog=a},removeSingleDialog:function(){this._singleDialog&&this._removeDialog(this._singleDialog),this._singleDialog=null},openSingleDialog:function(){if(!this._singleDialog)return;this._singleDialog.show(),this.fire("popupopened",{popup:this._popup})},closeSingleDialog:function(){if(!this._singleDialog)return;this._singleDialog.hide(),this.fire("popupclosed",{popup:this._popup})},getSingleDialog:function(){return this._singleDialog?this._singleDialog:null},openDialog:function(a){return this.closeDialog(),this._popup=a,this._addDialog(a),this.fire("popupopened",{popup:this._popup}),this},closeDialog:function(a){return a&&(this._removeDialog(a),this.fire("popupclosed",{popup:a}),this._popup=null),this},_addDialog:function(a){var b=L.Util.stamp(a),c=function(){a._setMap(this),this.fire("popupadded",{popup:a})};return this._loaded?c.call(this):this.on("load",c,this),this},_removeDialog:function(a){return a?(a._unsetMap(this),this.fire("popupremoved",{popup:a}),this):this},addControl:function(a){if(a&&a instanceof L.Controls.Base){var b=a.getType();if(!this.hasControlByType(b)||!a.singleAlive){var c=L.Util.stamp(a);this._controls=this._controls||[],a._setMap(this),this._controls[c]=a,this.fire("controladded",{control:a})}}return this},hasControlByType:function(a){if(this._controls)for(var b in this._controls)if(this._controls.hasOwnProperty(b)&&this._controls[b]&&this._controls[b].getType&&this._controls[b].getType().toLowerCase()==a.toLowerCase())return!0;return!1},removeControl:function(a){if(this._controls&&a&&a instanceof L.Controls.Base){var b=L.Util.stamp(a);this._controls[b]&&delete this._controls[b],a._unsetMap(this),this.fire("controlremoved",{control:a})}return this},removeControlByType:function(a){if(this._controls&&a&&this._controls)for(var b in this._controls)this._controls.hasOwnProperty(b)&&this._controls[b]&&this._controls[b].getType().toLowerCase()==a.toLowerCase()&&this.removeControl(this._controls[b]);return this},_initControlDivs:function(){function d(d,e){var f=b+d+" "+b+e;a[d+e]=L.Util.create("div",f,c)}var a=this._subControlDivs={},b="leaflet-",c=this._controlDiv=L.Util.create("div",b+"control-div",this._container);d("top","left"),d("top","right"),d("bottom","left"),d("bottom","right")},getResByZoom:function(a){return this.basicLayer._getResByZoom(a)},getZoomByRes:function(a){return this.basicLayer._getZoomByRes(a)},getBounds:function(a,b){var c=null;a==null&&(a=this._getCenter()),b==null&&(b=this.getResolution());if(a!=null&&b!=null){var d=this.getSize(),e=d.x*b,f=d.y*b;c=new L.Extent(a.x-e/2,a.y-f/2,a.x+e/2,a.y+f/2)}return c},getZoomForBounds:function(a){return this.basicLayer?this.basicLayer.getZoomForBounds(a):0},pixelToPoint:function(a){var b=null;return this.basicLayer!=null&&(b=this.basicLayer._pixelToPoint(a)),b},pointToPixel:function(a){var b=null;return this.basicLayer!=null&&(b=this.basicLayer._pointToPixel(a)),b},setView:function(a,b,c){a=a||this.getCenter(),b===undefined&&(b=this.getZoom()),a instanceof L.Loc||(a=this.getCenter());var d=this._resetMoveToParams(a,b);a=d.lonlat,b=d.zoom;var e=this.zoom!==b;if(this._loaded&&!c&&this._layers){var f=new L.Loc(0,0);a.equals(this.getCenter())||(f=this.pointToPixel(a).subtract(this.pointToPixel(this.getCenter())));var g=e?!!this._zoomWithAnimation&&this._zoomWithAnimation(a,b,f):this.panBy(f);if(g)return this}return this._resetView(a,b,!1,!1,c),this},_resetView:function(a,b,c,d,e){if(!this.basicLayer)return;b!=undefined&&(b=parseFloat(b),b=Math.round(b)),a=a||this._getCenter(),b=b==undefined?this.getZoom():b;var f=this._resetMoveToParams(a,b);a=f.lonlat,b=f.zoom;var g=this.zoom!==b,h=!this._getCenter()||a.x==this._getCenter().x&&a.y==this._getCenter().y;if(!g&&!h&&!e)return;d||(this.fire("movestart"),g&&this.fire("zoomstart")),this.zoom=b;if(!c)L.Util.setPosition(this._mapPane,new L.Loc(0,0)),this.centerOffset=new L.Loc(0,0);else{var i=L.Util.getPosition(this._mapPane);this.centerOffset=i}this._setCenter(a);var j=!this._loaded;this._loaded=!0,this.fire("viewreset",{hard:!c}),(g||d)&&this.fire("zoomend"),this.fire("moveend",{hard:!c}),j&&this.fire("load")},_setView2:function(a,b,c){a=a||this.getCenter(),b===undefined&&(b=this.getZoom()),a instanceof L.Loc||(a=this.getCenter());var d=this.zoom!==b;if(this._loaded&&!c&&this._layers){var e=new L.Loc(0,0);a.equals(this.getCenter())||(e=this.pointToPixel(a).subtract(this.pointToPixel(this.getCenter())));var f=d?!!this._zoomWithAnimation&&this._zoomWithAnimation(a,b,e):this.panBy(e);if(f)return this}return this._resetView2(a,b,!1,!1,c),this},_resetView2:function(a,b,c,d,e){if(!this.basicLayer)return;b!=undefined&&(b=parseFloat(b),b=Math.round(b)),a=a||this._getCenter(),b=b==undefined?this.getZoom():b;var f=this.zoom!==b,g=!this._getCenter()||a.x==this._getCenter().x&&a.y==this._getCenter().y;if(!f&&!g&&!e)return;d||(this.fire("movestart"),f&&this.fire("zoomstart")),this.zoom=b;if(!c)L.Util.setPosition(this._mapPane,new L.Loc(0,0)),this.centerOffset=new L.Loc(0,0);else{var h=L.Util.getPosition(this._mapPane);this.centerOffset=h}this._setCenter(a);var i=!this._loaded;this._loaded=!0,this.fire("viewreset",{hard:!c}),(f||d)&&this.fire("zoomend"),this.fire("moveend",{hard:!c}),i&&this.fire("load")},panTo:function(a){return this.setView(a,this._zoom)},setMaxExtent:function(a){a=a||null,this.options.maxExtent=this.maxExtent=a;if(!a)return this;this._loaded&&this.panInsideBounds(a)},_panInsideBounds:function(a){var b=this.getBounds(),c=this.pointToPixel(new L.Loc(b.minX,b.minY)),d=this.pointToPixel(new L.Loc(b.maxX,b.maxY)),e=this.pointToPixel(new L.Loc(a.minX,a.minY)),f=this.pointToPixel(new L.Loc(a.maxX,a.maxY)),g=f.x-e.x,h=f.y-e.y,i=d.x-c.x,j=d.y-c.y,k=0,l=0;return j<h?d.y>f.y?l=f.y-d.y:c.y<e.y&&(l=e.y-c.y):(d.y<f.y&&(l=f.y-d.y),c.y>e.y&&(l=e.y-c.y)),i>g?d.x<f.x?k=f.x-d.x:c.x>e.x&&(k=e.x-c.x):(d.x>f.x&&(k=f.x-d.x),c.x<e.x&&(k=e.x-c.x)),this.panBy(new L.Loc(k,l))},invalidateSize:function(){var a=this.getSize();return this._sizeChanged=!0,this.options.maxBounds&&this.setMaxExtent(this.options.maxBounds),this._loaded?(this.fire("move"),clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(L.Util.bind(function(){this._resetView(this._center,this.getZoom())},this),200),this):this},_pointToAbsPixel:function(a){return this.pointToPixel(a).subtract(L.Util.getPosition(this._mapPane))},_absPixelToPoint:function(a){return this.pixelToPoint(a.add(L.Util.getPosition(this._mapPane)))},_absPixelToPixel:function(a){if(!a)return new L.Loc(0,0);var b=L.Util.getPosition(this._mapPane);return b?a.add(b):a},_pixelToAbsPixel:function(a){if(!a)return new L.Loc(0,0);var b=L.Util.getPosition(this._mapPane);return b?a.subtract(b):a},_initLayers:function(a){a=a?a instanceof Array?a:[a]:[],this._layers={},this._layerIds=new Array;var b,c;for(b=0,c=a.length;b<c;b++)this.addLayer(a[b])},_initOverlays:function(a){this._overlays=new Array,this._hotspots=new Array;if(!a)return;this.addOverlays(a)},_initLayout:function(){var a=this._container;a.innerHTML="",L.Util.addClass(a,"leaflet-container"),L.Util.Browser.touch&&L.Util.addClass(a,"leaflet-touch");var b=L.Util.getStyle(a,"position");b!=="absolute"&&b!=="relative"&&b!=="fixed"&&(a.style.position="relative");var c=this._panes={};this._mapPane=c.mapPane=L.Util.create("div","leaflet-map-pane",this._container),this._tilePane=c.tilePane=L.Util.create("div","leaflet-tile-pane",this._mapPane),this._objectsPane=c.objectsPane=L.Util.create("div","leaflet-objects-pane",this._mapPane),c.shadowPane=L.Util.create("div","leaflet-shadow-pane",this._objectsPane),c.labelPane=L.Util.create("div","leaflet-label-pane",this._objectsPane),c.overlayPane=L.Util.create("div","leaflet-overlay-pane",this._objectsPane),c.markerPane=L.Util.create("div","leaflet-marker-pane",this._objectsPane),c.tmpPane=L.Util.create("div","leaflet-tmp-pane",this._mapPane),c.popupPane=L.Util.create("div","leaflet-popup-pane",this._objectsPane);var d="leaflet-zoom-hide";this.options.markerZoomAnimation||(L.Util.addClass(c.markerPane,d),L.Util.addClass(c.shadowPane,d),L.Util.addClass(c.popupPane,d)),this._initControlDivs&&this._initControlDivs()},_initEvents:function(){if(!L.DomEvent)return;L.DomEvent.addListener(this._container,"click",this._onMouseClick,this);var a=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove"],b,c;for(b=0,c=a.length;b<c;b++)L.DomEvent.addListener(this._container,a[b],this._fireMouseEvent,this);this.on("move",this._moveCallBack,this),this.on("viewreset",this._viewResetCallBack,this),L.DomEvent.addListener(window,"resize",this._onResize,this),this.on("moveend",this._moveEndCallBack,this)},_clearTileBg:function(){this._tileBg&&this._tileBg.children.length>0&&L.Util.clearAllNode(this._tileBg),this._ieBgClearTimer&&clearInterval(this._ieBgClearTimer)},_loadTileBg:function(){},_viewResetCallBack:function(a){var b=this.getLayersCount(),c,d;for(var e=0;e<b;e++){c=this._layerIds[e],d=this._layers[c];if(!d)continue;d._reset(a.hard)}},_moveCallBack:function(a){this.basicLayer.getVisible()&&this.basicLayer._moveCallBack(a)},_moveEndCallBack:function(a){var b=a&&a.hard,c=a&&a.zoomChanged;this.basicLayer.getVisible()&&this.basicLayer._moveEndCallBack(a);var d=this.getLayersCount(),e,f;for(var g=0;g<d;g++){e=this._layerIds[g],f=this._layers[e];if(!(!!f&&!f.isBasicLayer&&f instanceof L.Layers.Base))continue;f._moveEndCallBack(a)}},_rawPanBy:function(a){var b=L.Util.getPosition(this._mapPane);if(isNaN(b.x)||isNaN(b.y)){this._resetView();return}if(!a||isNaN(a.x)||isNaN(a.y))return;L.Util.setPosition(this._mapPane,b.subtract(a))},_stopLoadImg:function(){var a=this.getLayersCount(),b,c;for(var d=0;d<a;d++)b=this
._layerIds[d],c=this._layers[b],(!c||!(c instanceof L.Layers.TileBase))&&c.stopLoadImg()},_resetMoveToParams:function(a,b){if(this.basicLayer){b=this._limitZoom(b);var c=this.basicLayer._getResByZoom(b),d=this.getBounds(a,c),e=this.getMaxExtent();if(!e.contains(a)){var f=this.getSize(),g=c*f.x/2,h=c*f.y/2,i=e.getCenter();d.getWidth()>e.getWidth()?a=new L.Loc(i.x,a.y):a.x<e.minX?a.x=e.minX+g:a.x>e.maxX&&(a.x=e.maxX-g),d.getHeight()>e.getHeight()?a=new L.Loc(a.x,i.y):a.y<e.minY?a.y=e.minY+h:a.y>e.maxY&&(a.y=e.maxY-h)}}return{lonlat:a,zoom:b}},_getDefaultMaxExtent:function(){var a=null;return this.getUnits()=="dd"&&(a=new L.Extent(-180,-90,180,90)),a},_setZoom:function(a){return this.setView(this.getCenter(),a)},_getBoundsByRes:function(a,b){var c=this.getSize(),d=b*c.x/2,e=b*c.y/2;return new L.Extent(a.x-d,a.y-e,a.x+d,a.y+e)},_setCenter:function(a){var b=L.Util.getPosition(this._mapPane);if(!b||b.x==0&&b.y==0)return this.center=a,this;var c=this.getResolution();return this.center||(this.center=a),this.center.x=a.x+b.x*c,this.center.y=a.y-b.y*c,this},_getAbsCenter:function(a){var b=L.Util.getPosition(this._mapPane);if(!b||b.x==0&&b.y==0)return this.center=a,this;var c=this.getResolution(),d=a;return d.x=a.x+b.x*c,d.y=a.y-b.y*c,d},_getRealCenter:function(){var a=L.Util.getPosition(this._mapPane),b=this.center,c=this.getResolution();return new L.Loc(b.x-a.x*c,b.y+a.y*c)},_getCenternew:function(){this.center||this._setCenter(this.getMaxExtent().getCenter());var a=L.Util.getPosition(this._mapPane);if(!this.centerOffset||this.centerOffset&&this.centerOffset.equals(a))return this.center;var b=this.getResolution(),c=this.center.x-(this.centerOffset.x-a.x)*b,d=this.center.y+(this.centerOffset.y-a.y)*b;return new L.Loc(c,d)},_getCenter:function(){this.center||this._setCenter(this.getMaxExtent().getCenter());var a=L.Util.getPosition(this._mapPane);if(!a||a.x==0&&a.y==0)return this.center;var b=this.getResolution(),c=this.center.x-a.x*b,d=this.center.y+a.y*b;return new L.Loc(c,d)},_onResize:function(){this._sizeChanged=!0,this.invalidateSize()},_initInteraction:function(){this._handlers={};var a;for(a in L.HandlerHash)L.HandlerHash.hasOwnProperty(a)&&L.HandlerHash[a]&&(this._handlers[a]=new L.HandlerHash[a](this),this.options[a]&&this._handlers[a].enable())},getHegemonTag:function(){return this._hegemonTag},_onMeasureEnd:function(a){this.setMode("dragzoom"),this.off("measureend",this._onMeasureEnd)},_limitZoom:function(a){var b=this.getZoomCount(),c=a;return c=c<0?0:c,c=c>b-1?b-1:c,c},_getPanes:function(){return this._panes},_onMouseClick:function(a){if(!this._loaded||this.checkDraging())return;this.fire("pre"+a.type),this._fireMouseEvent(a)},checkDraging:function(){return this._handlers.drag&&this._handlers.drag.moved()},_checkCurBasicLayer:function(a){return this.basicLayer&&L.Util.stamp(this.basicLayer)==L.Util.stamp(a)?!0:!1},_fireMouseEvent:function(a){if(!this._loaded)return;var b=a.type;b=b==="mouseenter"?"mouseover":b==="mouseleave"?"mouseout":b;if(!this.has(b))return;this.fire(b,{point:this.pixelToPoint(L.DomEvent.getMousePosition(a,this._container)),pixel:L.DomEvent.getMousePosition(a,this._container),absPixel:this._pixelToAbsPixel(L.DomEvent.getMousePosition(a,this._container))})},getAPIVersion:function(){return leaflet_JS_LIB.VERSION}}),L.MapOptions={center:null,zoom:null},L.Layers={},L.Layers.Base=L.Class.extend({includes:L.Mixin.Events,_map:null,_container:null,_filledTag:!0,isBasicLayer:!1,zoomCount:null,copyright:"",layerType:"L.Layers.Base",attribution:"",visible:!0,initialize:function(a,b){this.name=a;var c=L.Util.extend({},L.Layers.BaseOptions,b);L.Util.setOptions(this,c,!0)},getVisible:function(){return this.visible&&this._checkInRange()},getId:function(){return L.Util.stamp(this)},getName:function(){return this.name},getLayerType:function(){return this.layerType},getAttribution:function(){return this.attribution||""},getUnits:function(){return this.units},getOpacity:function(){return this.opacity},getProjection:function(){return this._map&&this._map.basicLayer&&this._map.basicLayer!=this?this._map.basicLayer.getProjection():this.projection||new L.Proj("EPSG:4326")},setProjection:function(a){return a&&(this.projection=typeof a=="string"?new L.Proj(a):a),this},setVisible:function(a){a!=this.visible&&(this.visible=a,this._display(a),this._update(),this._map!=null&&this._map.fire("changelayervisible",{layer:this,visible:a,property:"visible"}),this.fire("visibilitychanged"),this.getVisible()&&this._moveEndCallBack())},setOpacity:function(a){a=a===undefined?1:a;if(this.opacity==a)return;this.opacity=a,this.opacity=this.opacity>1?1:this.opacity,this.opacity=this.opacity<0?0:this.opacity,this.opacity<1&&L.Util.setOpacity(this._container,this.opacity);if(L.Util.Browser.webkit)for(var b in this._tiles)this._tiles.hasOwnProperty(b)&&(this._tiles[b].style.webkitTransform+=" translate(0,0)");if(L.Util.Browser.ie)for(var b in this._tiles)this._tiles.hasOwnProperty(b)&&L.Util.setOpacity(this._tiles[b],this.opacity)},redraw:function(){this._map&&this._moveTo()},_moveCallBack:function(a){this._updateMove(a);return},_moveEndCallBack:function(a){this.options&&!this.options.updateWhenIdle&&this._update(a)},_update:function(a){a=a||{};var b=a.bounds||this._map.getBounds();this._moveTo(b)},_updateMove:function(a){if(this._moveingTag)return;a=a||{};var b=a.bounds||this._map.getBounds();this._moveTo(b,!0)},_moveTo:function(a,b){var c=this.getVisible();this._container&&(this._container.style.display=c?"":"none");var d=this.getVisible();d!=this._inRange&&(this._inRange=d,this._display(this._inRange),this._map.fire("changelayervisible",{layer:this,visible:this.visible,property:"visible"}))},_display:function(a){this._container&&a!=(this._container.style.display!="none")&&(a&&this.getVisible()?this._container.style.display="":this._container.style.display="none")},_getPane:function(){if(this._map)return this._map._getPanes().tilePane},_updateZIndex:function(){this._container&&this.options.zIndex!==undefined&&(this._container.style.zIndex=this.options.zIndex)},_initContainer:function(){var a=this._getPane(),b=a.firstChild;if(!this._container||a.empty)this._container=L.Util.create("div","leaflet-layer"),this._updateZIndex(),this.isBasicLayer&&b?a.insertBefore(this._container,b):a.appendChild(this._container),this.opacity&&this.setOpacity(this.opacity)},_initEvents:function(){this._map&&this.options.updateWhenIdle&&(this._limitedUpdate=L.Util.limitExecByInterval(this._update,150,this))},_removeEvents:function(){this._map&&(this._map.off("viewreset",this._resetCallback,this),this._map.off("moveend",this._update,this),this.options.updateWhenIdle||this._map.off("move",this._limitedUpdate,this))},_unsetMap:function(){if(this._map){this._removeEvents();var a=this._getPane();a.removeChild(this._container),this._map=null,this.fire("removed",{layer:this})}},_resetCallback:function(a){this._reset(a.hard)},_reset:function(a){if(this._tiles){var b;for(b in this._tiles)this._tiles.hasOwnProperty(b)&&(this.fire("tileunload",{tile:this._tiles[b]}),this._tiles[b]=null,delete this._tiles[b]);this._tiles={}}a&&this._container&&L.Util.clearAllNode(this._container),this._initContainer()},_update2:function(){var a=L.Util.getPosition(this._map._mapPane),b=this._map.getCenter();b.x-=a.x*this._map.getResolution(),b.y+=a.y*this._map.getResolution(),this._moveTo(b)},_setMap:function(a){if(this._map!=null||a==null)return;this._map=a,this._initContainer(),this._initEvents(),this.maxExtent=this.maxExtent||this._map.maxExtent,this.projection=this.projection||this._map.projection,this.projection&&typeof this.projection=="string"&&(this.projection=new L.Proj(this.projection)),this.units=(this.projection?this.projection.getUnits():null)||this.units||this._map.getUnits(),this.resolutions||this.isBasicLayer&&this._initResolutions(),this.resolutions&&(this.resolutions.sort(function(a,b){return b-a}),this.zoomCount=this.resolutions.length,this.maxRes=this.maxRes||this.resolutions[0],this.minRes=this.minRes||this.resolutions[this.zoomCount-1]);if(!this.isBasicLayer){var b=this.getVisible();this._container.style.display=b?"":"none"}else this._map.basicLayer&&L.Util.stamp(this)!=L.Util.stamp(this._map.basicLayer)&&this.setVisible(!1);this._setTileSize(),this._reset()},_getFitRes:function(a,b,c){var d=a,e=1;if(c=="dd"){var f=.703125;d=f;for(;e<=22;e+=1,f/=2){if(a<=f&&!!b)break;if(a>=f&&!b){d=f;break}d=f}}return{level:e,res:d}},_afterAdd:function(){},_initResolutions:function(){if(this.resolutions)return;var a=this.getUnits();if(this.maxRes&&!this.zoomCount){if(this.minRes){var b=this.maxRes/this.minRes;this.zoomCount=Math.floor(Math.log(b)/Math.log(2))+1}}else if(!this.maxRes){var c=this._map.getSize(),d=this.maxExtent.getWidth()/c.x,e=this.maxExtent.getHeight()/c.y,f=Math.max(d,e);if(a=="dd"){var g=this._getFitRes(f,!0,"dd");this.maxRes=g.res,this.zoomCount=this.zoomCount||g.level}}this.zoomCount=this.zoomCount||22,this.resolutions=new Array;var h=this.maxRes;for(var i=0;i<this.zoomCount;i++)this.resolutions[i]=h,h/=2},_setTileSize:function(){},_checkInRange:function(){var a=!1;if(this._map){var b=this._map.getResolution();if(this.zoomResFixed)if(!this.isBasicLayer&&!this.resolutions)a=!0;else{a=!1;var c=0,d=this.resolutions.length;for(;c<d;c++)if(parseFloat(this.resolutions[c])==b){a=!0;break}}else a=!0;a&&((this.minRes===undefined||this.minRes===null||b>=this.minRes)&&(this.maxRes===undefined||this.maxRes===null||b<=this.maxRes)?a=!0:a=!1);if(a){var e=this._map.getExtent();this.maxExtent&&e&&!e.intersects(this.maxExtent)&&(a=!1)}}return a},_pixelToPoint:function(a){var b=null;if(a){var c=this._map.getExtent(),d=this._map.getResolution();b=new L.Loc(c.minX+d*a.x,c.maxY-d*a.y)}return b},_pointToPixel:function(a){var b=null;if(a!=null){var c=this._map.getResolution(),d=this._map.getExtent();b=(new L.Loc(1/c*(a.x-d.minX),1/c*(d.maxY-a.y))).round()}return b},_getResolution:function(){var a=this._map.getZoom();return this._getResByZoom(a)},_getResolutions:function(){return this.resolutions||this._initResolutions(),this.resolutions},_getZoomByRes:function(a){if(!a)return 0;this.resolutions||this._initResolutions();if(a>this.resolutions[0])return 0;if(a<this.resolutions[this.resolutions.length-1])return this.resolutions.length-1;var b,c;for(b=1,c=this.resolutions.length;b<c;b++)if(this.resolutions[b]<a&&Math.abs(this.resolutions[b]-a)>1e-6)break;return b-1},_getResByZoom:function(a){a=Math.max(0,Math.min(a,this.resolutions.length-1));var b=this.resolutions[Math.round(a)];return b},_getExtent:function(){var a=null;return this._map&&(a=this._map.getBounds()),a},getZoomForBounds:function(a){if(!this._map)return 0;var b=this._map.getSize();if(a.getWidth()===0&&a.getHeight()===0)return this._map.getZoomCount()-1;var c=Math.max(a.getWidth()/b.x,a.getHeight()/b.y);return this._getZoomByRes(c)}}),L.Layers.BaseOptions={maxRes:null,minRes:null,resolutions:null,units:"dd",projection:null,isBasicLayer:!1,copyright:null,attribution:null,visible:!0,opacity:1,zoomCount:18,maxExtent:new L.Extent(-180,-90,180,90),tileSize:null},L.Layers.Overlay=L.Layers.Base.extend({initialize:function(a){this._overlays={};var b,c;if(!a)return;a=a instanceof Array?a:[a];if(a)for(b=0,c=a.length;b<c;b++)this.addOverlay(a[b])},setVisible:function(a){var b=a?!0:!1,c;this.visible=b;if(this._overlays)for(c in this._overlays)this._overlays.hasOwnProperty(c)&&this._overlays[c]&&this._overlays[c].setVisible&&this._overlays[c].setVisible(b)},redraw:function(){if(!this._map)return this},_reset:function(){},addOverlay:function(a){var b=L.Util.stamp(a);return this._overlays=this._overlays||{},this._overlays[b]=a,this._map&&this._map.addOverlays(a),this},removeOverlay:function(a){var b=L.Util.stamp(a);return delete this._overlays[b],this._map&&(this instanceof L.Layers.WFS?this._removeWFSOverlays(a):this._map.removeOverlays(a)),this},getBounds:function(){var a=null,b,c;for(b in this._overlays)this._overlays.hasOwnProperty(b)&&(c=this._overlays[b],c.getBounds&&(a?a.extendByBounds(c.getBounds()):a=c.getBounds()));return a},clearOverlays:function(){return this._iterateLayers(this.removeOverlay,this),this},clear:function(){this.clearOverlays()},invoke:function(a){var b=Array.prototype.slice.call(arguments,1),c,d;for(c in this._overlays)this._overlays.hasOwnProperty(c)&&(d=this._overlays[c],d[a]&&d[a].apply(d,b));return this},_setMap:function(a){this._map=a,this._iterateLayers(a.addOverlays,a)},_unsetMap:function(){if(!this._map)return this;var a=this._map;this instanceof L.Layers.WFS?this._iterateLayers(this._removeWFSOverlays,this):this._iterateLayers(a.removeOverlays,a),this._map=null},_iterateLayers:function(a,b){for(var c in this._overlays)this._overlays.hasOwnProperty(c)&&a.call(b,this._overlays[c])}}),L.Layers.WFS=L.Layers.Overlay.extend({isBasicLayer:!1,layerType:"L.Layers.WFS",formatOptions:null,formatObject:null,format:null,getAttributes:!1,_DEFAULT_PARAMS:{service:"WFS",REQUEST:"GetFeature",VERSION:"1.0.0",MAXFEATURES:1e3,TYPENAME:null},initialize:function(a,b,c,d){this.name=a,this.url=encodeURI(b),this.layerType="L.Layers.WFS",d==undefined&&(d={});var e;for(key in c)this._DEFAULT_PARAMS.hasOwnProperty(key.toUpperCase())?this._DEFAULT_PARAMS[key.toUpperCase()]=c[key]:e[key]=c[key];this._params=this._DEFAULT_PARAMS,this._params=L.Util.applyDefaults(e,L.Util.upperCaseObject(this._DEFAULT_PARAMS)),L.Util.extend(d,{reportError:!1}),L.Util.setOptions(this,d,!0)},_setMap:function(a){this._map=a;var b={getAttributes:this.getAttributes};L.Util.extend(b,this.formatOptions),this._map&&!this.projection===this._map.getProjection()&&(b.externalProjection=this.projection,b.internalProjection=this._map.getProjection()),this.formatObject=this.format?new this.format(b):new L.Parser.GML(b);var c=this._map.getExtent();this._moveTo(c,!0,!1)},_moveTo:function(a,b,c){if(c)return;a==null&&(a=this._map.getExtent()),L.Layers.Base.prototype._moveTo.call(this,a),this._params.BBOX=a.minX+","+a.minY+","+a.maxX+","+a.maxY;var d=this.getFullRequestString();this._loadFeatures(encodeURI(d),this._requestSuccess)},_loadFeatures:function(a,b,c){this.request&&this.request.abort(),L.HttpObj.GET({url:a,success:b,failure:c,scope:this})},_requestSuccess:function(a){var b=a.responseXML;if(!b||!b.documentElement)b=a.responseText;if(this._overlays)for(var c in this._overlays)this.removeOverlay(this._overlays[c]);var d=this.formatObject.read(b);for(var e=0;e<d.length;e++)d[e].setVisible(this.visible),this.addOverlay(d[e])},getFullRequestString:function(){var a="",b="";this.getProjection()&&this._map.getProjection()&&(b=this.getProjection().getSrsCode()||this._map.getProjection().getSrsCode());if(this._params){var c;this._params.SRS=b==""?null:b;for(c in this._params)this._params.hasOwnProperty(c)&&(a==""&&c=="REQUEST"?a+=c+"="+this._params[c]:this._params[c]&&(a+="&"+c+"="+this._params[c]))}var d=L.Util.urlAppend(this.url,a);return d},_removeWFSOverlays:function(a){var b=a instanceof Array?a:[a],c,d;for(var e in b)c=b[e],c&&(d=L.Util.stamp(c),this._map.hasOverlay(d)&&(delete this._map._overlays[d],c._unsetMap(this._map),this._map.fire("overlayremoved",{overlay:c})))}}),L.Layers.TileBase=L.Layers.Base.extend({_nullTag:-1,singleTile:!1,tileSize:new L.Loc(256,256),tileOrigin:new L.Loc(-180,90),zoomResFixed:!0,format:"image/png",isBasicLayer:!0,serverResolutions:null,_tiles:{},initialize:function(a,b,c){this.name=a,this.layerType="L.Layers.TileBase",this.setUrl(b),L.Util.setOptions(this,c,!0),this._createTileProto()},setUrl:function(a){this.url=a},getTileSize:function(){return this.tileSize},getFormat:function(a,b){a||(a=this.format),a=a.toLowerCase();var c={png:"image/png",jpg:"image/jpeg",gif:"image/gif"},d,e=b?"image/png":"png";for(d in c)c.hasOwnProperty(d)&&(d==a||c[d]==a)&&(e=b?c[d]:d);return e},_getZByRes:function(a){var b,c;if(this.isBasicLayer&&this._map&&this._map.basicLayer&&L.Util.stamp(this)!=L.Util.stamp(this._map.basicLayer))return this._nullTag;if(!this.zoomResFixed&&this._map)return this._map.getResolution();if(this.serverResolutions){for(b in this.serverResolutions)if(this.serverResolutions[b]==a)return b}else if(this.resolutions)for(b=0,c=this.resolutions.length;b<c;b+=1)if(this.resolutions[b]==a)return b;return this._nullTag},stopLoadImg:function(){var a=this._container;if(!a)return;var b=a.getElementsByTagName("img"),c,d,e;for(c=0,d=b.length;c<d;c++)e=b[c],e&&!e.complete&&(e.onload=L.Util.falseFn,e.onerror=L.Util.falseFn,e.src="",e.parentNode.removeChild(e))},_reset:function(a){var b;for(b in this._tiles)this._tiles.hasOwnProperty(b)&&(this.fire("tileunload",{tile:this._tiles[b]}),this._tiles[b]._hotspots&&this._map.removeHotspots(this._tiles[b]._hotspots),this._tiles[b]=null,delete this._tiles[b]);this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),a&&this._container&&(L.Util.clearAllNode(this._container),this._container.innerHTML=""),this._initContainer()},_moveingTag:!1,_moveTo:function(a,b){if(this._moveingTag&&b)return;this._moveingTag=!0,L.Layers.Base.prototype._moveTo.call(this,a);if(!this.getVisible()){this._container&&this._container.children.length>0&&this._reset(!0),this._moveingTag=!1;return}var c=this._map.getResolution();a||(a=this._map.getExtent());if(!a)return this._moveingTag=!1,this;var d=a.getCenter(),e,f,g=this.tileSize.x*c,h=this.tileSize.y==this.tileSize.x?g:this.tileSize.y*c,i=Math.floor((a.minX-this.tileOrigin.x)/g);e=Math.floor((d.x-this.tileOrigin.x)/g);var j=this.tileOrigin.x+i*g,k,l;this._rightAlias?(f=Math.floor((d.y-this.tileOrigin.y)/h),k=Math.floor((a.maxY-this.tileOrigin.y)/h),l=this.tileOrigin.y+(k+1)*h):(f=Math.floor((this.tileOrigin.y-d.y)/h),k=Math.floor((this.tileOrigin.y-a.maxY)/h),l=this.tileOrigin.y-k*h);var m=new L.Loc(e,f),n=Math.round((j-a.minX)/c),o=Math.round((a.maxY-l)/c),p,q,r,s,t=i,u=k,v,w=L.Util.getPosition(this._map._mapPane),x,y,z=o-w.y,A=n-w.x,B=this._rightAlias?-1:1,C=this._getZByRes(c),D=[],E=null;if(C!=this._nullTag)for(p=j;p<=a.maxX;p+=g,t+=1){u=k;for(q=l;q>=a.minY;q-=h,u+=B)D.push(new L.Loc(t,u))}D.sort(function(a,b){return a.distanceTo(m)-b.distanceTo(m)}),this._tilesToLoad=D.length,this._filledTag=!1;var F,G;for(F=0,G=this._tilesToLoad;F<G;F++){r=C+":"+D[F].y+":"+D[F].x,x=(D[F].x-i)*this.tileSize.x+A,y=(D[F].y-k)*this.tileSize.y,y<0&&(y=-y),y+=z;if(this._tiles.hasOwnProperty(r)){b||L.Util.setPosition(this._tiles[r],new L.Loc(x,y)),this._tilesToLoad--;continue}if(this.getTileUrlByExtent){s=this._createTile(),L.Util.setPosition(s,new L.Loc(x,y)),s._layer=this,s.onload=this._tileOnLoad,s.onerror=this._tileOnError,E=this.getTileUrlByExtent(new L.Extent(p,q-h,p+g,q));if(!E){s=null;continue}s.src=E}else s=this._getTile(C,D[F].y,D[F].x,new L.Loc(x,y));if(!s){this._tilesToLoad--;continue}s._key=r,v=L.Util.getPosition(this._map._mapPane);if(!v.equals(w)){this._filledTag=!0,this._moveingTag=!1;break}L.Util.Browser.ie&&this.opacity!=undefined&&(this.opacity=this.opacity>1?1:this.opacity,this.opacity=this.opacity<0?0:this.opacity,this.opacity<1&&L.Util.setOpacity(s,this.opacity)),this._container.appendChild(s),this._tiles[r]=s,s=null}this._filledTag=!0;if(!b||this._container.children.length>80){var H=new L.Extent(i,k,t,u);this._removeOtherTiles(H)}return this._moveingTag=!1,this},_getTile:function(a,b,c,d){var e=this._createTile();L.Util.setPosition(e,d),e._layer=this,e.onload=this._tileOnLoad,e.onerror=this._tileOnError;var f=this._getTileUrl(a,b,c,d);return f?(e.src=f,e):null},_tileBuffer:4,_removeOtherTiles:function(a){var b=this._getZByRes(this._map.getResolution()),c,d,e,f,g,h;if(a)for(g in this._tiles)if(this._tiles.hasOwnProperty(g)){c=g.split(":"),f=parseFloat(c[0]),d=parseInt(c[2],10),e=parseInt(c[1],10);if(b==this._nullTag||f!=b||d<a.minX-this._tileBuffer||d>a.maxX+this._tileBuffer||e<a.minY-this._tileBuffer||e>a.maxY+this._tileBuffer)h=this._tiles[g],this._removeTile(h),this._tiles[g]=null,delete this._tiles[g]}var i=this._container.getElementsByTagName("img");if(i&&i.length)for(var j=i.length-1;j>=0;j--)h=i[j],h&&h._key&&(c=h._key.split(":"),f=parseInt(c[0],10),(b==this._nullTag||f!=b||!this._tiles[h._key])&&this._removeTile(h));return this},_removeTile:function(a){if(!a)return;this.fire("tileunload",{tile:a,url:a.src}),a.parentNode===this._container&&this._container.removeChild(a)},_getTileUrl:function(a,b,c){return null},_createTileProto:function(){this._tileImg=L.Util.create("img","leaflet-tile"),this._tileImg.galleryimg="no";var a=this.tileSize;this._tileImg.style.width=a.x+"px",this._tileImg.style.height=a.y+"px"},_createTile:function(){var a;return a=this._tileImg.cloneNode(!1),a.onselectstart=a.onmousemove=L.Util.falseFn,a},_tileOnLoad:function(a){var b=this._layer;if(!b)return;this.className+=" leaflet-tile-loaded",b.fire("tileload",{tile:this,url:this.src}),b._tilesToLoad--,b._tilesToLoad||(b.fire("loaded"),b.isBasicLayer&&b._map&&b._map.fire("basiclayerloaded"))},_tileOnError:function(a){var b=this._layer;b.fire("tileerror",{tile:this,url:this.src})}}),L.Layers.WMS=L.Layers.TileBase.extend({singleTile:!0,zoomResFixed:!1,defaultParams:{SERVICE:"WMS",REQUEST:"GetMap",VERSION:"1.3.0",LAYERS:"",STYLES:"",FORMAT:"image/jpeg",TRANSPARENT:!1},initialize:function(a,b,c,d){L.Layers.TileBase.prototype.initialize.call(this,a,b,c),this._params=d||{},this._params=L.Util.extend({},this.defaultParams,this._params);if(this.url){var e=L.Util.getParameters(this.url);this._params=L.Util.extend(this._params,e)}this.layerType="L.Layers.WMS"},setUrl:function(a){this.url=a;if(this.url&&this._params){var b=L.Util.getParameters(this.url);this._params=L.Util.extend(this._params,b)}},setParams:function(a){this._params=this._params||{},L.Util.extend(this._params,a)},getParams:function(){return this._params},getTileUrlByExtent:function(a){return this._map?this._getUrl(a,this.tileSize):null},getTileSize:function(){return this.singleTile&&this._map?this._map.getSize():this.tileSize},_moveTo:function(a){return this.singleTile?this._moveToSingleTile(a):L.Layers.TileBase.prototype._moveTo.call(this,a)},_moveToSingleTile:function(a){L.Layers.Base.prototype._moveTo.call(this,a);if(!this.getVisible()){this._container&&this._container.children.length>0&&this._reset(!0);return}var b=this._map.getResolution();a||(a=this._map.getExtent());var c=L.Util.getPosition(this._map._mapPane),d=-c.x,e=-c.y;this._sIdKey=this._sIdKey?this._sIdKey+1:1;var f=this._getSingleTile(a);if(f){L.Util.setPosition(f,new L.Loc(d,e));var g="id:"+this._sIdKey;f.id=g,this._tilesToLoad=1,this._tiles[g]=f,this._container.appendChild(f)}return this._clearOtherTiles(),this},_clearOtherTiles:function(){if(!this._tiles)return;var a="id:"+this._sIdKey,b;if(this._container)for(var c=this._container.children.length-1;c>=0;c--){var b=this._container.children[c];if(b&&b.id!=a){this._tiles[b.id]=null,delete this._tiles[b.id];var d=this._container.removeChild(b);d=null}b=null}},_removeTileById:function(a){if(!a)return;var b=this._tiles[a];b&&(this.fire("tileunload",{tile:b,url:b.src}),b.parentNode===this._container&&(this._container.removeChild(b),this._tiles[a]=null,delete this._tiles[a]))},_getSingleTile:function(a){if(!this._map)return null;var b=this._map.getSize(),c=this._getUrl(a,b);if(!c)return null;var d=this._createTile();return d._layer=this,d.onload=this._tileOnLoad,d.onerror=this._tileOnError,d.style.width=b.x+"px",d.style.height=b.y+"px",d.src=c,d},_getUrl:function(a,b){return!this._map||!a||!b||!this.url?null:this._getUrlStr(a,b)},_getUrlStr:function(a,b){var c=this._map.getProjection();if(!c)return null;var c=this._map.getProjection();if(!c)return null;var d=c.getSrsCode(),e="";if(this._params){var f;for(f in this._params)this._params.hasOwnProperty(f)&&(e!=""&&(e+="&"),e+=f+"="+this._params[f])}e+="&width="+b.x+"&height="+b.y;var g=!1;parseFloat(this._params.VERSION)>=1.3?(e+="&CRS="+d,g=c.getAxisOrder()):e+="&SRS="+d,e+="&BBOX="+a.exportToString(g);var h=L.Util.urlAppend(this.url,e);return encodeURI(h)},_getFeatureInfoStr:function(a){a=a||{};var b=this._map.getExtent(),c=this._map.getSize();a.VERSION=a.VERSION||this._params.VERSION,a.QUERY_LAYERS=a.QUERY_LAYERS||this._params.LAYERS;var d=this._map.getProjection();if(!d)return null;var d=this._map.getProjection();if(!d)return null;var e=d.getSrsCode(),f="",g=L.Util.extend({},this._params,a,{REQUEST:"GetFeatureInfo",WIDTH:c.x,HEIGHT:c.y});if(g){var h;for(h in g)g.hasOwnProperty(h)&&(f!=""&&(f+="&"),f+=h+"="+g[h])}var i=!1;parseFloat(a.VERSION)>=1.3?(f+="&CRS="+e,i=d.getAxisOrder()):f+="&SRS="+e,f+="&BBOX="+b.exportToString(i);var j=L.Util.urlAppend(this.url,f);return j}}),L.Layers.ImageLayer=L.Layers.WMS.extend({singleTile:!0,zoomResFixed:!1,initialize:function(a,b,c){L.Layers.TileBase.prototype.initialize.call(this,a,b,c),this.layerType="L.Layers.ImageLayer"},setUrl:function(a){this.url=a},getTileUrlByExtent:function(a){return this._url},_moveToSingleTile:function(a){L.Layers.Base.prototype._moveTo.call(this,a);if(!this.getVisible()){this._container&&this._container.children.length>0&&this._reset(!0);return}var b=this._map.getResolution();a||(a=this._map.getExtent());var c=L.Util.getPosition(this._map._mapPane),d=-c.x,e=-c.y;this._sIdKey=this._sIdKey?this._sIdKey+1:1;var f=this._getSingleTile(a);if(f){var g=this.maxExtent,h=new L.Loc(parseInt(g.getWidth()/b),parseInt(g.getHeight()/b));f.style.width=h.x+"px",f.style.height=h.y+"px";var i=this._map._pointToAbsPixel(this.tileOrigin);L.Util.setPosition(f,i);var j="id:"+this._sIdKey;f.id=j,this._tilesToLoad=1,this._tiles[j]=f,this._container.appendChild(f)}return this._clearOtherTiles(),this},_getUrl:function(a,b){return!this._map||!a||!b||!this.url?null:this.url}}),L.Layers.TMS=L.Layers.TileBase.extend({_rightAlias:!0,initialize:function(a,b,c){L.Layers.TileBase.prototype.initialize.call(this,a,b,c),this.layerType="L.Layers.TMS"},setUrl:function(a){this.url=a,a&&this.url.charAt(this.url.length-1)!=="/"&&(this.url=this.url+"/")},_getTileUrl:function(a,b,c){return this.url?encodeURI(this.url+a+"/"+c+"/"+b+"."+this.getFormat(null,!1)):null}}),L.Layers.KVPTMS=L.Layers.TMS.extend({initialize:function(a,b,c){L.Layers.TileBase.prototype.initialize.call(this,a,b,c),this.layerType="L.Layers.KVPTMS"},setUrl:function(a){this.url=a;if(a){var b=(a+" ").split(/[?&]/);this.url+=b.pop()===" "?"":b.length?"":"?"}},_getTileUrl:function(a,b,c){return this.url?encodeURI(this.url+"z="+a+"&x="+c+"&y="+b):null}}),L.Layers.WMTS=L.Layers.TileBase.extend({_rightAlias:!1,serviceMode:"KVP",version:"1.0.0",tileMatrixSet:null,layer:null,style:null,initialize:function(a,b,c){L.Layers.TileBase.prototype.initialize.call(this,a,b,c),this.layerType="L.Layers.WMTS",this.setUrl(b)},getServiceMode:function(){return this.serviceMode.toUpperCase()},setServiceMode:function(a){a=a||"KVP";var b=a.toUpperCase();if(b==this.serviceMode)return;if(b=="KVP"||b=="RESTFUL")this.serviceMode=b,this.setUrl(this.url)},setUrl:function(a){this.url=a;if(this.serviceMode=="KVP"){var b=this.url.split("?");this._wmtsUrlParams=null;if(b.length==2){var c=b[1],d=c.split("&");if(d.length>0){var e,f,g,h;for(e=0,f=d.length;e<f;e++){g=d[e];if(!g||g.length<3)continue;h=g.split("=");if(h.length!=2)continue;this._wmtsUrlParams||(this._wmtsUrlParams=[]),this._wmtsUrlParams[h[0].toUpperCase()]=h[1]}}}else this.url.charAt(this.url.length-1)!="?"&&(this.url=this.url+"?")}else this.serviceMode=="RESTFUL"&&this.url.charAt(this.url.length-1)!="/"&&(this.url=this.url+"/")},getUrl:function(){return this.url},_getTileUrl:function(a,b,c){if(!this.url)return null;var d=this.url;if(this.getServiceMode()=="KVP"){!this._wmtsUrlParams&&d.charAt(d.length-1)!="?"&&(d+="?");var e,f={SERVICE:"WMTS",REQUEST:"GetTile",VERSION:this.version,LAYER:this.layer,STYLE:this.style,TILEMATRIXSET:this.tileMatrixSet,TILEMATRIX:a,TILEROW:b,TILECOL:c,FORMAT:this.format};for(e in f)if(f.hasOwnProperty(e)){if(this._wmtsUrlParams&&this._wmtsUrlParams.hasOwnProperty(e)||f[e]==null)continue;d.charAt(d.length-1)!="?"&&d.charAt(d.length-1)!="&"&&(d+="&"),d+=e+"="+f[e]}}else d.charAt(d.length-1)!="/"&&(d+="/"),d+=this.layer+"/"+this.style+"/"+this.tileMatrixSet+"/"+a+"/"+b+"/"+c+"."+this.getFormat(null,!1);return encodeURI(d)}}),L.Layers.TPCTileLayer=L.Layers.WMTS.extend({_getTileUrl:function(a,b,c){if(!this.url)return null;var d=this.url;return d.charAt(d.length-1)!="/"&&(d+="/"),d+=a+"/"+c+"/"+b+"."+this.getFormat(null,!1),encodeURI(d)}}),L.Controls={},L.Controls.Base=L.Class.extend({options:{position:"topright",posxy:new L.Loc(0,0)},_type:"L.Controls.Base",singleAlive:!0,initialize:function(a){L.Util.setOptions(this,a)},getType:function(){return this._type},getPosition:function(){return this.options.position},setPosition:function(a){if(!a||typeof a!="string")return;var b=this._map;return b&&b.removeControl(this),a=a.toLowerCase(),this.options.position=a,b&&b.addControl(this),this},getPosxy:function(){return this.options.posxy},setPosxy:function(a){if(!!a&&a instanceof L.Loc){var b=this._map;return b&&b.removeControl(this),this.options.posxy=a,b&&b.addControl(this),this}return},_setMap:function(a){this._map=a;if(!this._container){this._container=this._initContainer();var b=this.getPosxy();b&&this.moveTo(b)}var c=this._container,d=this.getPosition(),e=a._subControlDivs[d];return L.Util.addClass(c,"leaflet-control"),d.indexOf("bottom")!==-1?e.insertBefore(c,e.firstChild):e.appendChild(c),this},moveTo:function(a){if(a!=null&&this._container!=null){var b=this.getPosition();if(b=="topleft")this._container.style.top=a.y+"px",this._container.style.left=a.x+"px";else if(b=="topright")this._container.style.top=a.y+"px",this._container.style.right=a.x+"px";else if(b=="bottomleft")this._container.style.bottom=a.y+"px",this._container.style.left=a.x+"px";else{if(b!="bottomright")return;this._container.style.bottom=a.y+"px",this._container.style.right=a.x+"px"}}},_createButton2:function(a,b,c,d,e){var f=L.Util.create("a","leaflet-button "+b,c);return f.href="#",f.title=a,L.DomEvent.addListener(f,"click",L.DomEvent.stopPropagation).addListener(f,"click",L.DomEvent.preventDefault).addListener(f,"click",d,e),f},_createButton:function(a,b,c,d,e){var f=L.Util.create("div","leaflet-button "+b,c);return a&&(f.title=a),L.DomEvent.addListener(f,"click",L.DomEvent.stopPropagation).addListener(f,"click",L.DomEvent.preventDefault),f},_setButtonClassName:function(a,b){a&&(a.className="leaflet-button "+b)},_unsetMap:function(a){var a=a||this._map,b=this.getPosition(),c=a._subControlDivs[b];if(c&&this._container)try{c.removeChild(this._container)}catch(d){}return this._onRemove&&this._onRemove(a),this}}),L.Controls.Zoom=L.Class.extend({_container:null,_trArr:null,_tlArr:null,_brArr:null,_blArr:null,_map:null,_ArrWidth:7,_startTime:-1,_minWidth:12,_maxWidth:45,_minHeight:10,_maxHeight:36,_outTag:!0,_center:null,_zoomAnimationTimer:null,initialize:function(){this._interval=Math.round(1e3/60)},_initContainer:function(){var a=this._map._panes.tmpPane;this._container=L.Util.create("div","leaflet-zoomdirect-pane",a);var b=this._container;this._tlArr=L.Util.create("div","zoomdirect-tl",b),this._trArr=L.Util.create("div","zoomdirect-tr",b),this._brArr=L.Util.create("div","zoomdirect-br",b),this._blArr=L.Util.create("div","zoomdirect-bl",b)},_setMap:function(a){if(!a||!a._mapPane||a._zoomDirectionCtrl)return;this._map=a,this._initContainer(),a._zoomDirectionCtrl=this},setMode:function(a){this._outTag=a;if(!this._container)return;var b=a?"leaflet-zoomdirect-pane-out":"leaflet-zoomdirect-pane";L.Util.setClass(this._container,b)},enable:function(a,b){if(!this._container||!this._map||!a)return;this.disable(),this._center=a.subtract(L.Util.getPosition(this._map._mapPane));var c=b>0?!0:!1;this.setMode(c),this._runTimerAnimation(0),L.Util.removeClass(this._container,"leaflet-show"),this._startTime=L.Util.getTime();var d=this;this._zoomAnimationTimer=setInterval(d._zoomStep(d),this._interval)},_runTimerAnimation:function(a){if(!this._center){this.disable();return}var b=(this._maxWidth-this._minWidth)*a;b=this._outTag?b+this._minWidth:this._maxWidth-b;var c=(this._maxHeight-this._minHeight)*a;c=this._outTag?c+this._minHeight:this._maxHeight-c;var d=Math.round(this._center.x-b-this._ArrWidth),e=Math.round(this._center.x+b),f=Math.round(this._center.y-c-this._ArrWidth),g=Math.round(this._center.y+c);L.Util.setPosition(this._tlArr,new L.Loc(d,f)),L.Util.setPosition(this._trArr,new L.Loc(e,f)),L.Util.setPosition(this._blArr,new L.Loc(d,g)),L.Util.setPosition(this._brArr,new L.Loc(e,g))},_completeZoomAnim:function(){this.disable()},_zoomStep:function(a){var b=a;return function(){var a=L.Util.getTime(),c=a-b._startTime,d=400;c<d?b._runTimerAnimation(L.Util.getBezierPos(c/d)):(b._runTimerAnimation(1),b._completeZoomAnim())}},disable:function(){if(!this._container||!this._map)return;this._zoomAnimationTimer&&clearInterval(this._zoomAnimationTimer),this._zoomAnimationTimer=null,this._center=null,L.Util
.addClass(this._container,"leaflet-show")}}),L.Controls.PanZoom=L.Controls.Base.extend({_type:"L.Controls.PanZoom",_initContainer:function(){var a=this._map,b="leaflet-control-zoom",c=L.Util.create("div",b);return this._createButton2("Zoom in",b+"-in",c,a.zoomIn,a),this._createButton2("Zoom out",b+"-out",c,a.zoomOut,a),c}}),L.Controls.PanZoomBar=L.Controls.Base.extend({options:{position:"topleft",zoomStep:6,heightWithoutSlider:86,zoomControlTop:45,zoominBtHeight:21,zoominBtShadow:6,sliderHeight:11,levelTagHeight:21,useLevelTag:!0,useZoomBarTag:!0,resParams:{1:.17578125,2:.010986328125,3:.0006866455078125,4:4291534423828125e-20}},_type:"L.Controls.PanZoomBar",initialize:function(a){L.Util.setOptions(this,a)},_initContainer:function(){var a=this._map,b="leaflet-control-panzoombar",c=L.Util.create("div",b);return this._container=c,L.Util.stamp(this._container),this._pancontrol=L.Util.create("div","pancontrol",c),this._panleftbt=this._createButton("","panleftbt",this._pancontrol),this._panrightbt=this._createButton("","panrightbt",this._pancontrol),this._pantopbt=this._createButton("","pantopbt",this._pancontrol),this._panbottombt=this._createButton("","panbottombt",this._pancontrol),this._zoomcontrol=L.Util.create("div","zoomcontrol",c),this._zoominbt=this._createButton("","zoominbt",this._zoomcontrol),this._zoomoutbt=this._createButton("","zoomoutbt",this._zoomcontrol),this.options.useZoomBarTag&&(this._zoombardiv=L.Util.create("div","barcontrol",this._zoomcontrol),this._sliderbarbg=L.Util.create("div","sliderbarbg",this._zoombardiv),this._sliderbartop=L.Util.create("div","sliderbartop",this._zoombardiv),this._sliderbt=this._createButton(null,"sliderbt",this._zoombardiv)),this._updateContainer(),this._levelTagResObj=this.options.useZoomBarTag&&this.options.useLevelTag?this._getLevelTagObject():null,this._initLevelTagResDivs(),this._initEvents(),c},_initLevelTagResDivs:function(){if(!this._levelTagResObj||!this._map)return;var a=this._map.getZoomCount(),b=this,c,d,e,f,g,h,i="leveltag-",j=this.options.zoomStep,k=this.options.zoomControlTop,l=this.options.zoominBtHeight,m=this.options.levelTagHeight/2,n=this.options.zoominBtShadow;this._levelTagBts=[];for(c in this._levelTagResObj)if(this._levelTagResObj.hasOwnProperty(c)){g=this._levelTagResObj[c];if(g){f=g.tag,d=g.zoom,e=g.res,h=(a-d)*j-m,this._levelTagBts[f]=this._createButton(null,i+f,this._zoombardiv),this._levelTagBts[f].style.top=h+"px";var o=function(a){return function(c){b._map.setView(null,a)}}(d);L.DomEvent.addListener(this._levelTagBts[f],"click",o)}}this._setLevelTagDivs(!1)},_getLevelTagObject:function(){var a=this._map.getResolutions(),b,c,d=a.length,e,f,g,h=-1,i=this.options.resParams;maxRes=a[0],minRes=a[a.length-1];var j={};for(b in i)if(i.hasOwnProperty(b)){e=i[b],h=L.Util.getSuiteIndex(e,a);if(h==-1)continue;f="t"+h;if(!j.hasOwnProperty(f)||i[j[f].tag]<e)j[f]={zoom:h,tag:b,res:a[h]}}return j},_updateContainer:function(){var a=this._map,b=a.getZoomCount(),c=a.getZoom();this.options.useZoomBarTag||(b=0);var d=this.options.zoomStep,e=this.options.zoomControlTop,f=this.options.zoominBtHeight,g=this.options.sliderHeight,h=this.options.zoominBtShadow,i=f+e-h,j=d*b+h,k=j+2*f-h;this._zoomcontrol.style.height=k+"px";var l=i+j;this._zoomoutbt.style.top=l+"px";var m=0,n=0;this.options.useZoomBarTag&&(this._zoombardiv.style.height=j+"px",this._sliderbarbg.style.height=j+"px",m=(c+1)*d,this._sliderbartop.style.height=m+"px",n=j-m,this._sliderbartop.style.top=n+"px",this._sliderbt.style.top=n-g/2+"px");var o=this.options.heightWithoutSlider+j;this._container.style.height=o+"px"},_initEvents:function(){if(!this._map)return;var a=this._map,b=this;L.DomEvent.addListener(this._panleftbt,"mouseenter",function(a){b._pancontrol.className="pancontrol-left"}),L.DomEvent.addListener(this._panleftbt,"mouseout",function(a){b._pancontrol.className="pancontrol"}),L.DomEvent.addListener(this._panrightbt,"mouseenter",function(a){b._pancontrol.className="pancontrol-right"}),L.DomEvent.addListener(this._panrightbt,"mouseout",function(a){b._pancontrol.className="pancontrol"}),L.DomEvent.addListener(this._pantopbt,"mouseenter",function(a){b._pancontrol.className="pancontrol-top"}),L.DomEvent.addListener(this._pantopbt,"mouseout",function(a){b._pancontrol.className="pancontrol"}),L.DomEvent.addListener(this._panbottombt,"mouseenter",function(a){b._pancontrol.className="pancontrol-bottom"}),L.DomEvent.addListener(this._panbottombt,"mouseout",function(a){b._pancontrol.className="pancontrol"});var c=80;L.DomEvent.addListener(this._panleftbt,"click",function(a){b._map.panBy(new L.Loc(c,0))}),L.DomEvent.addListener(this._panrightbt,"click",function(a){b._map.panBy(new L.Loc(-c,0))}),L.DomEvent.addListener(this._panbottombt,"click",function(a){b._map.panBy(new L.Loc(0,-c))}),L.DomEvent.addListener(this._pantopbt,"click",function(a){b._map.panBy(new L.Loc(0,c))}),L.DomEvent.addListener(this._zoominbt,"mouseenter",function(a){b._setButtonClassName(b._zoominbt,"zoominbt2")}),L.DomEvent.addListener(this._zoominbt,"mouseout",function(a){b._setButtonClassName(b._zoominbt,"zoominbt")}),L.DomEvent.addListener(this._zoomoutbt,"mouseenter",function(a){b._setButtonClassName(b._zoomoutbt,"zoomoutbt2")}),L.DomEvent.addListener(this._zoomoutbt,"mouseout",function(a){b._setButtonClassName(b._zoomoutbt,"zoomoutbt")}),L.DomEvent.addListener(this._zoominbt,"click",function(a){b._map.zoomIn()}),L.DomEvent.addListener(this._zoomoutbt,"click",function(a){b._map.zoomOut()}),this.options.useZoomBarTag&&(L.DomEvent.addListener(this._sliderbarbg,"click",this._onSliderBarClick,this),L.DomEvent.addListener(this._sliderbartop,"click",this._onSliderBarTopClick,this)),L.DomEvent.disableClickPropagation(this._container),L.DomEvent.addListener(this._container,"click",L.DomEvent.preventDefault),L.DomEvent.addListener(this._container,"mouseover",this._showLevelTagDivs,this),L.DomEvent.addListener(this._container,"mouseleave",this._hideLevelTagDivs,this),a.on("zoomend",this._updateContainer,this),a.on("changebasiclayer",this._reset,this)},_onRemove:function(){var a=this._map;a.off("zoomend",this._updateContainer),a.off("changebasiclayer",this._reset),this._container=null},_showLevelTagDivs:function(a){this._showHideTimer&&clearTimeout(this._showHideTimer),this._setLevelTagDivs(!0)},_hideLevelTagDivs:function(a){this._showHideTimer&&clearTimeout(this._showHideTimer);var b=this;this._showHideInterval=1e3,this._showHideTimer=setTimeout(b._hideLevelTagDivsTimerFunc(b),this._showHideInterval)},_hideLevelTagDivsTimerFunc:function(a){var b=a;return function(){b._setLevelTagDivs(!1)}},_setLevelTagDivs:function(a){if(this.options.useZoomBarTag&&this.options.useLevelTag&&this._levelTagBts){var b,c;for(b in this._levelTagBts)this._levelTagBts.hasOwnProperty(b)&&(c=this._levelTagBts[b],c.style.visibility=a?"inherit":"hidden")}},_reset:function(){this._map&&(this._map.removeControl(this),this._map.addControl(this))},_onSliderBarClick:function(a){if(!this._map)return;var b=this._map,c=b.getZoomCount()-1,d=L.DomEvent.getMousePosition(a,this._sliderbarbg),e=Math.round((d.y-this.options.zoominBtShadow)/this.options.zoomStep),f=c-e;f=f>c?c:f,f=f<0?0:f,b.setView(b.getCenter(),f)},_onSliderBarTopClick:function(a){if(!this._map)return;var b=L.DomEvent.getMousePosition(a,this._sliderbartop),c=this._map,d=c.getZoomCount()-1,e=c.getZoom(),f=Math.round(b.y/this.options.zoomStep),g=e-f;g=g>d?d:g,g=g<0?0:g,c.setView(c.getCenter(),g)}}),L.Controls.Scale=L.Controls.Base.extend({topOutUnits:"km",topInUnits:"m",_type:"L.Controls.Scale",options:{maxWidth:100,position:"bottomleft",headStr:""},initialize:function(a){L.Util.setOptions(this,a)},_initContainer:function(){var a=this._map,b="leaflet-control-scale";this._container=L.Util.create("div",b),L.Util.stamp(this._container);var c="leaflet-control-scale-pic";this._pic=L.Util.create("div",c),L.Util.stamp(this._pic);var d="leaflet-control-scale-char";return this._char=L.Util.create("div",d),L.Util.stamp(this._char),this._container.appendChild(this._pic),this._container.appendChild(this._char),this._initEvents(),this._container},_initEvents:function(){var a=this._map;a.on("zoomend",this._updateScale,this)},_updateScale:function(a){var b=this._map.getResolution();if(!b)return;var c=this._map.getUnits(),d=L.Util.INCHES_PER_UNIT,e=this.options.maxWidth*b*d[c],f;e>1e5?f=this.topOutUnits:f=this.topInUnits;var g=e/d[f],h=this._getWidth(g);g=h/d[c]*d[f];var i=g/b;this._pic.style.borderStyle="groove",this._pic.style.borderTopStyle="none",this._pic.style.textAlign="center",this._pic.style.width=Math.round(i)+"px",this._pic.innerHTML=h+" "+f,this._update()},_setMap:function(a){L.Controls.Base.prototype._setMap.call(this,a),this._updateScale()},_getWidth:function(a){var b=parseInt(Math.log(a)/Math.log(10)),c=Math.pow(10,b),d=parseInt(a/c),e;return d>5?e=5:d>2?e=2:e=1,e*c},_update:function(){var a=this._map.getScale();if(!a)return;a>=9500?a=Math.round(a/1e4)+"":a=Math.round(a),this._char.style.borderStyle="none",this._char.innerHTML=" = 1 : "+a},_onRemove:function(){var a=this._map;a.off("zoomend",this._updateScale)}}),L.Controls.Position=L.Controls.Base.extend({_type:"L.Controls.Position",options:{position:"bottomright",headStr:"X: ",separator:" , Y: ",tailStr:"",digitsNum:4},initialize:function(a){L.Util.setOptions(this,a)},_initContainer:function(){var a=this._map,b="leaflet-control-position";return this._container=L.Util.create("div",b),L.Util.stamp(this._container),this._initEvents(),this._container},_initEvents:function(){var a=this._map;a.on("mousemove",this._updatePosition,this)},_updatePosition:function(a){if(!a||!a.point)return;var b=a.point,c=this.options.headStr+this._formatNum(b.x)+this.options.separator+this._formatNum(b.y)+this.options.tailStr;this._container.innerHTML=c},_formatNum:function(a){var b=parseInt(this.options.digitsNum);return a.toFixed(b)},_onRemove:function(){var a=this._map;a.off("mousemove",this._updatePosition)}}),L.Popups={},L.Popups.Base=L.Class.extend({includes:L.Mixin.Events,options:{minWidth:50,maxWidth:300,maxHeight:null,autoPan:!0,closeButton:!0,pixelOffset:new L.Loc(0,2),autoPanPadding:new L.Loc(5,5),className:""},initialize:function(a,b){L.Util.setOptions(this,a),this._source=b},_setMap:function(a){this._map=a,this._container||this._initLayout(),this._updateContent(),this._container.style.opacity="0",this._map._panes.popupPane.appendChild(this._container),this._map.on("viewreset",this._updatePosition,this),!L.Util.Browser.android&&this._map.closeDialogOnClick&&this._map.on("click",this._close,this),this._update(),this._container.style.opacity="1",this._opened=!0},_unsetMap:function(a){a=a||this._map,a._panes.popupPane.removeChild(this._container),L.Util.falseFn(this._container.offsetWidth),a._dlgAutoPanTag=!1,a.off("moveend",this._autoPanEnd,this),a.off("viewreset",this._updatePosition,this),!L.Util.Browser.android&&this._map.closeDialogOnClick&&a.off("click",this._close,this),this._container.style.opacity="0",this._opened=!1,this._map=null},setPosition:function(a){return this._latlng=a,this._opened&&this._update(),this},setContent:function(a){return this._content=a,this._opened&&this._update(),this},hide:function(){this._container&&L.Util.addClass(this._container,"leaflet_hide")},show:function(){this._container&&L.Util.removeClass(this._container,"leaflet_hide")},_close:function(){var a=this._map;a&&(this._singleDlgTag?this._map.closeSingleDialog(this):this._map.closeDialog(this))},_initLayout:function(){this._container=L.Util.create("div","leaflet-popup"),this.options.closeButton&&(this._closeButton=L.Util.create("a","leaflet-popup-close-button",this._container),this._closeButton.href="#close",L.DomEvent.addListener(this._closeButton,"click",this._onCloseButtonClick,this)),this._wrapper=L.Util.create("div","leaflet-popup-content-wrapper",this._container),L.DomEvent.disableClickPropagation(this._wrapper),this._contentNode=L.Util.create("div","leaflet-popup-content",this._wrapper),L.DomEvent.addListener(this._contentNode,"mousewheel",L.DomEvent.stopPropagation),this._tipContainer=L.Util.create("div","leaflet-popup-tip-container",this._container),this._tip=L.Util.create("div","leaflet-popup-tip",this._tipContainer)},_update:function(){if(!this._map)return;this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan()},_updateContent:function(){if(!this._content)return;typeof this._content=="string"?this._contentNode.innerHTML=this._content:(this._contentNode.innerHTML="",this._contentNode.appendChild(this._content)),this.fire("popupcontentupdate")},_updateLayout:function(){var a=this._contentNode;a.style.width="",a.style.whiteSpace="nowrap";var b=a.offsetWidth;b=Math.min(b,this.options.maxWidth),b=Math.max(b,this.options.minWidth),a.style.width=b+1+"px",a.style.whiteSpace="",this._tipContainer.style.marginLeft=b/2+2+"px",a.style.height="";var c=a.offsetHeight,d=this.options.maxHeight,e=" leaflet-popup-scrolled";d&&c>d?(a.style.height=d+"px",a.className+=e):a.className=a.className.replace(e,""),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){var a=this._map._pointToAbsPixel(this._latlng);this._containerBottom=-a.y-this.options.pixelOffset.y,this._containerLeft=a.x-Math.round(this._containerWidth/2)+this.options.pixelOffset.x,this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"},_adjustPan:function(){if(!this.options.autoPan)return;var a=this._container.offsetHeight,b=new L.Loc(this._containerLeft,-a-this._containerBottom),c=b.add(L.Util.getPosition(this._map._mapPane)),d=new L.Loc(0,0),e=this.options.autoPanPadding,f=this._map.getSize();c.x<0&&(d.x=c.x-e.x),c.x+this._containerWidth>f.x&&(d.x=c.x+this._containerWidth-f.x+e.x),c.y<0&&(d.y=c.y-e.y),c.y+a>f.y&&(d.y=c.y+a-f.y+e.y);if(d.x||d.y){if(!this._map)return;this._map._dlgAutoPanTag=!0,this._map.fire("popupautopanstart",{popup:this}),this._map.panBy(d),this._map.on("moveend",this._autoPanEnd,this)}},_autoPanEnd:function(){this._map&&this._map._dlgAutoPanTag&&(this._map._dlgAutoPanTag=!1,this._map.fire("popupautopanend",{popup:this}),this._map.off("moveend",this._autoPanEnd,this))},_onCloseButtonClick:function(a){this._close(),L.DomEvent.stop(a)}}),L.Popups.BaseOptions={minWidth:50,maxWidth:800,closeButton:!0,pixelOffset:L.Loc(0,2),content:""},L.Ols={},L.Ols.Base=L.Class.extend({initialize:function(){},setVisible:function(a){}}),L.Ols.EleBase=L.Class.extend({includes:L.Mixin.Events,options:{title:null,content:"",offset:new L.Loc(0,0),zIndexOffset:0,popable:!0,clickable:!0,draggable:!1},initialize:function(a,b){L.Util.setOptions(this,b),this._latlng=a},setOpacity:function(a){if(a==undefined)return;a=Math.abs(a),a=a>1?1:a,this.options.opacity=a,this._element&&L.Util.setOpacity(this._element,a)},getPosition:function(){return this._latlng},setPosition:function(a){this._latlng=a,this._update()},setVisible:function(a){this._element&&(this._element.style.visibility=a?"inherit":"hidden")},addClass:function(a){this._element&&L.Util.addClass(this._element,a)},removeClass:function(a){this._element&&L.Util.removeClass(this._element,a)},setStyle:function(a){if(a&&this._element){var b;for(b in a)a.hasOwnProperty(b)&&(this._element.style[b]=a[b])}},setTitle:function(a){this.options.title=a,this._element&&(this._element.title=a)},enableDrag:function(){return this._map?(this.options.draggable=!0,this.dragging||(this.dragging=new L.Ols.EleBase.Drag(this)),this.dragging.enable(),this):(this.options.draggable=this.draggable=!0,this)},disableDrag:function(){return this._map?(this.options.draggable=!1,this.dragging&&this.dragging.disable(),this):(this.options.draggable=this.draggable=!1,this)},enablePop:function(){this.options.popable=!0,this.on("mouseover",this._onMouseOver,this),this.on("mouseout",this._onMouseOut,this)},disablePop:function(){this._pushToBack(),this.options.popable=!1,this.off("mouseover",this._onMouseOver),this.off("mouseout",this._onMouseOut)},bringToFront:function(){this._popToFront()},_creatElement:function(){return null},_setMap:function(a){this._map=a,this._initElement(),a.on("viewreset",this._update,this),this._update()},_unsetMap:function(a){a=a||this._map,this._removeElement(),a.off("viewreset",this._update,this),this._map=null},_initElement:function(){if(!this._element){this._element=this._creatElement();if(!this._element)return;if(this.options.offset){var a=this.options.offset;this._element.style.marginLeft=a.x+"px",this._element.style.marginTop=a.y+"px"}this.options.title&&(this._element.title=this.options.title),this.options.opacity!==undefined&&L.Util.setOpacity(this._element,this.options.opacity),this._initInteraction()}this._map._panes.markerPane.appendChild(this._element)},setOffset:function(a){a&&(this.options.offset=a),this._element&&(this._element.style.marginLeft=a.x+"px",this._element.style.marginTop=a.y+"px")},_removeElement:function(){this._map._panes.markerPane.removeChild(this._element),this._element=null},_getMoveTarget:function(){return this._element},_getDragTarget:function(){return this._element},_update:function(){var a=this._map._pointToAbsPixel(this._latlng).round();L.Util.setPosition(this._element,a),this._poped||(this._element.style.zIndex=a.y+this.options.zIndexOffset)},_initInteraction:function(){this.options.popable&&this.enablePop(),this.options.clickable&&(this._element.className+=" leaflet-clickable"),L.DomEvent.addListener(this._element,"click",this._onMouseClick,this);var a=["dblclick","mousedown","mouseover","mouseout","mouseup"];for(var b=0;b<a.length;b++)L.DomEvent.addListener(this._element,a[b],this._fireMouseEvent,this);this.on("mouseover",this._onMouseOver,this),this.on("mouseout",this._onMouseOut,this),this.options.draggable&&this.enableDrag()},_onMouseClick:function(a){if(this.dragging&&this.dragging.moved())return;this.fire(a.type,{originalEvent:a}),L.DomEvent.stopPropagation(a)},_popToFront:function(){this._poped=!0,this._element&&(this._element.style.zIndex=L.Util.MaxZIndex)},_pushToBack:function(){this._poped=!1;if(!this._element)return;var a=L.Util.getPosition(this._element);isNaN(this.options.zIndexOffset)?this._element.style.zIndex="auto":this._element.style.zIndex=a.y+this.options.zIndexOffset},_onDragUpdate:function(a){this._latlng=a.point},_onMouseOver:function(a){if(this.dragging&&this.dragging.moved())return;this.options.popable&&this._popToFront(),L.DomEvent.stopPropagation(a)},_onMouseOut:function(a){if(this.dragging&&this.dragging.moved())return;this.options.popable&&this._pushToBack(),L.DomEvent.stopPropagation(a)},_fireMouseEvent:function(a){if(!this._map||this._map.getHegemonTag())return;this.fire(a.type,{originalEvent:a})}}),L.Ols.EleBaseOptions={title:null,offset:new L.Loc(0,0),zIndexOffset:0,popable:!0,clickable:!0,draggable:!1},L.Ols.Label=L.Ols.EleBase.extend({options:{content:"",offset:new L.Loc(0,0),zIndexOffset:0,popable:!0,clickable:!0,draggable:!1},initialize:function(a,b){this.options=L.Util.extend({content:""},L.Ols.EleBaseOptions,b),this._latlng=a},getContent:function(){return this.options.content},setContent:function(a){this.options.content=a,this._element&&(this._element.innerHTML=this.options.content)},_creatElement:function(){var a;return a=document.createElement("label"),a.className="leaflet-label",a.innerHTML=this.options.content,a.unselectable="on",a.hashCode="mz_2s",a},_initElement:function(){L.Ols.EleBase.prototype._initElement.call(this),this.options.content&&this.setContent(this.options.content)}}),L.Ols.TipLabel=L.Ols.EleBase.extend({options:{content:"",offset:new L.Loc(0,0),zIndexOffset:0,popable:!0,clickable:!0,draggable:!1},initialize:function(a,b){this.options=L.Util.extend({content:""},L.Ols.EleBaseOptions,b),this._latlng=a},getContent:function(){return this.options.content},setContent:function(a){this.options.content=a,this._element&&(this._element.innerHTML=this.options.content)},_creatElement:function(){return this._container=L.Util.create("div","leaflet-arrowlab"),this._wrapper=L.Util.create("div","leaflet-label-content-wrapper",this._container),L.DomEvent.disableClickPropagation(this._wrapper),this._contentNode=L.Util.create("div","leaflet-label",this._wrapper),this._contentNode.innerHTML=this.options.content,L.DomEvent.addListener(this._contentNode,"mousewheel",L.DomEvent.stopPropagation),this._tipContainer=L.Util.create("div","leaflet-label-tip-container",this._container),this._tip=L.Util.create("div","leaflet-arrowlabel",this._tipContainer),this._container}}),L.Ols.EditAnchor=L.Ols.EleBase.extend({options:{content:"",zIndexOffset:6e4,offset:null,clickable:!0,draggable:!0},initialize:function(a,b){L.Util.setOptions(this,b),this._latlng=a},getContent:function(){return this.options.content},setContent:function(a){this.options.content=a},_creatElement:function(){var a;return a=document.createElement("div"),a.className="leaflet-div-element",this.options.content&&(a.innerHTML=this.options.content),a.unselectable="on",a.hashCode="mz_2s",a}}),L.Ols.ContextMenu=L.Class.extend({_menuItems:null,_separators:null,initialize:function(){this._container=L.Util.create("div","leaflet_contextMenu")},addItem:function(a){a&&a instanceof L.Ols.ContextMenuItem&&(this._menuItems=this._menuItems||new Array,a._setContextMenu(this),this._menuItems.push(a))},addSeparator:function(){var a=L.Util.create("div","leaflet_contextMenu_sepr",this._container),b=L.Util.stamp(a);a.id=b,this._separators=this._separators||new Array,this._separators.push(b)},removeSeparator:function(a){if(this._separators&&a<this._separators.length){var b=this._separators[a],c=document.getElementById(b);c&&c.parentNode&&(this._separators.splice(a,1),this._container.removeChild(c))}},getItem:function(a){return this._menuItems&&a<this._menuItems.length?this._menuItems[a]:null},removeItem:function(a){if(a&&a instanceof L.Ols.ContextMenuItem&&this._menuItems){var b,c=L.Util.stamp(a);for(var d=0;d<this._menuItems.length;d++)if(this._menuItems[d]){b=L.Util.stamp(this._menuItems[d]);if(b==c){this._menuItems.splice(d,1),this._menuItems[d]._unsetContextMenu();return}}}},show:function(a){this.posObjects=a,this._container.style.display="block",L.Util.setPosition(this._container,a.pixel)},hide:function(){this._container.style.display="none"},_setMap:function(a){this._map=a,this._map&&this._map.on("mousedown",this.hide,this),this._map&&this._map._container&&this._map._container.appendChild(this._container)},_unsetMap:function(){this.hide(),this._map&&this._map.off("mousedown",this.hide,this),this._map&&this._map._container&&this._map._container.removeChild(this._container),this._map=null}}),L.Ols.ContextMenuItem=L.Class.extend({text:"",callback:null,posObjects:null,initialize:function(a,b){this.text=a,this.callback=b,this._itemDiv=L.Util.create("div","leaflet_contextMenu_item"),this._itemDiv.innerHTML="<span>"+a+"</span>",L.DomEvent.addListener(this._itemDiv,"mousedown",function(a){L.DomEvent.stopPropagation(a)}),L.DomEvent.addListener(this._itemDiv,"click",function(a){var b=a;return function(a){b.callback&&(b.callback(b._parent.posObjects),b._parent.hide()),L.DomEvent.stopPropagation(a)}}(this)),L.DomEvent.addListener(this._itemDiv,"mouseover",function(a){L.Util.addClass(this," leaflet_contextMenu_item_hover"),L.DomEvent.stopPropagation(a)}),L.DomEvent.addListener(this._itemDiv,"mouseout",function(a){L.Util.removeClass(this," leaflet_contextMenu_item_hover")})},_setContextMenu:function(a){this._parent=a,a._container.appendChild(this._itemDiv)},_unsetContextMenu:function(){this._parent._container.removeChild(this._itemDiv)}}),L.Ols.Marker=L.Ols.Base.extend({includes:L.Mixin.Events,options:{imgUrl:L.Icon.Default.imagePath+"marker.png",shadowUrl:L.Icon.Default.imagePath+"marker-shadow.png",markerSize:new L.Loc(25,41),shadowSize:new L.Loc(41,41),labelSize:new L.Loc(50,50),markerAnchor:new L.Loc(13,41),shadowAnchor:new L.Loc(13,41),popupAnchor:new L.Loc(0,-33),labelAnchor:new L.Loc(0,-33),markerTitle:"",assignId:"",visible:!0,labelable:!1,labelContent:"",popable:!0,clickable:!0,draggable:!1,zIndexOffset:0,labeClass:{backgroundColor:"#ffffe1",border:"#8c8c8c 1px solid",fontSize:"12px",fontFamily:"",color:"#4d4d4d"}},_type:"L.Ols.Marker",getType:function(){return this._type},initialize:function(a,b){this.options=L.Util.extend({},L.Ols.MarkerOptions,b),this._latlng=a},getPosition:function(){return this._latlng},setPosition:function(a){this._latlng=a,this._markerTarget&&(this._update(),this._popup&&this._popup.setPosition(this._latlng))},enableDrag:function(){return this.options.draggable=this.draggable=!0,this._map?(this.dragging||(this.dragging=new L.Ols.EleBase.Drag(this)),this.dragging.enable(),this.on("dragend",this.bringToBack,this),this):this},disableDrag:function(){return this.options.draggable=this.draggable=!1,this._map?(this.dragging&&(this.dragging.disable(),this.off("dragend",this.bringToBack,this)),this):this},enablePop:function(){this.options.popable=!0,this.on("mouseover",this._onMouseOver,this),this.on("mouseout",this._onMouseOut,this)},disablePop:function(){this._pushToBack(),this.options.popable=!1,this.off("mouseover",this._onMouseOver),this.off("mouseout",this._onMouseOut)},bringToFront:function(){this._popToFront()},bringToBack:function(){this._pushToBack()},setTitle:function(a){this.options.markerTitle=a,this._markerTarget&&(this._markerTarget.title=this.options.markerTitle)},getVisible:function(){return this.options.visible},setVisible:function(a){a=a?!0:!1;var b=a?"":"none";if(this.options.visible==a)return;this.options.visible=a,this._popup&&this._popup._close(),this._markerTarget&&(this._markerTarget.style.display=b),this._shadow&&(this._shadow.style.display=b),this._label&&(this._label.style.display=b)},openDialog:function(){return this._popup.setPosition(this._latlng),this._map.openDialog(this._popup),this},closeDialog:function(){return this._popup&&this._popup._close(),this},setDialog:function(a,b,c){return c=L.Util.extend({pixelOffset:this.options.popupAnchor},c),b=b||L.Popups.Base,this._popup||this.on("click",this.openDialog,this),this._popup=new b(c,this),this._popup.setContent(a),this},unsetDialog:function(){return this._popup&&(this._popup=null,this.off("click",this.openDialog)),this},_popToFront:function(){this._poped=!0;var a=this._getHoverElem();if(!a)return;a.style.zIndex=L.Util.MaxZIndex},_pushToBack:function(){this._poped=!1;var a=this._getHoverElem();if(!a)return;isNaN(this.options.zIndexOffset)?a.style.zIndex="auto":a.style.zIndex=this.options.zIndexOffset},_getHoverElem:function(){return this._markerTarget},_onMouseOver:function(a){L.DomEvent.stopPropagation(a),this.options.popable&&this._popToFront()},_onMouseOut:function(a){L.DomEvent.stopPropagation(a),this.options.popable&&this._pushToBack()},_createImg:function(a){var b;return L.Util.Browser.ie6?(b=document.createElement("div"),b.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+a+'")'):(b=document.createElement("img"),b.src=a),b},_updateImg:function(){if(this._markerTarget){var a=this.options.imgUrl;L.Util.Browser.ie6?this._markerTarget.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+a+'")':this._markerTarget.src=a}},_updateShadowImg:function(){if(this._shadow){var a=this.options.shadowUrl;L.Util.Browser.ie6?this._shadow.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+a+'")':this._shadow.src=a}},_setMap:function(a){this._map=a,this._initMarker(),a.on("viewreset",this._update,this),this._update(!0)},_aviodDragDefault:function(a){var b=this._getDragTarget();if(!b)return;a?L.DomEvent.addListener(b,L.Draggable.MOVE,this._unsetDefaultDragEvent,this):L.DomEvent.removeListener(b,L.Draggable.MOVE,this._unsetDefaultDragEvent,this)},_unsetDefaultDragEvent:function(a){L.DomEvent.stop(a)},_unsetMap:function(a){a=a||this._map,this._removeMarker(),this.closeDialog&&this.closeDialog(),a.off("viewreset",this._update,this),this._map=null},getOption:function(a){return this.options[a]},getOptions:function(){return this.options},setOption:function(a,b){a!==undefined&&b!==undefined&&(this.options[a]=b),this._updateMarker()},setImgUrl:function(a){this.setOption("imgUrl",a)},setShadowUrl:function(a){this.setOption("shadowUrl",a)},getBounds:function(){var a=null;return this._latlng?new L.Extent(this._latlng.x,this._latlng.y,this._latlng.x,this._latlng.y):null},_createMarkerTarget:function(){var a=this.options.imgUrl;if(!a)return null;var b=this._createImg(a);return b.className="leaflet-marker-img",b},_createShadowImg:function(){var a=this.options.shadowUrl;if(!a||!a.length)return null;var b=this._createImg(a);return b.className="leaflet-marker-shadow",b},_createLabel:function(){var a=this.options.labelLineCharCount||1e3,b=this.options.labelContent.length>a?a:this.options.labelContent.length,c="";for(var d=0;d<this.options.labelContent.length;d++)d%a==0&&d!=0&&(c+="<br/>"),c+=this.options.labelContent[d];if(c=="")return null;var e=document.createElement("div");return e.innerHTML=c,e.className="leaflet-marker-label",e},_initMarker:function(){this._markerTarget||(this._markerTarget=this._createMarkerTarget()),this.options.assignId&&(this._markerTarget.id=this.options.assignId),this._shadow||(this._shadow=this._createShadowImg()),this._map._panes.markerPane.appendChild(this._markerTarget),this._shadow&&this._map._panes.shadowPane.appendChild(this._shadow),this.options.labelable&&this.options.labelContent!=""&&(this._label||(this._label=this._createLabel()),this._map._panes.labelPane.appendChild(this._label)),isNaN(this.options.zIndexOffset)||(this._markerTarget.style.zIndex=this.options.zIndexOffset),this._initInteraction()},_removeMarker:function(){this._map._panes.markerPane.removeChild(this._markerTarget),this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow),this._label&&this._map._panes.labelPane.removeChild(this._label),this._markerTarget=this._shadow=null},_getMoveTarget:function(){return this._markerTarget},_getDragTarget:function(){return this._markerTarget},_onDragUpdate:function(a){this._shadow&&L.Util.setPosition(this._shadow,a.absPixel),this._label&&L.Util.setPosition(this._label,a.absPixel),this._latlng=a.point},_updateMarker:function(){var a=this.options.markerSize,b=this.options.shadowSize,c=this.options.labelSize,d=this.options.markerAnchor,e=this.options.markerTitle,f=isNaN(this.options.zIndexOffset)?0:Math.round(this.options.zIndexOffset);shadowAnchor=this.options.shadowAnchor,labelAnchor=this.options.labelAnchor,this._markerTarget&&(this._updateImg(),this._markerTarget.style.marginLeft=-d.x+"px",this._markerTarget.style.marginTop=-d.y+"px",this._markerTarget.style.width=a.x+"px",this._markerTarget.style.height=a.y+"px",this._markerTarget.style.zIndex=f,this._markerTarget.title=e?e:""),this._shadow&&(this._updateShadowImg(),shadowAnchor&&(this._shadow.style.marginLeft=-shadowAnchor.x+"px",this._shadow.style.marginTop=-shadowAnchor.y+"px"),b&&(this._shadow.style.width=b.x+"px",this._shadow.style.height=b.y+"px"));if(this._label){labelAnchor&&(this._label.style.marginLeft=-labelAnchor.x+"px",this._label.style.marginTop=-labelAnchor.y+"px"),c&&(this._label.style.width=c.x+"px",this._label.style.height=c.y+"px");if(this.options.labeClass&&this.options.labeClass instanceof Object){var g=this.options.labeClass;for(var h in g)this._label.style[h]=g[h]}}},_update:function(a){a&&this._updateMarker();var b=this._map._pointToAbsPixel(this._latlng).round();L.Util.setPosition(this._markerTarget,b),this._shadow&&L.Util.setPosition(this._shadow,b),this._label&&L.Util.setPosition(this._label,b)},_initInteraction:function(){if(this.options.clickable){this._markerTarget.className+=" leaflet-clickable",L.DomEvent.addListener(this._markerTarget,"click",this._onMouseClick,this);var a=["dblclick","mousedown","mouseover","mouseout"];for(var b=0;b<a.length;b++)L.DomEvent.addListener(this._markerTarget,a[b],this._fireMouseEvent,this);L.DomEvent.addListener(this._markerTarget,"contextmenu",this._showContextmenu,this)}this.options.popable&&this.enablePop(),this.options.draggable&&this.enableDrag()},_showContextmenu:function(a){if(!this._map||this._map.getHegemonTag())return;this.fire(a.type,{originalEvent:a,marker:this}),this.fire("rightclick",{originalEvent:a,marker:this}),L.DomEvent.stopPropagation(a),L.DomEvent.preventDefault(a)},_onMouseClick:function(a){if(this._map.getHegemonTag())return;L.DomEvent.stopPropagation(a);if(this.dragging&&this.dragging.moved())return;this.fire(a.type,{originalEvent:a,marker:this})},_fireMouseEvent:function(a){if(!this._map||this._map.getHegemonTag())return;this.fire(a.type,a),L.DomEvent.stopPropagation(a)}}),L.Ols.MarkerOptions={imgUrl:L.Icon.Default.imagePath+"marker.png",visible:!0,shadowUrl:L.Icon.Default.imagePath+"marker-shadow.png",markerSize
:new L.Loc(25,41),shadowSize:new L.Loc(41,41),labelSize:new L.Loc(50,50),markerAnchor:new L.Loc(13,41),shadowAnchor:new L.Loc(13,41),popupAnchor:new L.Loc(0,-33),labelAnchor:new L.Loc(0,-33),markerTitle:"",assignId:"",popable:!0,labelable:!1,labelContent:"",labelLineCharCount:6,clickable:!0,draggable:!1,labeClass:{backgroundColor:"#ffffe1",border:"#8c8c8c 1px solid",fontSize:"12px",fontFamily:"",color:"#4d4d4d"},zIndexOffset:0},L.Ols.BgMarker=L.Ols.Marker.extend({initialize:function(a,b){this.options=L.Util.extend({},L.Ols.BgMarkerOptions,b),this._latlng=a},_createMarkerTarget:function(){var a=L.Util.create("div","leaflet-marker-div");return a},_updateMarker:function(){var a=this.options.imgOffset,b=this.options.markerSize,c=this.options.shadowSize,d=this.options.labelSize,e=this.options.markerAnchor,f=this.options.markerTitle,g=isNaN(this.options.zIndexOffset)?0:Math.round(this.options.zIndexOffset);shadowAnchor=this.options.shadowAnchor,labelAnchor=this.options.labelAnchor,this._markerTarget&&(this._markerTarget.style.marginLeft=-e.x+"px",this._markerTarget.style.marginTop=-e.y+"px",this._markerTarget.style.width=b.x+"px",this._markerTarget.style.height=b.y+"px",this._markerTarget.style.backgroundImage="url("+this.options.imgUrl+")",a&&(this._markerTarget.style.backgroundPosition=-a.x+"px "+ -a.y+"px"),this._markerTarget.style.zIndex=g,this._markerTarget.title=this.options.markerTitle),this._shadow&&(shadowAnchor&&(this._shadow.style.marginLeft=-shadowAnchor.x+"px",this._shadow.style.marginTop=-shadowAnchor.y+"px"),c&&(this._shadow.style.width=c.x+"px",this._shadow.style.height=c.y+"px"));if(this._label){labelAnchor&&(this._label.style.marginLeft=-labelAnchor.x+"px",this._label.style.marginTop=-labelAnchor.y+"px"),d&&(this._label.style.width=d.x+"px",this._label.style.height=d.y+"px");if(this.options.labeClass&&this.options.labeClass instanceof Object){var h=this.options.labeClass;for(var i in h)this._label.style[i]=h[i]}}}}),L.Ols.BgMarkerOptions={imgUrl:L.Icon.Default.imagePath+"spotmkrs.png",shadowUrl:"",markerSize:new L.Loc(26,16),shadowSize:new L.Loc(27,18),imgOffset:new L.Loc(164,61),visible:!0,markerAnchor:new L.Loc(13,8),shadowAnchor:new L.Loc(9,18),popupAnchor:new L.Loc(0,-8),markerTitle:"",popable:!0,clickable:!0,draggable:!1,zIndexOffset:0},L.Ols.CoordsImg=L.Ols.Base.extend({includes:L.Mixin.Events,initialize:function(a,b){this._url=a,this._bounds=b},getBounds:function(){return this._bounds?this._bounds:null},_setMap:function(a){this._map=a,this._image||this._initMarker(),a._panes.overlayPane.appendChild(this._image),a.on("viewreset",this._update,this),this._update()},_unsetMap:function(a){a=a||this._map,a._panes.overlayPane.removeChild(this._image),a.off("viewreset",this._update,this),this._map=null},_initMarker:function(){this._image=L.Util.create("img","leaflet-bound-image"),this._image.style.visibility="hidden",L.Util.extend(this._image,{galleryimg:"no",onselectstart:L.Util.falseFn,onmousemove:L.Util.falseFn,onload:L.Util.bind(this._onImageLoad,this),src:this._url})},_update:function(){if(!this._image)return;var a=this._image,b=this._map._pointToAbsPixel(new L.Loc(this._bounds.minX,this._bounds.maxY)),c=this._map._pointToAbsPixel(new L.Loc(this._bounds.maxX,this._bounds.minY)).subtract(b);L.Util.setPosition(a,b),a.style.width=c.x+"px",a.style.height=c.y+"px"},_onImageLoad:function(){this._image.style.visibility="",this.fire("load")}}),L.Ols.FeatureBase=L.Class.extend({includes:L.Mixin.Events,_type:"L.Ols.FeatureBase",statics:{CLIP_PADDING:.5},_visible:!0,options:{stroke:!0,color:"#0033ff",weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,editable:!1,clickable:!0},initialize:function(a){L.Util.setOptions(this,a)},_setMap:function(a){this._map=a,this._initElements(),this._initEvents(),this.toAbsPixels(),this._updatePath(),a.on("viewreset",this.toAbsPixels,this).on("moveend",this._updatePath,this)},_unsetMap:function(a){a=a||this._map,this.disableEdit(),a._pathRoot.removeChild(this._container),a.off("viewreset",this.toAbsPixels,this).off("moveend",this._updatePath,this),this._map=null},toAbsPixels:function(){},getType:function(){return this._type},getMap:function(){return this._map||null},getVisible:function(){return this._visible},setVisible:function(a){a=a?!0:!1;if(this._visible===a)return;this._visible=a;var b=a?"block":"none";this._container&&(this._container.style.display=b),this._label&&(this._label._element.style.display=b)},getStyle:function(){var a={},b,c=this._getStyleObjects();if(!c)return null;for(b in this.options)c.hasOwnProperty(b)&&(a[b]=this.options[b]);return a},setStyle:function(a){if(!a)return;this.options=this.options||{};var b,c=this._getStyleObjects();if(!c)return this;for(b in a)c.hasOwnProperty(b)&&(this.options[b]=a[b]);return this._container&&this._updateStyle(),this},getBounds:function(){return null},redraw:function(){return this._map&&(this.toAbsPixels(),this._updatePath()),this},_getStyleObjects:function(){var a=this._getStyleOptionsClass();if(!a)return null;var b=L.Util.extend({},a),c=["editable","clickable","draggable"],d;for(var e=0,f=c.length;e<f;e++)d=c[e],b.hasOwnProperty(d)&&delete b[d];return b},_getPathContainer:function(){if(this._container)return this._container},_getStyleOptionsClass:function(){return null}}),L.Ols.FeatureBase.SVG_NS="http://www.w3.org/2000/svg",L.Ols.FeatureBase=L.Ols.FeatureBase.extend({statics:{SVG:L.Util.Browser.svg},getPathString:function(){},_createElement:function(a){return document.createElementNS(L.Ols.FeatureBase.SVG_NS,a)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this._container.appendChild(this._path),this._map._pathRoot.appendChild(this._container);var a=this.getVisible(),b=a?"block":"none";this._container.style.display=b},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.strokeColor),this._path.setAttribute("stroke-opacity",this.options.strokeOpacity),this._path.setAttribute("stroke-width",this.options.strokeWidth),this._path.setAttribute("stroke-dasharray",this._dashStyle(this.options,1))):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_dashStyle:function(a,b){var c=a.strokeWidth*b,d=a.strokeStyle;switch(d){case"solid":return"none";case"dot":return[1,4*c].join();case"dash":return[4*c,4*c].join();case"dashdot":return[4*c,4*c,1,4*c].join();case"longdash":return[8*c,4*c].join();case"longdashdot":return[8*c,4*c,1,4*c].join();default:return"none"}},_updatePath:function(){var a=this.getPathString();a||(a="M0 0"),this._path.setAttribute("d",a)},_initEvents:function(){if(!this._container)return;this._path&&!L.Util.Browser.vml&&this._path.setAttribute("class","leaflet-clickable"),L.DomEvent.addListener(this._container,"click",this._onMouseClick,this);var a=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"];for(var b=0;b<a.length;b++)L.DomEvent.addListener(this._container,a[b],this._fireMouseEvent,this);L.DomEvent.addListener(this._container,"mouseover",this._onMouseOver,this),L.DomEvent.addListener(this._container,"mouseout",this._onMouseOut,this),this._map&&this._map.on("click",this.setEditStatus,this)},setEditStatus:function(a){var b=a===!0?!0:!1;this._editHandler&&b!=this._editHandler._enabled&&(b?(this._editHandler.enable(),this.fire("selected",{feature:this})):(this._editHandler.disable(),this.fire("unselected",{feature:this})))},enableEdit:function(){var a=this._getEditClass();a&&(L.Util.setOptions(this,{editable:!0,clickable:!0}),this._initEvents(),this._editHandler||(this._editHandler=new a(this)),this.fire("editenabled",{feature:this}),this.setEditStatus(!0))},disableEdit:function(){L.Util.setOptions(this,{editable:!1});var a=this._getEditClass();a&&this.setEditStatus(!1),this.fire("editdisabled",{feature:this})},_getEditClass:function(){return null},_onMouseClick:function(a){if(this._map.checkDraging())return;this.options.editable&&this.enableEdit(),a.type==="contextmenu"&&L.DomEvent.preventDefault(a),this._fireMouseEvent(a)},_onMouseOver:function(a){L.Util.Browser.vml&&L.Util.addClass(this._container,"leaflet-top-zindex")},_onMouseOut:function(a){L.Util.Browser.vml&&L.Util.removeClass(this._container,"leaflet-top-zindex")},_fireMouseEvent:function(a){if(!this._map||this._map.getHegemonTag())return;if(!this.has(a.type)){if(a.type=="click"||a.type=="mouseover")this.options.editable&&L.DomEvent.stopPropagation(a),L.DomEvent.preventDefault(a);return}var b=this._map,c=L.DomEvent.getMousePosition(a,b._container),d=b._pixelToAbsPixel(c),e=b.pixelToPoint(c);this.fire(a.type,{point:e,absPixel:d,pixel:c,originalEvent:a,feature:this}),L.DomEvent.stopPropagation(a),L.DomEvent.preventDefault(a)}}),L.Ols.FeatureBase=L.Util.Browser.svg||!L.Util.Browser.vml?L.Ols.FeatureBase:L.Ols.FeatureBase.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<lvml:"+a+' class="lvml">')}}catch(a){return function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var a=this._container=this._createElement("shape");a.className+=" leaflet-vml-shape"+(this.options.clickable?" leaflet-clickable":""),a.coordsize="1 1",this._path=this._createElement("path"),a.appendChild(this._path),this._map._pathRoot.appendChild(a)},_initStyle:function(){var a=this._container,b,c;this.options.stroke&&(b=this._stroke=this._createElement("stroke"),b.endcap="round",a.appendChild(b)),this.options.fill&&(c=this._fill=this._createElement("fill"),a.appendChild(c)),this._updateStyle()},_updateStyle:function(){var a=this._stroke,b=this._fill,c=this.options,d=this._container;d.stroked=c.stroke,d.filled=c.fill,c.stroke&&(a.weight=c.strokeWidth+"px",a.color=c.strokeColor,a.opacity=c.strokeOpacity,a.dashstyle=c.strokeStyle),c.fill&&(b.color=c.fillColor||c.color,b.opacity=c.fillOpacity)},_updatePath:function(){var a=this._container.style,b=this.getVisible(),c=b?"block":"none";a.display="none",this._path.v=this.getPathString()+" ",a.display=c}}),L.Ols.FeatureBase=L.Ols.FeatureBase.SVG&&!window.L_PREFER_CANVAS||!L.Util.Browser.canvas?L.Ols.FeatureBase:L.Ols.FeatureBase.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.toAbsPixels(),this._requestUpdate()),this},_requestUpdate:function(){this._map&&(this._map.fire("moveend"),this._fireMapMoveEndTimer&&clearTimeout(this._fireMapMoveEndTimer),this._fireMapMoveEndTimer=setTimeout(this._fireMapMoveEnd(this._map),17))},_fireMapMoveEnd:function(a){var b=a;return function(){b.fire("moveend")}},_unsetMap:function(a){a.off("viewreset",this.toAbsPixels,this).off("moveend",this._updatePath,this),this._requestUpdate(),this._map=null},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var a=this.options;a.stroke&&(this._ctx.lineWidth=a.strokeWidth,this._ctx.strokeStyle=a.strokeColor||a.color),a.fill&&(this._ctx.fillStyle=a.fillColor||a.color)},_drawPath:function(){var a,b,c,d,e,f;this._ctx.beginPath();for(a=0,c=this._parts.length;a<c;a++){for(b=0,d=this._parts[a].length;b<d;b++)e=this._parts[a][b],f=(b===0?"move":"line")+"To",this._ctx[f](e.x,e.y);this instanceof L.Ols.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(this._checkIfEmpty())return;var a=this._ctx,b=this.options;this._drawPath(),a.save(),this._updateStyle(),b.fill&&(b.fillOpacity<1&&(a.globalAlpha=b.fillOpacity),a.fill()),b.stroke&&(b.strokeOpacity<1&&(a.globalAlpha=b.strokeOpacity),a.stroke()),a.restore()},_initEvents:function(){this.options.clickable&&this._map&&this._map.on("click",this._onClick,this)},_onClick:function(a){this._containsPoint(a.absPixel)&&this.fire("click",{originalEvent:a,feature:this})},onRemove:function(a){a.off("viewreset",this.toAbsPixels,this).off("moveend",this._updatePath,this).fire("moveend")}}),L.Ols.FeatureBase.include(L.Popups.Base?{setDialog:function(a,b,c){b=b||L.Popups.Base;if(!this._popup||this._popup.options!==c)this._popup=new b(c,this);return this._popup.setContent(a),this._openDialogAdded||(this.on("click",this._openDialog,this),this._openDialogAdded=!0),this},unsetDialog:function(){return this._popup&&(this._popup=null,this.off("click",this._openDialog),this._openDialogAdded=!1),this},_openDialog:function(a){this._popup.setPosition(a.point),this._map.openDialog(this._popup)}}:{}),L.Map.include({_updatePathViewport:function(){var a=L.Ols.FeatureBase.CLIP_PADDING,b=this.getSize(),c=L.Util.getPosition(this._mapPane),d=c.multiplyBy(-1)._subtract(b.multiplyBy(a)),e=d.add(b.multiplyBy(1+a*2));this._pathViewport=new L.Extent(d,e)}}),L.Map.include(L.Util.Browser.svg?{_initPathRoot:function(){this._pathRoot||(this._pathRoot=L.Ols.FeatureBase.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_updateSvgViewport:function(){this._updatePathViewport();var a=this._pathViewport,b=new L.Loc(a.minX,a.minY),c=new L.Loc(a.maxX,a.maxY),d=c.x-b.x,e=c.y-b.y,f=this._pathRoot,g=this._panes.overlayPane;L.Util.Browser.webkit&&g.removeChild(f),L.Util.setPosition(f,b),f.setAttribute("width",d),f.setAttribute("height",e),f.setAttribute("viewBox",[b.x,b.y,d,e].join(" ")),L.Util.Browser.webkit&&g.appendChild(f)}}:{}),L.Map.include(L.Util.Browser.svg||!L.Util.Browser.vml?{}:{_initPathRoot:function(){if(this._pathRoot)return;var a=this._pathRoot=document.createElement("div");a.className="leaflet-vml-container",this._panes.overlayPane.appendChild(a),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}),L.Map.include(L.Ols.FeatureBase.SVG&&!window.L_PREFER_CANVAS||!L.Util.Browser.canvas?{}:{_initPathRoot:function(){var a=this._pathRoot,b;a||(a=this._pathRoot=document.createElement("canvas"),a.style.position="absolute",b=this._canvasCtx=a.getContext("2d"),b.lineCap="round",b.lineJoin="round",this._panes.overlayPane.appendChild(a),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){this._updatePathViewport();var a=this._pathViewport,b=a.getLowerPoint(),c=a.getUpperPoint().subtract(b),d=this._pathRoot;L.Util.setPosition(d,b),d.width=c.x,d.height=c.y,d.getContext("2d").translate(-b.x,-b.y)}}),L.Ols.Line=L.Ols.FeatureBase.extend({_type:"L.Ols.Line",options:{smoothFactor:1,noClip:!1},initialize:function(a,b){this.options=L.Util.extend({},L.Ols.LineOptions,b),this._points=a||[]},toAbsPixels:function(){this._absPixels=[];if(this._points)for(var a=0,b=this._points.length;a<b;a++)this._absPixels[a]=this._map._pointToAbsPixel(this._points[a])},getPathString:function(){for(var a=0,b=this._parts.length,c="";a<b;a++)c+=this._getPathPartStr(this._parts[a]);return c},measureLength:function(a,b){var c=0;if(this._points.length===0)return c;var d=1,e=this._points.length,f;do f=L.Util.getDistByUnits(this._points[d-1],this._points[d],a,b),c=f+c,d++;while(d<e);return c},getPoints:function(){return this._points},setPoints:function(a){return this._points=a,this.redraw()},setPointAt:function(a,b){this._points&&this._points.length>a&&b&&b instanceof L.Loc&&(this._points[a]=b,this.redraw())},addPoint:function(a){return this._points.push(a),this.redraw()},removePoints:function(a,b){var c=[].splice.apply(this._points,arguments);return this.redraw(),c},closestLayerPoint:function(a){var b=Infinity,c=this._parts,d,e,f=null;for(var g=0,h=c.length;g<h;g++){var i=c[g];for(var j=1,k=i.length;j<k;j++){d=i[j-1],e=i[j];var l=L.Util.LineUtil._sqClosestPointOnSegment(a,d,e);l._sqDist<b&&(b=l._sqDist,f=l)}}return f&&(f.distance=Math.sqrt(b)),f},getBounds:function(){var a=null,b=this.getPoints();if(!b)return null;for(var c=0,d=b.length;c<d;c++)c==0&&(a=new L.Extent(b[0].x,b[0].y,b[0].x,b[0].y)),a.extend(b[c]);return a},getStrokeColor:function(){return this.options.strokeColor},setStrokeColor:function(a){this.setStyle({strokeColor:a})},getStrokeOpacity:function(){return this.options.strokeOpacity},setStrokeOpacity:function(a){this.setStyle({strokeOpacity:a})},getStrokeWidth:function(){return this.options.strokeWidth},setStrokeWidth:function(a){this.setStyle({strokeWidth:a})},getStrokeStyle:function(){return this.options.strokeStyle},setStrokeStyle:function(a){this.setStyle({strokeStyle:a})},_getStyleOptionsClass:function(){return L.Ols.LineOptions},_getEditClass:function(){return L.Ols.Line.Edit},_initEvents:function(){L.Ols.FeatureBase.prototype._initEvents.call(this)},_getPathPartStr:function(a){var b=L.Ols.FeatureBase.VML;for(var c=0,d=a.length,e="",f;c<d;c++)f=a[c],b&&f._round(),e+=(c?"L":"M")+f.x+" "+f.y;return e},_clipPoints:function(){var a=this._absPixels,b=a.length,c,d,e;if(this.options.noClip){this._parts=[a];return}this._parts=[];var f=this._parts,g=this._map._pathViewport,h=L.Util.LineUtil;for(c=0,d=0;c<b-1;c++){e=h.clipSegment(a[c],a[c+1],g,c);if(!e)continue;f[d]=f[d]||[],f[d].push(e[0]);if(e[1]!==a[c+1]||c===b-2)f[d].push(e[1]),d++}},_simplifyPoints:function(){var a=this._parts,b=L.Util.LineUtil;for(var c=0,d=a.length;c<d;c++)a[c]=b.simplify(a[c],this.options.smoothFactor)},setLabel:function(a,b){this._label||(this._label=new L.Ols.Label(null,b)),this._label.setContent(a),this._updatePath()},_unsetMap:function(){this._label&&this._map&&this._map.removeOverlays(this._label),L.Ols.FeatureBase.prototype._unsetMap.call(this)},_updatePath:function(){this._clipPoints(),this._simplifyPoints(),L.Ols.FeatureBase.prototype._updatePath.call(this);if(this._label&&this._map){if(this._parts[0]){var a=this._parts[0].length;if(a>=2){var b=Math.floor(a/2),c=b-1,d=new L.Loc((this._parts[0][c].x+this._parts[0][b].x)/2,(this._parts[0][c].y+this._parts[0][b].y)/2);d._round();var e=this._map._absPixelToPoint(d);this._label._latlng=e}}this._map.hasOverlay(this._label)&&this._map.removeOverlays(this._label),this._map.addOverlays(this._label)}}}),L.Ols.Line.include(L.Ols.FeatureBase.CANVAS?{_containsPoint:function(a,b){var c,d,e,f,g,h,i,j=this.options.strokeWidth/2;L.Util.Browser.touch&&(j+=10);for(c=0,f=this._parts.length;c<f;c++){i=this._parts[c];for(d=0,g=i.length,e=g-1;d<g;e=d++){if(!b&&d===0)continue;h=L.Util.LineUtil.pointToSegmentDistance(a,i[e],i[d]);if(h<=j)return!0}}return!1}}:{}),L.Ols.LineOptions={stroke:!0,strokeColor:"#0033ff",strokeWidth:3,strokeOpacity:.6,strokeStyle:"solid",editable:!1,clickable:!0,labelable:!1,labelAnchor:new L.Loc(8,0),labelContent:""},L.Ols.Polygon=L.Ols.Line.extend({options:{fill:!0},_type:"L.Ols.Polygon",initialize:function(a,b){this.options=L.Util.extend({},L.Ols.PolygonOptions,b),this._points=a||[],a&&a[0]instanceof Array&&(this._points=a[0],this._holes=a.slice(1))},toAbsPixels:function(){L.Ols.Line.prototype.toAbsPixels.call(this),this._holePoints=[];if(!this._holes)return;for(var a=0,b=this._holes.length,c;a<b;a++){this._holePoints[a]=[];for(var d=0,e=this._holes[a].length;d<e;d++)this._holePoints[a][d]=this._map._pointToAbsPixel(this._holes[a][d])}},measureArea:function(a,b){var c=a;!a&&this._map&&(c=this._map.getUnits());var d=L.Util.getAreaByUnits(this._points,c,b);return d},getStrokeColor:function(){return this.options.strokeColor},setStrokeColor:function(a){this.setStyle({strokeColor:a})},getStrokeOpacity:function(){return this.options.strokeOpacity},setStrokeOpacity:function(a){this.setStyle({strokeOpacity:a})},getStrokeWidth:function(){return this.options.strokeWidth},setStrokeWidth:function(a){this.setStyle({strokeWidth:a})},getStrokeStyle:function(){return this.options.strokeStyle},setStrokeStyle:function(a){this.setStyle({strokeStyle:a})},getFillColor:function(){return this.options.fillColor},setFillColor:function(a){this.setStyle({fillColor:a})},getFillOpacity:function(){return this.options.fillOpacity},setFillOpacity:function(a){this.setStyle({fillOpacity:a})},_clipPoints:function(){var a=this._absPixels,b=[];this._parts=[a].concat(this._holePoints);if(this.options.noClip)return;for(var c=0,d=this._parts.length;c<d;c++){var e=L.Util.PolyUtil.clipPolygon(this._parts[c],this._map._pathViewport);if(!e.length)continue;b.push(e)}this._parts=b},_getEditClass:function(){return L.Ols.Polygon.Edit},_getStyleOptionsClass:function(){return L.Ols.PolygonOptions},_getPathPartStr:function(a){var b=L.Ols.Line.prototype._getPathPartStr.call(this,a);return b+(L.Util.Browser.svg?"z":"x")}}),L.Ols.Polygon.include(L.Ols.FeatureBase.CANVAS?{contains:function(a){return this._containsPoint(a)},_containsPoint:function(a){var b=!1,c,d,e,f,g,h,i,j;if(L.Ols.Line.prototype._containsPoint.call(this,a,!0))return!0;for(f=0,i=this._parts.length;f<i;f++){c=this._parts[f];for(g=0,j=c.length,h=j-1;g<j;h=g++)d=c[g],e=c[h],d.y>a.y!=e.y>a.y&&a.x<(e.x-d.x)*(a.y-d.y)/(e.y-d.y)+d.x&&(b=!b)}return b}}:{}),L.Ols.PolygonOptions={stroke:!0,fill:!0,strokeColor:"#0033ff",strokeWidth:3,strokeOpacity:.6,strokeStyle:"solid",fillColor:"#0033ff",fillOpacity:.5,editable:!1,clickable:!0},L.Ols.Rect=L.Ols.Polygon.extend({initialize:function(a,b){this._bounds=a,L.Ols.Polygon.prototype.initialize.call(this,this._boundsToPoints(this._bounds),b)},setBounds:function(a){this._bounds=a,this.setPoints(this._boundsToPoints(a))},_getEditClass:function(){return L.Ols.Rect.Edit},_boundsToPoints:function(a){return a=a||this.getBounds(),a?[new L.Loc(a.minX,a.minY),new L.Loc(a.minX,a.maxY),new L.Loc(a.maxX,a.maxY),new L.Loc(a.maxX,a.minY)]:null}}),L.Ols.Circle=L.Ols.FeatureBase.extend({options:{fill:!0},_type:"L.Ols.Circle",initialize:function(a,b,c){this.options=L.Util.extend({},L.Ols.PolygonOptions,c),this._latlng=a,this._mRadius=b},measureArea:function(){var a=Math.PI*this._mRadius*this._mRadius;return a},getPosition:function(){return this._latlng},setPosition:function(a){return this._latlng=a,this.redraw()},getRadius:function(a){return a?this._mRadius:this._getFitRadius(a)},setRadius:function(a,b){if(!a)return;return this._mRadius=a,b&&b!=="m"&&L.Util.INCHES_PER_UNIT[b]&&(this._mRadius=this._mRadius*L.Util.INCHES_PER_UNIT[b]/L.Util.INCHES_PER_UNIT.m),this.redraw()},getStrokeColor:function(){return this.options.strokeColor},setStrokeColor:function(a){this.setStyle({strokeColor:a})},getStrokeOpacity:function(){return this.options.strokeOpacity},setStrokeOpacity:function(a){this.setStyle({strokeOpacity:a})},getStrokeWidth:function(){return this.options.strokeWidth},setStrokeWidth:function(a){this.setStyle({strokeWidth:a})},getStrokeStyle:function(){return this.options.strokeStyle},setStrokeStyle:function(a){this.setStyle({strokeStyle:a})},getFillColor:function(){return this.options.fillColor},setFillColor:function(a){this.setStyle({fillColor:a})},getFillOpacity:function(){return this.options.fillOpacity},setFillOpacity:function(a){this.setStyle({fillOpacity:a})},toAbsPixels:function(){var a=this._getFitRadius(),b=new L.Loc(this._latlng.x,this._latlng.y-a),c=this._map._pointToAbsPixel(b);this._point=this._map._pointToAbsPixel(this._latlng),this._radius=Math.round(Math.abs(this._point.y-c.y))},getBounds:function(){var a=this._getFitRadius();return new L.Extent(this._latlng.x-a,this._latlng.y-a,this._latlng.x+a,this._latlng.y+a)},getPathString:function(){var a=this._point,b=this._radius;return this._checkIfEmpty()?"":L.Util.Browser.svg?"M"+a.x+","+(a.y-b)+"A"+b+","+b+",0,1,1,"+(a.x-.1)+","+(a.y-b)+" z":(a._round(),b=Math.round(b),"AL "+a.x+","+a.y+" "+b+","+b+" 0,"+23592600)},_getStyleOptionsClass:function(){return L.Ols.PolygonOptions},_getFitRadius:function(a){if(!this._map)return this._mRadius;a=a||this._map.getUnits();var b=this._mRadius;return b*L.Util.INCHES_PER_UNIT.m/L.Util.INCHES_PER_UNIT[a]},_checkIfEmpty:function(){var a=this._map._pathViewport,b=this._radius,c=this._point;return c.x-b>a.maxX||c.y-b>a.maxY||c.x+b<a.minX||c.y+b<a.minY},_getEditClass:function(){return L.Ols.Circle.Edit}}),L.Ols.Circle.include(L.Ols.FeatureBase.CANVAS?{_drawPath:function(){var a=this._point;this._ctx.beginPath(),this._ctx.arc(a.x,a.y,this._radius,0,Math.PI*2,!1)},_containsPoint:function(a){var b=this._point,c=this.options.stroke?this.options.strokeWidth/2:0;return a.distanceTo(b)<=this._radius+c}}:{}),L.Ols.Point=L.Ols.Circle.extend({options:{radius:5,strokeWidth:2},_type:"L.Ols.Point",initialize:function(a,b){this.options=L.Util.extend(this.options,L.Ols.PolygonOptions,b),this._radius=this.options.radius,L.Ols.Circle.prototype.initialize.call(this,a,0,b)},toAbsPixels:function(){this._point=this._map._pointToAbsPixel(this._latlng)},getRadius:function(){return this._radius},setRadius:function(a){return this._radius=a,this.redraw()},_getEditClass:function(){return L.Ols.Point.Edit}}),L.Ols.Spot=L.Class.extend({options:{text:"",buffer:5,minRes:null,maxRes:null,data:null,img:{imgUrl:L.Icon.Default.imagePath+"pock.png",offset:new L.Loc(5,5),size:new L.Loc(12,12)},marker:{imgUrl:L.Icon.Default.imagePath+"pock.png",markerAnchor:new L.Loc(5,5),markerSize:new L.Loc(12,12)},label:{content:"",offset:new L.Loc(10,10),popable:!1,zIndexOffset:65535,clickable:!1,draggable:!1},imgable:!0,labelable:!0,popupAnchor:new L.Loc(0,5)},initialize:function(a,b){this._latlng=a,this._options={};for(var c in b)c=="img"||c=="label"||c=="marker"?b.hasOwnProperty(c)&&(this._options[c]=L.Util.extend({},this.options[c],b[c])):this._options[c]=b[c];this._options=L.Util.extend({},this.options,this._options)},getBounds:function(){var a=null;return this._latlng?new L.Extent(this._latlng.x,this._latlng.y,this._latlng.x,this._latlng.y):null},getText:function(){return this.options.text},setText:function(a){this.options.text=a},getPosition:function(){return this._latlng},checkValid:function(a,b){var c=this._getPointBounds(b);return c.contains(a)},_getPointBounds:function(a){if(typeof this.options.buffer=="number"){var b=this.buffer*a;return new L.Extent(this._latlng.x-b,this._latlng.y-b,this._latlng.x+b,this._latlng.y+b)}return new L.Extent(this._latlng.x-this.buffer.minX*a,this._latlng.y-this.buffer.minY*a,this._latlng.x+this.buffer.maxX*a,this._latlng.y+this.buffer.maxY*a)},_getWidth:function(a){return this.buffer.getWidth()*a},_getHeight:function(a){return this.buffer.getHeight()*a},setPosition:function(a){this._latlng=a},setData:function(a){this.data=a},getData:function(a){return this.data},_setMap:function(a){this._map=a},setDialog:function(a,b,c){return c=L.Util.extend({pixelOffset:this.options.popupAnchor},c),b=b||L.Popups.Base,this._popup=new b(c,this),!this._popup._map&&!this._popup._opened&&(this._popup.setPosition(this._latlng),this._popup.setContent(a),this._map.setSingleDialog(this._popup)),this._map.openSingleDialog(this._popup),this}}),L.HandlerBase=L.Class.extend({includes:L.Mixin.Events,initialize:function(a){this._map=a},enable:function(){if(this._enabled)return;this._enabled=!0,this.addHooks()},disable:function(){if(!this._enabled)return;this._enabled=!1,this.removeHooks()},enabled:function(){return!!this._enabled}}),L.Draggable=L.Class.extend({includes:L.Mixin.Events,statics:{START:L.Util.Browser.touch?"touchstart":"mousedown",END:L.Util.Browser.touch?"touchend":"mouseup",MOVE:L.Util.Browser.touch?"touchmove":"mousemove",TAP_TOLERANCE:15},initialize:function(a,b){this._element=a,this._dragStartTarget=b||a},enable:function(){if(this._enabled)return;L.DomEvent.addListener(this._dragStartTarget,L.Draggable.START,this._onDown,this),L.DomEvent.addListener(this._dragStartTarget,"click",this._onClick,this),this._enabled=!0},disable:function(){if(!this._enabled)return;L.DomEvent.removeListener(this._dragStartTarget,L.Draggable.START,this._onDown),L.DomEvent.removeListener(this._dragStartTarget,"click",this._onClick,this),this._enabled=!1,this._moved=!1},_onDown:function(a){if(!L.Util.Browser.touch&&a.shiftKey||a.which!==1&&a.button!==1&&!a.touches)return;this._simulateClick=!0;if(a.touches&&a.touches.length>1){this._simulateClick=!1;return}var b=a.touches&&a.touches.length===1?a.touches[0]:a,c=b.target;L.DomEvent.preventDefault(a),L.DomEvent.stopPropagation(a),L.Util.Browser.touch&&c.tagName.toLowerCase()==="a"&&(c.className+=" leaflet-active"),this.fire("predragstart",{pixel:L.DomEvent.getMousePosition(a,c)}),this._moved=!1;if(this._moving)return;L.Util.Browser.touch||(L.Util.disableTextSelection(),this._setMovingCursor()),this._startPos=this._newPos=L.Util.getPosition(this._element),this._startPoint=new L.Loc(b.clientX,b.clientY),L.DomEvent.addListener(document,L.Draggable.MOVE,this._onMove,this),L.DomEvent.addListener(document,L.Draggable.END,this._onUp,this)},_onClick:function(a){L.DomEvent.preventDefault(a),L.DomEvent.stopPropagation(a)},_onMove:function(a){if(a.touches&&a.touches.length>1)return;L.DomEvent.preventDefault(a);var b=a.touches&&a.touches.length===1?a.touches[0]:a;!this._moved&&b&&this._startPoint&&(b.clientX!=this._startPoint.x||b.clientY!=this._startPoint.y)&&(this.fire("dragstart",{pixel:L.Util.getPosition(this._element)}),this._moved=!0),this._moving=!0;var c=new L.Loc(b.clientX,b.clientY);this._newPos=this._startPos.add(c).subtract(this._startPoint),this._updatePosition(),L.DomEvent.stopPropagation(a)},_updatePosition:function(){this.fire("predrag",{pixel:L.Util.getPosition(this._element)}),L.Util.setPosition(this._element,this._newPos),this.fire("drag",{pixel:this._newPos})},_onUp:function(a){if(this._simulateClick&&a.changedTouches){var b=a.changedTouches[0],c=b.target,d=this._newPos&&this._newPos.distanceTo(this._startPos)||0;c.tagName.toLowerCase()==="a"&&(c.className=c.className.replace(" leaflet-active","")),d<L.Draggable.TAP_TOLERANCE&&this._simulateEvent("click",b)}L.Util.Browser.touch||(L.Util.enableTextSelection(),this._restoreCursor()),L.DomEvent.removeListener(document,L.Draggable.MOVE,this._onMove,this),L.DomEvent.removeListener(document,L.Draggable.END,this._onUp,this),this._moved&&this.fire("dragend",{pixel:L.Util.getPosition(this._element)}),this._moving=!1},_setMovingCursor:function(){document.body.className+=" leaflet-dragging"},_restoreCursor:function(){document.body.className=document.body.className.replace(/ leaflet-dragging/g,"")},_simulateEvent:function(a,b){var c=document.createEvent("MouseEvents");c.initMouseEvent(a,!0,!0,window,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null),b.target.dispatchEvent(c)}}),L.Map.Drag=L.HandlerBase.extend({_gragTag:!1,_element:null,_dragStartTarget:null,addHooks:function(){this._draggable||(this._element=this._map._mapPane,this._dragStartTarget=this._map._container,this.on("dragstart",this._onDragStart,this).on("predragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),this._draggable=!0);if(this._dragenabled)return;this._draggable&&(L.DomEvent.addListener(this._dragStartTarget,L.Draggable.START,this._onDown,this),L.DomEvent.addListener(this._dragStartTarget,"click",this._onClick,this),this._dragenabled=!0)},removeHooks:function(){if(!this._dragenabled)return;L.DomEvent.removeListener(this._dragStartTarget,L.Draggable.START,this._onDown),L.DomEvent.removeListener(this._dragStartTarget,"click",this._onClick,this),this._dragenabled=!1,this._moved=!1},_onDown:function(a){if(this._map._getAnimatingZoom()){this._gragTag=!1,L.DomEvent.stop(a);return}if(!L.Util.Browser.touch&&a.shiftKey||a.which!==1&&a.button!==1&&!a.touches)return;this._simulateClick=!0;if(a.touches&&a.touches.length>1){this._simulateClick=!1;return}var b=a.touches&&a.touches.length===1?a.touches[0]:a,c=b.target;L.DomEvent.preventDefault(a),L.DomEvent.stopPropagation(a),L.Util.Browser.touch&&c.tagName.toLowerCase()==="a"&&(c.className+=" leaflet-active"),this.fire("predragstart",{pixel:L.DomEvent.getMousePosition(a,c)}),this._moved=!1;if(this._moving)return;L.Util.Browser.touch||(L.Util.disableTextSelection(),this._setMovingCursor()),this._startPos=this._newPos=L.Util.getPosition(this._element),this._startPoint=new L.Loc(b.clientX,b.clientY),L.DomEvent.addListener(document,L.Draggable.MOVE,this._onMove,this),L.DomEvent.addListener(document,L.Draggable.END,this._onUp,this)},_onClick:function(a){L.DomEvent.preventDefault(a),L.DomEvent.stopPropagation(a)},_onMove:function(a){if(a.touches&&a.touches.length>1)return;var b=a.touches&&a.touches.length===1?a.touches[0]:a;!this._moved&&b&&this._startPoint&&(b.clientX!=this._startPoint.x||b.clientY!=this._startPoint.y)&&(this.fire("dragstart",{pixel:L.Util.getPosition(this._element)}),this._moved=!0),this._moving=!0;var c=new 
L.Loc(b.clientX,b.clientY);this._newPos=this._startPos.add(c).subtract(this._startPoint),this._updatePosition(),L.DomEvent.stopPropagation(a)},_updatePosition:function(){this.fire("predrag",{pixel:L.Util.getPosition(this._element)}),L.Util.setPosition(this._element,this._newPos),this.fire("drag",{pixel:this._newPos})},_onUp:function(a){if(this._simulateClick&&a.changedTouches){var b=a.changedTouches[0],c=b.target,d=this._newPos&&this._newPos.distanceTo(this._startPos)||0;c.tagName.toLowerCase()==="a"&&(c.className=c.className.replace(" leaflet-active","")),d<L.Draggable.TAP_TOLERANCE&&this._simulateEvent("click",b)}L.Util.Browser.touch||(L.Util.enableTextSelection(),this._restoreCursor()),L.DomEvent.removeListener(document,L.Draggable.MOVE,this._onMove,this),L.DomEvent.removeListener(document,L.Draggable.END,this._onUp,this),this._moved&&this.fire("dragend",{pixel:L.Util.getPosition(this._element)}),this._moving=!1},moved:function(){return this._moved},_setMovingCursor:function(){document.body.className+=" leaflet-dragging"},_restoreCursor:function(){document.body.className=document.body.className.replace(/ leaflet-dragging/g,"")},_simulateEvent:function(a,b){var c=document.createEvent("MouseEvents");c.initMouseEvent(a,!0,!0,window,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null),b.target.dispatchEvent(c)},_onDragStart:function(){if(this._map._getAnimatingZoom()){this._gragTag=!1;return}this._gragTag=!0;var a=this._map;a.fire("movestart").fire("dragstart"),a._panTransition&&a._panTransition._onTransitionEnd(!0),a.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(!this._gragTag)return;if(this._map.inertia){var a=this._lastTime=+(new Date),b=this._lastPos=this._newPos;this._positions=this._positions||[],this._positions.push(b),this._times.push(a),a-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("drag"),this._map.fire("move")},_onDragEnd:function(){if(!this._gragTag)return;var a=this._map,b=a.options,c=+(new Date)-this._lastTime,d=L.Util.Browser.ie;if(d)a.fire("moveend");else{var e=this._lastPos.subtract(this._positions[0]),f=(this._lastTime+c-this._times[0])/1e3,g=e.multiplyBy(.58/f),h=g.distanceTo(new L.Loc(0,0)),i=Math.min(b.inertiaMaxSpeed,h),j=g.multiplyBy(i/h),k=i/b.inertiaDeceleration,l=j.multiplyBy(-k).round();f=Math.max(.5,f);var m={duration:f,easing:"ease-out"};this._map.panBy(l,m)}a.fire("dragend")}}),L.Map.WheelZoom=L.HandlerBase.extend({addHooks:function(){L.DomEvent.addListener(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){L.DomEvent.removeListener(this._map._container,"mousewheel",this._onWheelScroll)},_onWheelScroll:function(a){var b=L.DomEvent.getWheelDelta(a);this._delta+=b,this._lastMousePos=L.DomEvent.getMousePosition(a,this._map._container),clearTimeout(this._timer),this._timer=setTimeout(L.Util.bind(this._performZoom,this),50),L.DomEvent.preventDefault(a)},_performZoom:function(){if(!this._map)return;if(this._map._getAnimatingZoom())return;this._iCenter=this._map._getCenter(),this._mCenter=this._map.pixelToPoint(this._lastMousePos);var a=this._map,b=Math.round(this._delta),c=a.getZoom();b=Math.max(Math.min(b,4),-4);var d=a.getZoomCount(),e=a.getZoom()+b;e=a._limitZoom(e),b=e-c,this._delta=0;if(!b)return;var f=a.getResByZoom(e)/a.getResolution(),g=this._mCenter.subtract(this._mCenter.subtract(this._iCenter).multiplyBy(f));a._zoomPos=this._lastMousePos;if(!a._zoomDirectionCtrl){var h=new L.Controls.Zoom;h._setMap(a)}a._zoomDirectionCtrl.enable(this._lastMousePos,b),a.setView(g,e)}}),L.Map.DrawFeatureHandler=L.HandlerBase.extend({options:{styleOptions:{stroke:!0,strokeColor:"#ff0000",strokeWidth:2,strokeOpacity:.8,fill:!0,fillColor:"#FFFFFF",fillOpacity:1,editable:!0,clickable:!0}},_getStyleOptions:function(){this.options.styleOptions=this.options.styleOptions||{};var a=L.Util.extend({},this.options.styleOptions);return a=L.Util.extend(a,{editable:!1,clickable:!1,draggable:!1}),a},_getLineStyleOptions:function(){var a=this._getStyleOptions();return a=L.Util.extend(a,{fill:!1}),a},setHandlerOptions:function(a){this.options=this.options||{},a&&L.Util.extend(this.options,a),this.options.styleOptions=this.options.styleOptions||{},this.options.styleOptions=L.Util.extend(this.options.styleOptions,this.getStyleOptionClass(),a)},getStyleOptionClass:function(){return L.Util.extend(this._getStyleOptionClass(),{editable:!0})},_getStyleOptionClass:function(){return L.Util.extend({},L.Ols.PolygonOptions)}}),L.Map.DrawPoint=L.Map.DrawFeatureHandler.extend({options:{styleOptions:{radius:5}},addHooks:function(){this._map.on("click",this._onMapClick,this)},removeHooks:function(){this._map.off("click",this._onMapClick)},_onMapClick:function(a){this.feature=new L.Ols.Point(a.point,this._getStyleOptions()),this._map.addOverlays(this.feature),this._map.fire("drawfeatureend",{feature:this.feature})},_getStyleOptions:function(){this.options.styleOptions=this.options.styleOptions||{};var a=L.Util.extend({},this.options.styleOptions);return a}}),L.Map.DrawLine=L.Map.DrawFeatureHandler.extend({options:{styleOptions:{stroke:!0,strokeColor:"#ff0000",strokeWidth:2,strokeOpacity:.8,fill:!1,fillColor:"#FFFFFF",fillOpacity:1,editable:!0,clickable:!0,labelable:!1,labelAnchor:new L.Loc(8,0),labelContent:"",labelLineCharCount:6}},addHooks:function(){this._map.on("click",this._onMapClick,this),this._map.on("mousemove",this._onMouseMove,this),this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("click",this._onMapClick),this._map.off("mousemove",this._onMouseMove),this._map.off("dblclick",this._onDoubleClick),this._endDrawn(),this._drawnFeature=null},_endDrawn:function(){this._startPoint=null,delete this._startPoint,this._endPoint&&(this._endPoint=null,delete this._endPoint),this._label&&(this._label=null),this._tmpFeature&&(this._map&&this._map.removeOverlays(this._tmpFeature),this._tmpFeature=null,delete this._tmpFeature),this._drawnFeature&&(this.options.styleOptions&&this.options.styleOptions.editable&&this._drawnFeature.enableEdit(),this._map&&this._map.fire("drawfeatureend",{feature:this._drawnFeature}))},_onMapClick:function(a){this._drawnFeature?this._drawnFeature.addPoint(a.point):this._startPoint?(this._drawnFeature=new L.Ols.Line([this._startPoint,a.point],this._getStyleOptions()),L.Util.stamp(this._drawnFeature),this._map.addOverlays(this._drawnFeature)):this._map.fire("drawfeaturestart"),this._startPoint=a.point,this.fire("addpoint",a)},_onMouseMove:function(a){if(!this._startPoint)return;if(L.Util.Browser.touch||L.Util.Browser.android)return;this._tmpFeature?this._tmpFeature.setPoints([this._startPoint,a.point]):(this._tmpFeature=new L.Ols.Line([this._startPoint,a.point],this._getStyleOptions()),L.Util.stamp(this._tmpFeature),this._map.addOverlays(this._tmpFeature)),this.fire("movepoint",a)},_onDoubleClick:function(a){if(this._drawnFeature){var b=this._drawnFeature.getPoints();if(b){var c=b.length;c>3&&b[c-1].equals(b[c-2])&&this._drawnFeature.removePoints(c-1,1);if(this.options.styleOptions.labelable&&this.options.styleOptions.labelContent!=""&&c>=2&&!this._label){var d="leaflet-label",e=Math.floor(c/2),f=e-1,g=new L.Loc((b[e].x+b[f].x)/2,(b[e].y+b[f].y)/2);g._round();var h=this.options.styleOptions.labelLineCharCount||1e3,i=this.options.styleOptions.labelContent.length>h?h:this.options.styleOptions.labelContent.length,j="";for(var k=0;k<this.options.styleOptions.labelContent.length;k++)k%h==0&&k!=0&&(j+="<br/>"),j+=this.options.styleOptions.labelContent[k];this._label=new L.Ols.Label(g,{offset:this.options.styleOptions.labelAnchor,content:j,clickable:!1}),this._map.addOverlays(this._label),this._drawnFeature._label=this._label,this._label.addClass(d)}}}this._endDrawn(),this.fire("endpoint",a),this._drawnFeature=null},setLabel:function(a){if(!this._label)return;this._label.setContent(a)},_getStyleOptionClass:function(){return L.Util.extend({},L.Ols.LineOptions)}}),L.Map.DrawPolygon=L.Map.DrawLine.extend({options:{styleOptions:{stroke:!0,strokeColor:"#ff0000",strokeWidth:2,strokeOpacity:.8,fill:!0,fillColor:"#F00faF",fillOpacity:.5,editable:!0,clickable:!0}},_onMapClick:function(a){!!this._drawnFeature&&this._drawnFeature instanceof L.Ols.Polygon?this._drawnFeature.addPoint(a.point):this._startPoint?this._endPoint?(this._map.removeOverlays(this._drawnFeature),delete this._drawnFeature,this._drawnFeature=new L.Ols.Polygon([this._startPoint,this._endPoint,a.point],this._getStyleOptions()),L.Util.stamp(this._drawnFeature),this._map.addOverlays(this._drawnFeature)):(this._drawnFeature=new L.Ols.Line([this._startPoint,a.point],this._getLineStyleOptions()),L.Util.stamp(this._drawnFeature),this._map.addOverlays(this._drawnFeature)):this._map.fire("drawfeaturestart"),this._endPoint=this._startPoint?a.point:null,this._startPoint=this._startPoint||a.point,this.fire("addpoint",a)},_onMouseMove:function(a){if(!this._startPoint)return;if(L.Util.Browser.touch||L.Util.Browser.android)return;this._tmpFeature?this._endPoint?this._tmpFeature.setPoints([this._startPoint,a.point,this._endPoint]):this._tmpFeature.setPoints([this._startPoint,a.point]):(this._endPoint?this._tmpFeature=new L.Ols.Line([this._startPoint,a.point,this._endPoint],this._getLineStyleOptions()):this._tmpFeature=new L.Ols.Line([this._startPoint,a.point],this._getLineStyleOptions()),L.Util.stamp(this._tmpFeature),this._map.addOverlays(this._tmpFeature)),this.fire("movepoint",a)},_getStyleOptionClass:function(){return L.Util.extend({},L.Ols.PolygonOptions)}}),L.Map.DrawRect=L.Map.DrawPolygon.extend({addHooks:function(){this._map.on("click",this._onMapClick,this),this._map.on("mousemove",this._onMouseMove,this)},removeHooks:function(){this._map.off("click",this._onMapClick),this._map.off("mousemove",this._onMouseMove),this._endDrawn()},_onMapClick:function(a){this._startPoint?(this._endTag=!0,this._drawnFeature?this._drawnFeature.setBounds(new L.Extent(this._startPoint.x,this._startPoint.y,a.point.x,a.point.y)):(this._drawnFeature=new L.Ols.Rect(new L.Extent(this._startPoint.x,this._startPoint.y,a.point.x,a.point.y),this._getStyleOptions()),L.Util.stamp(this._drawnFeature),this._map.addOverlays(this._drawnFeature)),this._endDrawn()):(this._endTag=!1,this._startPoint=a.point)},_endDrawn:function(){if(!this._startPoint)return;this._startPoint=null,this._drawnFeature&&(!this._endTag&&this._map?this._map.removeOverlays(this._drawnFeature):this._map&&this._map.fire("drawfeatureend",{feature:this._drawnFeature}),this.options.styleOptions&&this.options.styleOptions.editable&&this._drawnFeature.enableEdit(),this._drawnFeature=null,delete this._drawnFeature),this._endTag=!1},_onMouseMove:function(a){if(!this._startPoint)return;if(L.Util.Browser.touch||L.Util.Browser.android)return;this._drawnFeature?this._drawnFeature.setBounds(new L.Extent(this._startPoint.x,this._startPoint.y,a.point.x,a.point.y)):(this._drawnFeature=new L.Ols.Rect(new L.Extent(this._startPoint.x,this._startPoint.y,a.point.x,a.point.y),this._getStyleOptions()),L.Util.stamp(this._drawnFeature),this._map.addOverlays(this._drawnFeature))}}),L.Map.DrawCircle=L.Map.DrawRect.extend({addHooks:function(){this._map.on("click",this._onMapClick,this),this._map.on("mousemove",this._onMouseMove,this)},removeHooks:function(){this._map.off("click",this._onMapClick),this._map.off("mousemove",this._onMouseMove),this._endDrawn()},_onMapClick:function(a){if(!this._startPoint)this._endTag=!1,this._startPoint=a.point;else{this._endTag=!0;var b=L.Util.getFitDist(this._startPoint.distanceTo(a.point),this._map.getUnits(),"m");this._drawnFeature?this._drawnFeature.setRadius(b):(this._drawnFeature=new L.Ols.Circle(this._startPoint,b,this._getStyleOptions()),L.Util.stamp(this._drawnFeature),this._map.addOverlays(this._drawnFeature)),this._endDrawn()}},_onMouseMove:function(a){if(!this._startPoint)return;if(L.Util.Browser.touch||L.Util.Browser.android)return;var b=L.Util.getFitDist(this._startPoint.distanceTo(a.point),this._map.getUnits(),"m");this._drawnFeature?this._drawnFeature.setRadius(b):(this._drawnFeature=new L.Ols.Circle(this._startPoint,b,this._getStyleOptions()),L.Util.stamp(this._drawnFeature),this._map.addOverlays(this._drawnFeature))}}),L.Map.DrawSector=L.Map.DrawCircle.extend({addHooks:function(){this._map.on("click",this._onMapClick,this),this._map.on("mousemove",this._onMouseMove,this)},removeHooks:function(){this._map.off("click",this._onMapClick),this._map.off("mousemove",this._onMouseMove),this._endDrawn()},_onMapClick:function(a){if(!this._drawnFeature||!(this._drawnFeature instanceof L.Ols.Fan))if(!this._startPoint)this._endTag=!1,this._startPoint=this._startPoint||a.point;else if(!this._endPoint)this._endTag=!1,this._passPoint=a.point,this._endPoint=this._startPoint?a.point:null,this._drawnFeature=new L.Ols.Line([this._startPoint,a.point],this._getLineStyleOptions()),L.Util.stamp(this._drawnFeature),this._map.addOverlays(this._drawnFeature);else{this._endTag=!0,this._map.removeOverlays(this._drawnFeature),delete this._drawnFeature,this._endPoint=this._startPoint?a.point:null;var b=(new L.Loc(this._endPoint.x,this._endPoint.y)).distanceTo(new L.Loc(this._startPoint.x,this._startPoint.y)),c=this._endPoint.y-this._startPoint.y,d;if(this._startPoint.x<this._endPoint.x&&this._startPoint.y<=this._endPoint.y)d=180*Math.asin(c/b)/Math.PI;else if(this._startPoint.x==this._endPoint.x&&this._startPoint.y<this._endPoint.y)d=180*Math.asin(c/b)/Math.PI;else if(this._startPoint.x>this._endPoint.x&&this._startPoint.y<this._endPoint.y)d=180-180*Math.asin(c/b)/Math.PI;else if(this._startPoint.x>this._endPoint.x&&this._startPoint.y>=this._endPoint.y)d=180-180*Math.asin(c/b)/Math.PI;else if(this._startPoint.x==this._endPoint.x&&this._startPoint.y>this._endPoint.y)d=180-180*Math.asin(c/b)/Math.PI;else{if(!(this._startPoint.x<this._endPoint.x&&this._startPoint.y>this._endPoint.y))return;d=360+180*Math.asin(c/b)/Math.PI}this._drawnFeature=new L.Ols.Fan(this._startPoint,this._passPoint,d,this._draw,this._getStyleOptions()),L.Util.stamp(this._drawnFeature),this._map.addOverlays(this._drawnFeature),this._endDrawn()}},_endDrawn:function(){if(!this._startPoint)return;this._startPoint=null,this._endPoint&&(this._endPoint=null,delete this._endPoint),this._tmpFeature&&(this._map&&this._map.removeOverlays(this._tmpFeature),this._tmpFeature=null,delete this._tmpFeature),this._movePoint&&(this._movePoint=null,delete this._movePoint),this._drawnFeature&&(!this._endTag&&this._map?this._map.removeOverlays(this._drawnFeature):this._map&&this._map.fire("drawfeatureend",{feature:this._drawnFeature}),this._drawnFeature=null,delete this._drawnFeature),this._endTag=!1,this._flag=1},_onMouseMove:function(a){if(!this._startPoint)return;if(L.Util.Browser.touch||L.Util.Browser.android)return;if(!this._tmpFeature)this._endPoint||(this._tmpFeature=new L.Ols.Line([this._startPoint,a.point],this._getLineStyleOptions())),L.Util.stamp(this._tmpFeature),this._map.addOverlays(this._tmpFeature);else if(!this._endPoint)this._tmpFeature.setPoints([this._startPoint,a.point]);else{if(!this._movePoint)this._movePoint=a.point,this._flag=1;else{this._flag=this._flag+1;var b=(new L.Loc(this._startPoint.x,this._startPoint.y)).distanceTo(new L.Loc(this._passPoint.x,this._passPoint.y)),c=a.point.x-this._startPoint.x,d=a.point.y-this._startPoint.y,e=Math.sqrt(c*c+d*d),f=new L.Loc(c/e*b+this._startPoint.x,d/e*b+this._startPoint.y);if(this._flag==2){var g,h=this._passPoint.y-this._startPoint.y;this._startPoint.x<this._passPoint.x&&this._startPoint.y<=this._passPoint.y?g=180*Math.asin(h/b)/Math.PI:this._startPoint.x==this._passPoint.x&&this._startPoint.y<this._passPoint.y?g=180*Math.asin(h/b)/Math.PI:this._startPoint.x>this._passPoint.x&&this._startPoint.y<this._passPoint.y?g=180-180*Math.asin(h/b)/Math.PI:this._startPoint.x>this._passPoint.x&&this._startPoint.y>=this._passPoint.y?g=180-180*Math.asin(h/b)/Math.PI:this._startPoint.x==this._passPoint.x&&this._startPoint.y>this._passPoint.y?g=180-180*Math.asin(h/b)/Math.PI:this._startPoint.x<this._passPoint.x&&this._startPoint.y>this._passPoint.y&&(g=360+180*Math.asin(h/b)/Math.PI);var i;Math.abs(f.x-this._passPoint.x)>Math.abs(f.y-this._passPoint.y)?i=Math.abs(f.x-this._passPoint.x):i=Math.abs(f.y-this._passPoint.y);var j,k;g>=0&&g<90?(j=new L.Loc(i,-i),k=new L.Loc(-i,i)):g>=90&&g<180?(j=new L.Loc(i,i),k=new L.Loc(-i,-i)):g>=180&&g<270?(j=new L.Loc(-i,i),k=new L.Loc(i,-i)):(j=new L.Loc(-i,-i),k=new L.Loc(i,i));var l=new L.Loc(f.x-this._passPoint.x,f.y-this._passPoint.y);j.x*l.x+j.y*l.y>0&&k.x*l.x+k.y*l.y<0?this._draw=1:j.x*l.x+j.y*l.y<0&&k.x*l.x+k.y*l.y>0&&(this._draw=0)}}this._tmpFeature.setPoints([this._startPoint,a.point,this._passPoint])}}}),L.Map.ZoomBoxHandler=L.Map.DrawFeatureHandler.extend({options:{styleOptions:{stroke:!0,strokeColor:"#ff0000",strokeWidth:2,strokeOpacity:.8,fill:!0,fillColor:"#ff0000",fillOpacity:.2,editable:!1,clickable:!1},_zoomInTag:!1},getStyleOptionClass:function(){return this.options.styleOptions},addHooks:function(){this._map.on("mousedown",this._onMouseDown,this),this._map.on("mousemove",this._onMouseMove,this),this._map.on("mouseup",this._onMouseUp,this)},removeHooks:function(){this._map.off("mousedown",this._onMouseDown,this),this._map.off("mousemove",this._onMouseMove,this),this._map.off("mouseup",this._onMouseUp,this),this._drawnFeature&&this._map.removeOverlay(this._drawnFeature),this._drawnFeature=null,this._startPoint=null},_onMouseDown:function(a){if(!this._map)return;this._startPoint=null;if(this._map._getAnimatingZoom())return;a.point&&(this._startPoint=a.point)},_onMouseUp:function(a){if(!this._map)return;if(a.point&&this._startPoint&&this._drawnFeature){var b=new L.Extent(this._startPoint.x,this._startPoint.y,a.point.x,a.point.y);this.options._zoomInTag?this._map.zoomToExtent(b):this._map.moveTo(b.getCenter(),this._map.getZoom()-1)}this._drawnFeature&&this._map.removeOverlays(this._drawnFeature),this._drawnFeature=null,this._startPoint=null},_onMouseMove:function(a){if(!this._map)return;if(!this._startPoint)return;this._drawnFeature?this._drawnFeature.setBounds(new L.Extent(this._startPoint.x,this._startPoint.y,a.point.x,a.point.y)):(this._drawnFeature=new L.Ols.Rect(new L.Extent(this._startPoint.x,this._startPoint.y,a.point.x,a.point.y),this.options.styleOptions),L.Util.stamp(this._drawnFeature),this._map.addOverlays(this._drawnFeature))}}),L.Map.DrawMarker=L.Map.DrawPoint.extend({options:{styleOptions:{markerClassName:"L.Ols.Marker"}},setHandlerOptions:function(a){this.options=this.options||{},this.options.styleOptions=this.options.styleOptions||{},a&&a.markerClassName&&a.markerClassName.toLowerCase()=="nspritemarker"?this.options.styleOptions.markerClassName="L.Ols.BgMarker":this.options.styleOptions.markerClassName="L.Ols.Marker",this.options.styleOptions=L.Util.extend(this.options.styleOptions,this.getStyleOptionClass(),a)},_getStyleOptionClass:function(){return this.options.styleOptions.markerClassName=="L.Ols.BgMarker"?L.Util.extend({},L.Ols.BgMarkerOptions):L.Util.extend({},L.Ols.MarkerOptions)},_onMapClick:function(a){this.options.styleOptions.markerClassName=="L.Ols.BgMarker"?this.marker=new L.Ols.BgMarker(a.point,this._getStyleOptions()):this.marker=new L.Ols.Marker(a.point,this._getStyleOptions()),this._map.addOverlays(this.marker),this._map.fire("drawmarkerend",{marker:this.marker})}}),L.Map.DoubleClickZoom=L.HandlerBase.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick)},_onDoubleClick:function(a){L.DomEvent.stopPropagation(a),L.DomEvent.preventDefault(a),this.setView(a.point,this._limitZoom(this.getZoom()+1))}}),L.Map.TouchZoom=L.HandlerBase.extend({addHooks:function(){L.DomEvent.addListener(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){L.DomEvent.removeListener(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var b=this._map;if(!a.touches||a.touches.length!==2||b._animatingZoom||this._zooming)return;var c=b._pixelToAbsPixel(L.DomEvent.getMousePosition(a.touches[0],b._container)),d=b._pixelToAbsPixel(L.DomEvent.getMousePosition(a.touches[1],b._container)),e=b._pixelToAbsPixel(b.getSize().divideBy(2));this._startCenter=c.add(d).divideBy(2,!0),this._startDist=c.distanceTo(d),this._moved=!1,this._zooming=!0,this._centerOffset=e.subtract(this._startCenter),L.DomEvent.addListener(this._map._container,"touchmove",this._onTouchMove,this).addListener(this._map._container,"touchend",this._onTouchEnd,this),L.DomEvent.preventDefault(a),L.DomEvent.stopPropagation(a)},_onTouchMove:function(a){if(!a.touches||a.touches.length!==2)return;var b=this._map,c=b._pixelToAbsPixel(L.DomEvent.getMousePosition(a.touches[0],b._container)),d=b._pixelToAbsPixel(L.DomEvent.getMousePosition(a.touches[1],b._container)),e=b._pixelToAbsPixel(b.getSize().divideBy(2)),f=c.distanceTo(d);this._startCenter=c.add(d).divideBy(2,!0),this._scale=f/this._startDist,this._moved||(this._moved=!0),this._startCenter=c.add(d).divideBy(2,!0),this._centerOffset=e.subtract(this._startCenter);var g=b.pixelToPoint(L.DomEvent.getMousePosition(a.touches[0],b._container)),h=b.pixelToPoint(L.DomEvent.getMousePosition(a.touches[1],b._container));this._newCenter=h.add(g).divideBy(2),L.DomEvent.preventDefault(a)},_onTouchEnd:function(a){if(!this._moved||!this._zooming)return;this._moved=!1,this._zooming=!1;var b=this._map.getCenter(),c=this._scale>1?this._map.getZoom()+1:this._map.getZoom()-1,d=this._map.getResByZoom(c);this._centerOffset&&this._newCenter&&(this._newCenter=this._newCenter.add(new L.Loc(this._centerOffset.x*d,-this._centerOffset.y*d))),d!=this._map.getResolution()&&this._map.setView(this._newCenter,c);return}}),L.Map.MeasureLength=L.Map.DrawLine.extend({_indexTag:0,_totalFixed:5,getStyleOptionClass:function(){return L.Util.extend(this._getStyleOptionClass(),{editable:!1,strokeColor:"#ff0000",strokeWidth:1,strokeOpacity:1})},addHooks:function(){L.Util.extend(this.options.styleOptions,{editable:!1,clickable:!1,draggable:!1}),L.Map.DrawLine.prototype.addHooks.call(this),this._map.on("mousemove",this._onMouseMove2,this),this.on("addpoint",this._onPointAdd,this),this.on("movepoint",this._onPointMove,this),this.on("endpoint",this._onDrawEnd,this),this._map.on("drawfeatureend",this._onDrawFeatureEnd,this)},removeHooks:function(){if(this._drawnFeature){var a=this._drawnFeature.getPoints();if(a&&a.length>1){var b=a[a.length-1];this._onDoubleClick({point:b})}}this._map.off("mousemove",this._onMouseMove2,this),L.Map.DrawLine.prototype.removeHooks.call(this),this.off("addpoint",this._onPointAdd),this.off("movepoint",this._onPointMove),this.off("endpoint",this._onDrawEnd),this._map.off("drawfeatureend",this._onDrawFeatureEnd),this._infoLabel&&this._map.removeOverlays(this._infoLabel),this._infoLabel=null},_onDrawFeatureEnd:function(a){this._addOverlay(a.feature,!0)},_onDoubleClick:function(a){this._endDrawn(),this.fire("endpoint",a),this._drawnFeature=null},_onPointAdd:function(a){if(a.point&&this._map){var b="",c="";if(!this._preMPoint)this._indexTag++,this._preMPoint=a.point,this._totalLen=0,b="  ",c=" leaflet_measure_label";else{var d=this._getLen(this._preMPoint,a.point,this._map.getUnits());this._totalLen+=d,this._preMPoint=a.point,b=this.getFitLenStr(this._totalLen,2)}var e=new L.Ols.Point(a.point,{radius:4,strokeWidth:1,stroke:!0,strokeColor:"#ff0000",strokeOpacity:1,fill:!0,fillColor:"#ffffff",fillOpacity:1,editable:!1,clickable:!0}),f=new L.Ols.Label(a.point,{offset:new L.Loc(8,0),content:b,clickable:!1});this._addOverlay(e),this._addOverlay(f),f.addClass(c)}},_addOverlay:function(a,b){var c="measure_group_"+this._indexTag;this._overlays=this._overlays||{},this._overlays[c]=this._overlays[c]||{};var d=L.Util.stamp(a);return this._overlays[c][d]=a,this._map&&!b&&this._map.addOverlays(a),this},_getLen:function(a,b,c){return L.Util.getDistByUnits(a,b,c)},getFitLenStr:function(a,b,c){var d="";return a>1e3&&(d="",a/=1e3),b!==undefined&&(a=a.toFixed(b)),c?{len:a,units:d}:a+d},_onPointMove:function(a){if(a.point&&this._map&&this._infoLabel){var b="",c=this._getLen(this._preMPoint,a.point,this._map.getUnits()),d=this._totalLen+c,e=this.getFitLenStr(d,this._totalFixed,!0);b='<span><span class="leaflet_measure_dis">'+e.len+"</span>"+e.units+"</span>",b+="<br>",b+='<span class="leaflet_measure_opinfo"></span>',this._infoLabel.setContent(b)}},_onDrawEnd:function(a){if(a.point&&this._map){var b="";if(!this._preMPoint)b=" 0 ";else{var c=this._getLen(this._preMPoint,a.point,this._map.getUnits());this._totalLen+=c;var d=this.getFitLenStr(this._totalLen,this._totalFixed,!0);b='<span><span class="leaflet_measure_dis">'+d.len+"</span>"+d.units+"</span>"}var e=new L.Ols.Marker(a.point,{markerAnchor:new L.Loc(-8,6),clickable:!0,shadowUrl:null,markerSize:new L.Loc(14,14),imgUrl:L.Icon.Default.imagePath+"close.gif",zIndexOffset:900,draggable:!1}),f=new L.Ols.Label(a.point,{offset:new L.Loc(0,8),content:b,clickable:!1,zIndexOffset:9999});this._addOverlay(e),this._addOverlay(f),e.on("click",this._clearOverlays,this),e.setTitle(""),e._measureId=this._indexTag,f.addClass(" leaflet_measure_label"),this._infoLabel&&this._infoLabel.setVisible(!1),this._map.fire("measureend")}this._preMPoint=null},_clearOverlays:function(a){if(!a||!a.target)return;var b=a.target;groupId="measure_group_"+b._measureId;if(this._overlays&&this._overlays[groupId])for(var c in this._overlays[groupId])this._overlays[groupId].hasOwnProperty(c)&&(this._map.removeOverlays(this._overlays[groupId][c]),this._overlays[groupId][c]=null,delete this._overlays[groupId][c])},_onMouseMove2:function(a){this._infoLabel?this._infoLabel.setPosition(a.point):(this._infoLabel=new L.Ols.Label(a.point,{offset:new L.Loc(18,18),zIndexOffset:9998}),this._map.addOverlays(this._infoLabel),this._infoLabel.addClass(" leaflet_measure_label"),this._infoLabel.setContent("")),this._infoLabel&&this._infoLabel.setVisible(!0)}}),L.Map.MeasureArea=L.Map.DrawPolygon.extend({_indexTag:0,_totalFixed:5,getStyleOptionClass:function(){return L.Util.extend(this._getStyleOptionClass(),{editable:!1,strokeColor:"#ff0000",strokeWidth:1,strokeOpacity:1,fillColor:"#dddddd"})},addHooks:function(){L.Util.extend(this.options.styleOptions,{editable:!1,clickable:!1,draggable:!1}),L.Map.DrawPolygon.prototype.addHooks.call(this),this._map.on("mousemove",this._onMouseMove2,this),this.on("addpoint",this._onPointAdd,this),this.on("movepoint",this._onPointMove,this),this.on("endpoint",this._onDrawEnd,this),this._map.on("drawfeatureend",this._onDrawFeatureEnd,this)},removeHooks:function(){if(this._drawnFeature){var a=this._drawnFeature.getPoints();if(a&&a.length>1){var b=a[a.length-1];this._onDoubleClick({point:b})}}this._map.off("mousemove",this._onMouseMove2,this),L.Map.DrawPolygon.prototype.removeHooks.call(this),this.off("addpoint",this._onPointAdd),this.off("movepoint",this._onPointMove),this.off("endpoint",this._onDrawEnd),this._map.off("drawfeatureend",this._onDrawFeatureEnd),this._infoLabel&&this._map.removeOverlays(this._infoLabel),this._infoLabel=null},_onDoubleClick:function(a){this._endDrawn(),this.fire("endpoint",a),this._drawnFeature=null},_onDrawFeatureEnd:function(a){this._addOverlay(a.feature,!0)},_getArea:function(a){var b=0;if(a&&a.length>2){var c=a[0],d=a[1],e=0,f=a[a.length-1],g=a.length;b=c.y*(f.x-d.x);for(var h=1;h<g;h++)e=(h+1)%g,b+=a[h].y*(a[h-1].x-a[e].x);b/=2}return b<0&&(b*=-1),b},_getFitArea:function(a){var b=0;a&&(b=this._getArea(a));var c=this._map.getUnits().toLowerCase();if(c!="km"){var d=L.Util.INCHES_PER_UNIT[c];b*=Math.pow(d/L.Util.INCHES_PER_UNIT.km,2),c="km"}b<.001&&(b*=Math.pow(L.Util.INCHES_PER_UNIT.km/L.Util.INCHES_PER_UNIT.m,2),c="m"),b=b.toFixed(5);var e={len:Math.abs(b),units:c};return e},_getAreaBylonlat:function(a){var b=6378137,c=Math.PI/180,d=0;if(a&&a.length>2){var e=a.length;for(var f=0;f<e;f++){var g=a[f].x,h=a[f].y,i=a[(f+1)%e].x,j=a[(f+1)%e].y;d+=(i-g)*c*(2+Math.sin(h*c)+Math.sin(j*c))}d=d*b*b/2}d<0&&(d*=-1);var k="m";d>1e3&&(d*=Math.pow(L.Util.INCHES_PER_UNIT.m/L.Util.INCHES_PER_UNIT.km,2),k="km"),d=d.toFixed(5);var l={len:Math.abs(d),units:k};return l},_onPointAdd:function(a){if(a.point&&this._map){!this._drawnFeature&&this._startPoint&&!this._endPoint&&this._indexTag++;if(this._drawnFeature){var b="",c="",d=this._drawnFeature.getPoints(),e,f=this._map.getUnits().toLowerCase();f=="dd"||f=="degrees"?e=this._getAreaBylonlat(d):e=this._getFitArea(d),b='<span><span class="leaflet_measure_dis">'+e.len+"</span>"+e.units+"<sup>2</sup></span>",b+="<br>",b+='<span class="leaflet_measure_opinfo"></span>',this._infoLabel?(this._infoLabel.setContent(b),this._infoLabel.setPosition(a.point)):(this._infoLabel=new L.Ols.Label(a.point,{offset:new L.Loc(8,0),content:b,clickable:!1,zIndexOffset:9998}),this._addOverlay(this._infoLabel))}var g=new L.Ols.Point(a.point,{radius:4,strokeWidth:1,stroke:!0,strokeColor:"#ff0000",strokeOpacity:1,fill:!0,fillColor:"#ffffff",fillOpacity:1,editable:!1,clickable:!0});this._addOverlay(g)}},_addOverlay:function(a,b){var c="measure_group_"+this._indexTag;this._overlays=this._overlays||{},this._overlays[c]=this._overlays[c]||{};var d=L.Util.stamp(a);return this._overlays[c][d]=a,this._map&&!b&&this._map.addOverlays(a),this},_onPointMove:function(a){if(a.point&&this._map&&this._infoLabel){var b=null;if(this._drawnFeature){b=[];var c=this._drawnFeature.getPoints();for(var d=0;d<c.length;d++)b.push(c[d]);a.point&&b.push(a.point)}else{if(!this._startPoint||!this._endPoint)return;b=[this._startPoint,this._endPoint,a.point]}var e,f=this._map.getUnits().toLowerCase();f=="dd"||f=="degrees"?e=this._getAreaBylonlat(b):e=this._getFitArea(b),content='<span><span class="leaflet_measure_dis">'+e.len+"</span>"+e.units+"<sup>2</sup></span>",content+="<br>",content+='<span class="leaflet_measure_opinfo"></span>',this._infoLabel.setContent(content)}},_onDrawEnd:function(a){if(a.point&&this._map){var b="";if(!this._drawnFeature)b=" 0 <sup>2</sup>";else{var c=this._drawnFeature.getPoints(),d,e=this._map.getUnits().toLowerCase();e=="dd"||e=="degrees"?d=this._getAreaBylonlat(c):d=this._getFitArea(c),b='<span><span class="leaflet_measure_dis">'+d.len+"</span>"+d.units+"<sup>2</sup></span>"}var f=new L.Ols.Marker(a.point,{markerAnchor:new L.Loc(-8,6),clickable:!0,shadowUrl:null,markerSize:new L.Loc(14,14),imgUrl:L.Icon.Default.imagePath+"close.gif",draggable:!1,zIndexOffset:9999}),g=new L.Ols.Label(a.point,{offset:new L.Loc(0,8),content:b,clickable:!1,zIndexOffset:9999});this._addOverlay(f),this._addOverlay(g),f.on("click",this._clearOverlays,this),f.setTitle(""),f._measureId=this._indexTag,g.addClass(" leaflet_measure_label"),this._infoLabel&&this._infoLabel.setVisible(!1),this._map.fire("measureend")}this._preMPoint=null},_clearOverlays:function(a){if(!a||!a.target)return;var b=a.target;groupId="measure_group_"+b._measureId;if(this._overlays&&this._overlays[groupId])for(var c in this._overlays[groupId])this._overlays[groupId].hasOwnProperty(c)&&(this._map.removeOverlays(this._overlays[groupId][c]),this._overlays[groupId][c]=null,delete this._overlays[groupId][c])},_onMouseMove2:function(a){this._infoLabel?this._infoLabel.setPosition(a.point):(this._infoLabel=new L.Ols.Label(a.point,{offset:new L.Loc(18,18)}),this._map.addOverlays(this._infoLabel),this._infoLabel.addClass(" leaflet_measure_label"),this._infoLabel.setContent("")),this._infoLabel&&this._infoLabel.setVisible(!0)}}),L.HandlerHash={drag:L.Map.Drag,doubleclickzoom:L.Map.DoubleClickZoom,scrollwheelzoom:L.Map.WheelZoom,drawpoint:L.Map.DrawPoint,drawline:L.Map.DrawLine,drawpolygon:L.Map.DrawPolygon,drawrect:L.Map.DrawRect,drawcircle:L.Map.DrawCircle,drawsector:L.Map.DrawSector,drawmarker:L.Map.DrawMarker,zoomboxin:L.Map.ZoomBoxHandler,zoomboxout:L.Map.ZoomBoxHandler,touchzoom:L.Map.TouchZoom,measurelength:L.Map.MeasureLength,measurearea:L.Map.MeasureArea},L.Ols.EleBase.Drag=L.HandlerBase.extend({initialize:function(a){this._element=a},addHooks:function(){var a=this._element._getMoveTarget(),b=this._element._getDragTarget();this._draggable||(this._draggable=new L.Draggable(b,a)),this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),this._draggable.enable()},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(a){this._element._popup&&this._element.closeDialog(),this._element.fire("movestart").fire("dragstart")},_onDrag:function(a){var b=L.Util.getPosition(this._element._getDragTarget()),c=this
._element._map._absPixelToPoint(b);this._element._onDragUpdate&&this._element._onDragUpdate({absPixel:b,point:c}),this._element.fire("move").fire("drag")},_onDragEnd:function(){this._element.fire("moveend").fire("dragend")}}),L.Ols.Polygon.Edit=L.HandlerBase.extend({options:{},initialize:function(a,b){this._feature=a,L.Util.setOptions(this,b)},addHooks:function(){this._feature._map&&(this._markerGroup||this._initDivAnchors(),this._feature._map.addLayer(this._markerGroup))},removeHooks:function(){this._feature._map&&(this._feature._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},_updateDivAnchors:function(){this._markerGroup.clearOverlays(),this._initDivAnchors()},_initDivAnchors:function(){this._markerGroup=new L.Layers.Overlay,this._markers=[];var a=this._feature._points,b,c,d,e;for(b=0,d=a.length;b<d;b++)e=this._createDivAnchor(a[b],b),e.on("click",this._onMarkerClick,this),this._markers.push(e);var f,g;for(b=0,c=d-1;b<d;c=b++){if(b===0&&!(L.Ols.Polygon&&this._feature instanceof L.Ols.Polygon))continue;f=this._markers[c],g=this._markers[b],this._createMiddleDivAnchor(f,g),this._updatePrevNext(f,g)}},_createDivAnchor:function(a,b){var c="";b==-2&&(c="",delete b);var d=new L.Ols.EditAnchor(a,{draggable:!0,title:c});return d._featurePos=a,d._index=b,d.on("drag",this._onMarkerDrag,this),d.on("dragend",this._fireEdit,this),this._markerGroup||(this._markerGroup=new L.Layers.Overlay),this._markerGroup.addOverlay(d),d},_fireEdit:function(){this._feature.fire("edit",{feature:this._feature})},_onMarkerDrag:function(a){var b=a.target;L.Util.extend(b._featurePos,b._latlng),b._middleLeft&&b._middleLeft.setPosition(this._getMiddleLatLng(b._prev,b)),b._middleRight&&b._middleRight.setPosition(this._getMiddleLatLng(b,b._next)),this._feature.redraw()},_onMarkerClick:function(a){if(this._feature._points.length<=3)return;var b=a.target,c=b._index;b._prev&&b._next&&(this._createMiddleDivAnchor(b._prev,b._next),this._updatePrevNext(b._prev,b._next)),this._markerGroup.removeOverlay(b),b._middleLeft&&this._markerGroup.removeOverlay(b._middleLeft),b._middleRight&&this._markerGroup.removeOverlay(b._middleRight),this._feature.removePoints(c,1),this._updateIndexes(c,-1),this._feature.fire("edit",{feature:this._feature})},_updateIndexes:function(a,b){this._markerGroup._iterateLayers(function(c){c._index>a&&(c._index+=b)})},_createMiddleDivAnchor:function(a,b){var c=this._getMiddleLatLng(a,b),d=this._createDivAnchor(c,-2),e,f,g;d.setOpacity(.6),a._middleRight=b._middleLeft=d,f=function(){var f=b._index;d._index=f,d.off("click",e).on("click",this._onMarkerClick,this),this._feature.removePoints(f,0,c),this._markers.splice(f,0,d),d.setOpacity(1),this._updateIndexes(f,1),b._index++,this._updatePrevNext(a,d),this._updatePrevNext(d,b)},g=function(){d.off("dragstart",f,this),d.off("dragend",g,this),this._createMiddleDivAnchor(a,d),this._createMiddleDivAnchor(d,b)},e=function(){f.call(this),g.call(this),this._feature.fire("edit",{feature:this._feature})},d.on("click",e,this).on("dragstart",f,this).on("dragend",g,this),this._markerGroup.addOverlay(d)},_updatePrevNext:function(a,b){a._next=b,b._prev=a},_getMiddleLatLng:function(a,b){var c=this._feature._map,d=c._pointToAbsPixel(a.getPosition()),e=c._pointToAbsPixel(b.getPosition());return c._absPixelToPoint(d._add(e).divideBy(2))}}),L.Ols.Line.Edit=L.Ols.Polygon.Edit.extend({_updatePrevNext:function(a,b){a&&(a._next=b?b:null),b&&(b._prev=a?a:null)},_onMarkerClick:function(a){if(this._feature._points.length<=2)return;var b=a.target,c=b._index;b._prev&&b._next?this._createMiddleDivAnchor(b._prev,b._next):b._prev?b._prev._middleRight=null:b._next&&(b._next._middleLeft=null),this._updatePrevNext(b._prev,b._next),b._middleLeft&&this._markerGroup.removeOverlay(b._middleLeft),b._middleRight&&this._markerGroup.removeOverlay(b._middleRight),this._markerGroup.removeOverlay(b),this._feature.removePoints(c,1),this._updateIndexes(c,-1),this._feature.fire("edit",{feature:this._feature})},_initDivAnchors:function(){this._markerGroup=new L.Layers.Overlay,this._markers=[];var a=this._feature._points,b,c,d,e;for(b=0,d=a.length;b<d;b++)e=this._createDivAnchor(a[b],b),e.on("click",this._onMarkerClick,this),this._markers.push(e);var f,g;for(b=1,c=0;b<d;c=b++){if(b===0&&!(L.Ols.Line&&this._feature instanceof L.Ols.Line))continue;f=this._markers[c],g=this._markers[b],this._createMiddleDivAnchor(f,g),this._updatePrevNext(f,g)}}}),L.Ols.Rect.Edit=L.Ols.Polygon.Edit.extend({_initDivAnchors:function(){this._markerGroup=new L.Layers.Overlay,this._markers=[];var a=this._feature._points,b,c,d,e;for(b=0,d=a.length;b<d;b++)e=this._createDivAnchor(a[b],b),this._markers.push(e)},_createDivAnchor:function(a,b){var c=new L.Ols.EditAnchor(a,{draggable:!0});return c._featurePos=a,c._index=b,c.on("drag",this._onMarkerDrag,this),c.on("dragend",this._fireEdit,this),this._markerGroup.addOverlay(c),c},_fireEdit:function(){this._feature.fire("edit",{feature:this._feature})},_onMarkerDrag:function(a){var b=a.target,c=b._index;c===0||c===1?(this._updateVertics(0,b,"x"),this._updateVertics(1,b,"x")):(this._updateVertics(2,b,"x"),this._updateVertics(3,b,"x")),c===0||c===3?(this._updateVertics(0,b,"y"),this._updateVertics(3,b,"y")):(this._updateVertics(1,b,"y"),this._updateVertics(2,b,"y")),this._feature.redraw()},_updateVertics:function(a,b,c){if(!this._markers)return;this._markers[a]._latlng[c]=b._latlng[c],this._markers[a]._update(),this._markers[a]._featurePos[c]=b._latlng[c]}}),L.Ols.Circle.Edit=L.Ols.Polygon.Edit.extend({_initDivAnchors:function(){this._markerGroup=new L.Layers.Overlay,this._markers=[];var a=this._feature.getPosition(),b=this._feature._getFitRadius(),c=this._createDivAnchor(a,0);this._markers.push(c);var d=this._createDivAnchor(new L.Loc(a.x+b,a.y),1);this._markers.push(d)},_createDivAnchor:function(a,b){var c=new L.Ols.EditAnchor(a,{draggable:!0});return c._featurePos=a,c._index=b,c.on("drag",this._onMarkerDrag,this),c.on("dragend",this._fireEdit,this),this._markerGroup.addOverlay(c),c},_fireEdit:function(){this._feature.fire("edit",{feature:this._feature})},_onMarkerDrag:function(a){var b,c=a.target,d=c._index,e=this._feature._getFitRadius();if(d===0)b=c._latlng,this._feature.setPosition(b),this._markers[1].setPosition(new L.Loc(b.x+e,b.y));else if(d===1){var e=this._markers[0]._latlng.distanceTo(c._latlng);this._feature.setRadius(e,this._feature._map.getUnits())}this._feature.redraw()},_updateVertics:function(a,b,c){if(!this._markers)return;this._markers[a]._latlng[c]=b._latlng[c],this._markers[a]._update(),this._markers[a]._featurePos[c]=b._latlng[c]}}),L.Ols.Point.Edit=L.Ols.Circle.Edit.extend({_initDivAnchors:function(){this._markerGroup=new L.Layers.Overlay,this._markers=[];var a=this._feature.getPosition(),b=this._feature._getFitRadius(),c=this._createDivAnchor(a,0);this._markers.push(c)}}),L.Ols.Pies=L.Ols.Circle.extend({_options:{fill:!0,_labelContent:!1,offset:new L.Loc(20,0),labelpart:{color:"dimgrey",fontSize:"12px",fontFamily:"arial"},labelmarker:{color:"dimgrey",fontSize:"12px",fontFamily:"arial"}},_color:["#FFC125","#00CD00","#FF00FF","#C0FF3E","#9400D3"],_type:"L.Ols.Pies",initialize:function(a,b,c,d){this.options=L.Util.extend({},this._options,d),this.options=L.Util.extend({},L.Ols.PolygonOptions,this.options),this._latlng=a,this._mRadius=b,this._parts=c},getCenterPosition:function(){return this._latlng},setCenterPosition:function(a){return this._latlng=a,this.redraw()},toAbsPixels:function(){var a=this._getFitRadius(),b=new L.Loc(this._latlng.x,this._latlng.y-a),c=this._map._pointToAbsPixel(b);this._point=this._map._pointToAbsPixel(this._latlng),this._radius=Math.round(Math.abs(this._point.y-c.y))},setPartLabelStyle:function(a){var b=this.options.labelpart;for(var c in a)b.hasOwnProperty(c)&&(b[c]=a[c]);this.options.labelpart=b;if(this._pathLabels)for(var d=this._pathLabels.length;d>0;d--){var e=this._pathLabels[d-1];L.Util.Browser.svg||!L.Util.Browser.vml?(e.setAttribute("fill",b.color),e.setAttribute("font-size",b.fontSize),e.setAttribute("font-family",b.fontFamily)):(e.style.color=b.color,e.style.fontSize=b.fontSize,e.style.fontFamily=b.fontFamily)}},setMarkLabelStyle:function(a){var b=this.options.labelmarker;for(var c in a)b.hasOwnProperty(c)&&(b[c]=a[c]);this.options.labelmarker=b;if(this._markerLabels)for(var d=this._markerLabels.length;d>0;d--){var e=this._markerLabels[d-1].label;L.Util.Browser.svg||!L.Util.Browser.vml?(e.setAttribute("fill",b.color),e.setAttribute("font-size",b.fontSize),e.setAttribute("font-family",b.fontFamily)):(e.style.color=b.color,e.style.fontSize=b.fontSize,e.style.fontFamily=b.fontFamily)}},setPartMarkerOffset:function(a){a&&a instanceof L.Loc&&(this.options.offset=a,this._markerLabels&&this._updatePosition())},_updatePosition:function(){var a=this.options.offset.x,b=this.options.offset.y,c=this._point,d=this._radius,e=new L.Loc(c.x+d,c.y);for(var f=0,g=this._markerLabels.length;f<g;f++){if(f==0)var h=a,i=b,j=d/6,k=d/8,l=d/10;else i+=k+l;j>20&&(j=20,k=15,l=12);var m=e.x+h,n=e.y+i,o=m+j,p=n,q=o,r=p+k,s=m,t=n+k,u="";if(L.Util.Browser.svg||!L.Util.Browser.vml)u="M"+m+","+n+"L"+o+","+p+"L"+q+","+r+"L"+s+","+t+"Z",this._markerLabels[f].marker.setAttribute("d",u),this._markerLabels[f].label.setAttribute("x",o+l),this._markerLabels[f].label.setAttribute("y",p+l);else{var v=new L.Loc(m,n),w=new L.Loc(o,p),x=new L.Loc(q,r),y=new L.Loc(s,t);v._round(),w._round(),x._round(),y._round(),u="M"+v.x+","+v.y+"L"+w.x+","+w.y+"L"+x.x+","+x.y+"L"+y.x+","+y.y+"x",this._markerLabels[f].marker.v=u+" ",this._markerLabels[f].label.style.left=j+l+"px"}}},_updatePath:function(){var a=this._point,b=this._radius,c=new L.Loc(a.x+b,a.y);if(this._parts&&this._parts.length<2){var d=this.getPathString();d||(d="M0 0"),this._path.setAttribute("d",d)}else{var e=0,f=0,g=0;for(var h in this._parts)this._parts.hasOwnProperty(h)&&(e+=this._parts[h],f++);var i,j,k,l,m=c,n,o,p;this._pathadds||(this._pathadds=[]),this._pathLabels||(this._pathLabels=[]),this._markerLabels||(this._markerLabels=[]);var q=this.options.offset,r=q.x,s=q.y;for(var h in this._parts){i=parseFloat(this._parts[h])/e,g==0?(j=i*360,k=360):(k=l,j+=i*360,m=n),l=360-j,n=new L.Loc(a.x+Math.cos(j/180*Math.PI)*b,a.y+Math.sin(j/180*Math.PI)*b),p=new L.Loc((m.x+n.x)/2,(m.y+n.y)/2);var d=this.getPathString1(m,n,k,l);d||(d="M0 0");var t=this._color.length,u=g;g>t-1&&(u=g%t);var v=this._pathadds.length;if(L.Util.Browser.svg||!L.Util.Browser.vml)if(g==0)this._path.setAttribute("stroke-width",1),this._path.setAttribute("fill",this._color[u]),this._path.setAttribute("d",d);else if(v<f-1){var w=this._createElement("path");this.initStyle1(w),w.setAttribute("fill",this._color[u]),w.setAttribute("stroke-width",1),this._container.appendChild(w),w.setAttribute("d",d),this._pathadds.push(w)}else this._pathadds[g-1].setAttribute("d",d);else if(g==0){var x=this._container.style,y=this.getVisible(),z=y?"block":"none";x.display="none",this._path.v=d+" ",x.display=z,this._stroke.weight=1,this._fill.color=this._color[u]}else if(v<f-1){var A=this._createElement("shape");A.className+=" leaflet-vml-shape"+(this.options.clickable?" leaflet-clickable":""),A.coordsize="1 1";var w=this._createElement("path");A.appendChild(w),this._initStyle2(A,{fillColor:this._color[u],strokeWidth:1}),this._map._pathRoot.appendChild(A),w.v=d+" ",this._pathadds.push(A)}else{var B=this._pathadds[g-1].firstChild;B.v=d+" "}if(g==0)var C=r,D=s,E=b/6,F=b/8,G=b/10;else D+=F+G;E>20&&(E=20,F=15,G=12);var H=c.x+C,I=c.y+D,J=H+E,K=I,M=J,N=K+F,O=H,P=I+F,Q=this._pathLabels.length,R;if(L.Util.Browser.svg||!L.Util.Browser.vml){R="M"+H+","+I+"L"+J+","+K+"L"+M+","+N+"L"+O+","+P+"Z";if(Q<f&&this.options._labelContent){var S=this._createElement("path");this.initStyle1(S),S.setAttribute("fill",this._color[u]),S.setAttribute("stroke-width",1),this._container.appendChild(S);var T=this._createElement("text");T.textContent=h,this._container.appendChild(T),this._markerLabels.push({marker:S,label:T})}this._markerLabels&&this._markerLabels.length>0&&(this._markerLabels[g].marker.setAttribute("d",R),this._markerLabels[g].label.setAttribute("x",M+G),this._markerLabels[g].label.setAttribute("y",N),this._markerLabels[g].label.setAttribute("fill",this.options.labelmarker.color),this._markerLabels[g].label.setAttribute("font-size",this.options.labelmarker.fontSize),this._markerLabels[g].label.setAttribute("font-family",this.options.labelmarker.fontFamily))}else{var U=new L.Loc(H,I),V=new L.Loc(J,K),W=new L.Loc(M,N),X=new L.Loc(O,P);U._round(),V._round(),W._round(),X._round(),R="M"+U.x+","+U.y+"L"+V.x+","+V.y+"L"+W.x+","+W.y+"L"+X.x+","+X.y+"x",this._markerLabelsCon||(this._markerLabelsCon=[]);if(Q<f&&this.options._labelContent){var A=this._createElement("shape");A.className+=" leaflet-vml-shape"+(this.options.clickable?" leaflet-clickable":""),A.coordsize="1 1";var w=this._createElement("path");A.appendChild(w),this._initStyle2(A,{fillColor:this._color[u],strokeWidth:1}),this._map._pathRoot.appendChild(A),this._markerLabelsCon.push(A);var T=this._createElement("v:textbox");T.innerHTML=h,"<table><tr><td>"+h+"</td></tr></table>",A.appendChild(T),this._markerLabels.push({marker:w,label:T})}if(this._markerLabels&&this._markerLabels.length>0){this._markerLabels[g].marker.v=R+" ";var Y=this._markerLabels[g].label.clientHeight;this._markerLabels[g].label.style.left=E+G+"px",this._markerLabels[g].label.style.top=(F-Y)/2+"px",this._markerLabels[g].label.style.color=this.options.labelmarker.color,this._markerLabels[g].label.style.fontSize=this.options.labelmarker.fontSize,this._markerLabels[g].label.style.fontfamily=this.options.labelmarker.fontFamily}}g++}}},getPathString1:function(a,b,c,d){var e=this._point,f,g=this._radius;if(this._checkIfEmpty())return"";(c-d+360)%360<180?f=0:f=1;if(L.Util.Browser.svg){var h=1;return"M "+e.x+","+e.y+"L "+a.x+","+a.y+"A "+g+","+g+",0,"+f+","+h+","+b.x+","+b.y}e._round(),a._round(),b._round(),g=Math.round(g),sd=Math.round(c),ed=Math.round(d);var i=(sd-ed+360)%360;return"M "+e.x+","+e.y+" L "+b.x+","+b.y+" AE "+e.x+","+e.y+", "+g+","+g+", "+65535*ed+","+65535*i},initStyle1:function(a){this.options.stroke&&(a.setAttribute("stroke-linejoin","round"),a.setAttribute("stroke-linecap","round")),this.options.fill&&a.setAttribute("fill-rule","evenodd"),this._updateStyle1(a)},_updateStyle1:function(a){this.options.stroke?(a.setAttribute("stroke",this.options.strokeColor),a.setAttribute("stroke-opacity",this.options.strokeOpacity),a.setAttribute("stroke-width",this.options.strokeWidth),a.setAttribute("stroke-dasharray",this._dashStyle1(this.options,1))):this._path.setAttribute("stroke","none"),this.options.fill?(a.setAttribute("fill",this.options.fillColor||this.options.color),a.setAttribute("fill-opacity",this.options.fillOpacity)):a.setAttribute("fill","none")},_dashStyle1:function(a,b){var c=a.strokeWidth*b,d=a.strokeStyle;switch(d){case"solid":return"none";case"dot":return[1,4*c].join();case"dash":return[4*c,4*c].join();case"dashdot":return[4*c,4*c,1,4*c].join();case"longdash":return[8*c,4*c].join();case"longdashdot":return[8*c,4*c,1,4*c].join();default:return"none"}},_initStyle2:function(a,b){var a=a,c,d;this.options.stroke&&(c=this._createElement("stroke"),c.endcap="round",a.appendChild(c)),this.options.fill&&(d=this._createElement("fill"),a.appendChild(d)),this._updateStyle2(a,b)},_updateStyle2:function(a,b){var c=a.childNodes[1],d=a.lastChild,e=this.options,a=a;a.stroked=e.stroke,a.filled=e.fill,e.stroke&&(c.weight=b.strokeWidth?b.strokeWidth+"px":e.strokeWidth+"px",c.color=b.strokeColor?b.strokeColor:e.strokeColor,c.opacity=b.strokeOpacity?b.strokeOpacity:e.strokeOpacity,c.dashstyle=b.strokeStyle?b.strokeStyle:e.strokeStyle),e.fill&&(d.color=b.fillColor?b.fillColor:e.fillColor||e.color,d.opacity=b.fillOpacity?b.fillOpacity:e.fillOpacity)},_unsetMap:function(a){a=a||this._map,this.disableEdit(),a._pathRoot.removeChild(this._container);if(this._pathadds&&!L.Util.Browser.svg&&!!L.Util.Browser.vml){for(var b=this._pathadds.length;b>0;b--)a._pathRoot.removeChild(this._pathadds[b-1]);for(b=this._markerLabelsCon.length;b>0;b--)a._pathRoot.removeChild(this._markerLabelsCon[b-1])}this._pathadds=null,this._pathLabels=null,this._markerLabels=null,a.off("viewreset",this.toAbsPixels,this).off("moveend",this._updatePath,this),this._map=null},_getEditClass:function(){}});